FOPs_MPR_Tools As screen:
    OnVisible: |-
        =Set(FAQVisible , false);
        Set(FOPTypeNavigation, false);
        Set(PDFViewVisible, false); 
        
        Set(FOP_ApprovalFOPDetailsVisible, false);
        
        Set(PopUpVisible, false);
        Set(PopUpRejectVisible, false);
        Set(PopUpSignVisible, false);
        Set(PopUpModifyFOPVisible, false);
        
        Set(UsinaGalleryVisible, true);       
        Set(DiversityGalleryVisible, false);  
        Set(UETGalleryVisible, false);       
        Set(PostoGalleryVisible, false);      
        
        Set(SelectedUsina,Blank());    
        Set(SelectedDiversity,Blank());
        Set(SelectedUET,Blank());      
        Set(SelectedPosto,Blank());   
        
        Set(CodigoFOP,Blank());        
        Set(CodigoFOPAux, Blank());
        
        Set(TipoHistorico, Blank());
        Set(RegistroHistorico, Blank());
        
        Set(PostoRobotizado, false);
        Set(ProAPWFOP, false);
        
        Reset(MNF_radQuestion_T);
        Reset(MPS_inpSignature_T);
        ResetForm(MPR_frmNewFOP_T);
        ResetForm(MPR_frmTabelaAfetacao_T);
        ResetForm(MPR_frmDetails_T);
            

    conFOPs_MPR_Tools As groupContainer.verticalAutoLayoutContainer:
        DropShadow: =DropShadow.None
        Height: =Parent.Height
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Width: =Parent.Width
        ZIndex: =1

        FOP_CabecalhoCont_3 As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.None
            Fill: =RGBA(0, 0, 0, 1)
            FillPortions: =0
            Height: =60
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutMinHeight: =100
            LayoutMinWidth: =0
            LayoutMode: =LayoutMode.Auto
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =App.Width
            ZIndex: =1

            C_LogoVersionCont_6 As groupContainer.verticalAutoLayoutContainer:
                FillPortions: =0
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =0
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                Width: =80
                ZIndex: =1

                C_LogoCPE_7 As image:
                    AlignInContainer: =AlignInContainer.Stretch
                    Height: =49
                    Image: ='CPE Logo Amarelo'
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    Width: =120
                    X: =17
                    Y: =6
                    ZIndex: =1

                C_AppVersion_5 As label:
                    Align: =Align.Center
                    Color: =RGBA(239, 223, 0, 1)
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Lighter
                    Height: =8
                    LayoutMinWidth: =0
                    Size: =6
                    Text: =VersaoUser
                    Width: =Parent.Width
                    X: =896
                    Y: =51
                    ZIndex: =2

            "FOP_ScreensNavigation_4 As gallery.'BrowseLayout_Horizontal_TwoTextOneImageVariant_ver5.0'":
                '#CopilotOverlayLabel': ="Filtrada"
                Default: |-
                    =Switch(VisibleScreen,
                    
                        "DigitalPE_Support", {Value:"SUPORTE"},
                        "CPE_FOPs",{Value:"FOPs"}
                    )
                DelayItemLoading: =true
                FillPortions: =0
                Height: =100
                Items: =["FOPs","SUPORTE"]
                LayoutMinHeight: =0
                LayoutMinWidth: =0
                LoadingSpinner: =LoadingSpinner.Data
                OnSelect: |-
                    =Switch(ThisItem.Value,
                    
                        "FOPs",Set(FOPTypeNavigation, true),
                        "SUPORTE", Navigate(DigitalPE_Support),
                        Notify("EM DESENVOLVIMENTO",NotificationType.Information);Reset(Parent)
                    )
                TemplatePadding: =0
                TemplateSize: =160
                Width: =350
                X: =120
                ZIndex: =2

                FOP_SelectedScreen_7 As rectangle:
                    Fill: =RGBA(239, 223, 0, 1)
                    Height: =5
                    OnSelect: =Select(Parent)
                    Visible: |-
                        =And(
                            App.ActiveScreen = FOPs_MPR_Tools,
                            ThisItem.Value = "FOPs"
                        )
                    Width: =Len(ThisItem.Value)*12
                    X: =(Parent.TemplateWidth - Len(ThisItem.Value)*12)/2
                    Y: =Parent.TemplateHeight*0.7
                    ZIndex: =3

                FOP_ScreenName_7 As button:
                    Fill: =RGBA(0, 0, 0, 0)
                    Font: =Font.Arial
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Bold, FontWeight.Semibold)
                    Height: =Parent.TemplateHeight/2
                    HoverFill: =ColorFade(RGBA(56, 96, 178, 0), -20%)
                    OnSelect: |-
                        =Select(Parent);
                        
                        Switch(ThisItem.Value,
                        
                            "FOPs", Set(FOPTypeNavigation, true),
                            "SUPORTE", Navigate(DigitalPE_Support, ScreenTransition.Fade),
                            Notify("EM DESENVOLVIMENTO",NotificationType.Information);Reset(Parent)
                        )
                    PressedBorderColor: =RGBA(166, 166, 166, 0)
                    PressedColor: =RGBA(255, 255, 255, 0)
                    PressedFill: =RGBA(0, 0, 0, 0)
                    Size: =18
                    Text: =ThisItem.Value
                    Width: =Parent.TemplateWidth
                    Y: =Parent.TemplateHeight/4
                    ZIndex: =4

            C_imgFAQ_MPR_2 As image:
                AccessibleLabel: ="PERGUNTAS FREQUENTES"
                AlignInContainer: =AlignInContainer.Center
                Height: =60
                Image: |+
                    ="data:image/svg+xml;utf8, "&
                    EncodeUrl(
                    "
                    <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 60 60'><defs><style>.cls-1{fill:#FFFFFF;}</style></defs><g id='Picto'><path class='cls-1' d='M32.2,43.14a23.92,23.92,0,0,1-2.25,4H27.84a23.94,23.94,0,0,1-2.26-4H17.32a3.19,3.19,0,0,1-3.4-3.4V18.57a3.21,3.21,0,0,1,3.4-3.37H40.46c2.26,0,3.41,1.16,3.41,3.41V39.74a3.17,3.17,0,0,1-3.5,3.4ZM28.89,45.4a29.93,29.93,0,0,0,2-4.18h9.27a1.56,1.56,0,0,0,1.77-1.68V18.8a1.53,1.53,0,0,0-1.73-1.68H17.56a1.56,1.56,0,0,0-1.68,1.64V39.54a1.59,1.59,0,0,0,1.68,1.68h9.36A31.11,31.11,0,0,0,28.89,45.4ZM24,25.14h5.85V35.22h4V37.1H24V35.22h3.88V27.06H24Zm6.48-3.65c0,1.16-.53,1.59-1.59,1.59s-1.58-.43-1.58-1.59.53-1.58,1.58-1.58S30.48,20.34,30.48,21.49Z'/></g></svg>
                    ")
                    
                LayoutMinHeight: =0
                OnSelect: =If(FAQVisible, Set(FAQVisible, false), Set(FAQVisible, true))
                Tooltip: ="PERGUNTAS FREQUENTES"
                Width: =50
                ZIndex: =5

            Container5_5 As groupContainer.horizontalAutoLayoutContainer:
                FillPortions: =15
                LayoutGap: =5
                LayoutMinHeight: =0
                LayoutMinWidth: =0
                LayoutMode: =LayoutMode.Auto
                ZIndex: =6

                Container6_5 As groupContainer.verticalAutoLayoutContainer:
                    DropShadow: =DropShadow.None
                    FillPortions: =13
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutJustifyContent: =LayoutJustifyContent.Center
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    LayoutMode: =LayoutMode.Auto
                    ZIndex: =1

                    C_UserName_12 As label:
                        Align: =Align.Right
                        AlignInContainer: =AlignInContainer.Stretch
                        Color: =RGBA(255, 255, 255, 1)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Bold
                        Height: =20
                        LayoutMinWidth: =0
                        Size: =12
                        Text: =Upper(UsuáriosdoOffice365.UserProfileV2(User().Email).givenName & " " & UsuáriosdoOffice365.UserProfileV2(User().Email).surname)
                        Width: =Parent.Width
                        X: =896
                        Y: =35
                        ZIndex: =1

                    C_UserName_13 As label:
                        Align: =Align.Right
                        AlignInContainer: =AlignInContainer.Stretch
                        Color: =RGBA(255, 255, 255, 1)
                        Font: =Font.Arial
                        Height: =14
                        LayoutMinWidth: =0
                        Size: =10
                        Text: =UsuáriosdoOffice365.UserProfileV2(User().Email).department
                        Width: =Parent.Width
                        X: =896
                        Y: =35
                        ZIndex: =2

                C_UserImage_7 As image:
                    AlignInContainer: =AlignInContainer.Center
                    Height: =Parent.Height*0.7
                    Image: =UsuáriosdoOffice365.UserPhotoV2(User().Email)
                    ImagePosition: =ImagePosition.Fill
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    RadiusBottomLeft: =50
                    RadiusBottomRight: =50
                    RadiusTopLeft: =50
                    RadiusTopRight: =50
                    Width: =Parent.Height*0.7
                    X: =1219
                    Y: =8
                    ZIndex: =2

                C_LogoRenault_7 As image:
                    AlignInContainer: =AlignInContainer.Center
                    Height: =Parent.Height*0.75
                    Image: ='Logo Renault Branco'
                    LayoutMinWidth: =0
                    Width: =80
                    X: =76
                    Y: =12
                    ZIndex: =3

        MPR_conMain_Tools As groupContainer.horizontalAutoLayoutContainer:
            LayoutGap: =15
            LayoutMinHeight: =0
            LayoutMinWidth: =0
            LayoutMode: =LayoutMode.Auto
            PaddingBottom: =15
            PaddingLeft: =15
            PaddingRight: =15
            ZIndex: =2

            MPR_conTools_Left As groupContainer.verticalAutoLayoutContainer:
                DropShadow: =DropShadow.None
                Fill: =RGBA(217, 217, 214, 1)
                FillPortions: =3
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =0
                LayoutMinWidth: =0
                LayoutMode: =LayoutMode.Auto
                ZIndex: =1

                "MPR_galNavigation_T As gallery.'BrowseLayout_Horizontal_TwoTextOneImageVariant_ver5.0'":
                    '#CopilotOverlayLabel': ="Filtrada"
                    Default: |-
                        =Switch(CostCenter, 
                        
                            "GI31200", {Value: "NOVA FOP"} , //PE VE Processo
                            "GI31120", {Value: "NOVA FOP"}, //DIVD Vida Serie -> Todos os Departamentos
                        
                            {Value: "APROVAÇÕES"} //Usuário padrão
                        )
                    DelayItemLoading: =true
                    Fill: =RGBA(255, 255, 255, 1)
                    FillPortions: =0
                    Height: =45
                    Items: |-
                        =Switch(CostCenter, 
                        
                            "GI31200" , ["NOVA FOP","APROVAÇÕES","HISTÓRICOS","ASSINATURA"], 
                            "GI31120" , ["NOVA FOP","APROVAÇÕES","HISTÓRICOS","ASSINATURA"], 
                            
                            ["NOVA FOP","APROVAÇÕES","HISTÓRICOS","ASSINATURA"] 
                        )
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    LoadingSpinner: =LoadingSpinner.Data
                    TemplatePadding: =0
                    TemplateSize: =Parent.Width/CountRows(Self.AllItems)-1
                    Width: =739
                    X: =10
                    Y: =4
                    ZIndex: =1

                    MPR_rglSelected_T As rectangle:
                        Fill: =RGBA(239, 223, 0, 1)
                        Height: =Parent.TemplateHeight*0.08
                        OnSelect: =Select(Parent)
                        Visible: =ThisItem.IsSelected
                        Width: =Len(ThisItem.Value)*10
                        X: =(Parent.TemplateWidth - Len(ThisItem.Value)*10)/2
                        Y: =Parent.TemplateHeight*0.7
                        ZIndex: =1

                    MPR_btnView_T As button:
                        Color: =RGBA(0, 0, 0, 1)
                        Fill: =RGBA(0, 0, 0, 0)
                        Font: =Font.Arial
                        FontWeight: =If(ThisItem.IsSelected, FontWeight.Bold, FontWeight.Semibold)
                        Height: =Parent.TemplateHeight-5
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 0), -20%)
                        OnSelect: |+
                            =Select(Parent);
                            
                            Set(FOP_ApprovalFOPDetailsVisible, false);
                            Set(CodigoFOP, Blank());
                            
                            ResetForm(MPR_frmDetails_T);
                            
                        PressedBorderColor: =RGBA(166, 166, 166, 0)
                        PressedColor: =RGBA(0, 0, 0, 1)
                        PressedFill: =RGBA(0, 0, 0, 0)
                        Size: =12
                        Text: =ThisItem.Value
                        Width: =Parent.TemplateWidth
                        X: =Parent.TemplateWidth*0
                        ZIndex: =2

                Rectangle16 As rectangle:
                    AlignInContainer: =AlignInContainer.Stretch
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =10
                    LayoutMinWidth: =0
                    ZIndex: =2

                MPR_lblHistorical_T As label:
                    AlignInContainer: =AlignInContainer.Stretch
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Bold
                    Height: =30
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    PaddingBottom: =0
                    PaddingLeft: =15
                    PaddingRight: =0
                    PaddingTop: =0
                    Size: =14
                    Text: |-
                        ="FOP: " & CodigoFOP
                    Visible: =MPR_galNavigation_T.Selected.Value="HISTÓRICOS"
                    Width: =Parent.Width
                    X: =16
                    Y: =36
                    ZIndex: =3

                "MPR_galApprovals_T As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    '#CopilotOverlayLabel': ="Filtrada"
                    DelayItemLoading: =true
                    Height: =480
                    Items: |-
                        =Sort(
                            Filter(FOPs_MPR_EmValidacao, 
                                Or(
                                    Preparador.Email=User().Email,
                                    And(
                                        Aprovador.Email=User().Email,
                                        Data_AssPreparador<>Blank(),
                                        Data_AssAprovador=Blank()
                                    ),
                                    And(
                                        Fabricacao.Email=User().Email,
                                        Data_AssAprovador<>Blank(),
                                        Data_AssPreparador<>Blank()
                                    )
                                )       
                            ),
                            Criado, 
                            SortOrder.Descending
                        )
                    Layout: =Layout.Vertical
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    LoadingSpinner: =LoadingSpinner.Data
                    Selectable: =true 
                    TemplatePadding: =0
                    TemplateSize: =Parent.Width/8
                    Visible: |-
                        =And(
                            MPR_galNavigation_T.Selected.Value="APROVAÇÕES",
                            !FOP_ApprovalFOPDetailsVisible
                        )
                    Width: =Parent.Width
                    X: =13
                    Y: =89
                    ZIndex: =4

                    MLM_rtlSelected_1 As rectangle:
                        Fill: =RGBA(239, 223, 0, 1)
                        Height: =Parent.TemplateHeight
                        OnSelect: =Select(Parent)
                        Visible: =ThisItem.IsSelected
                        Width: |-
                            =If(ThisItem.IsSelected,
                                15,
                                0
                            )
                        X: =MLM_conInfoLeft_1.Width + MLM_conInfoRight_1.Width - Self.Width
                        ZIndex: =1

                    MLM_rtlSeparator_1 As rectangle:
                        Height: =2
                        OnSelect: =Select(Parent)
                        Width: =Parent.TemplateWidth
                        Y: =Parent.TemplateHeight-2
                        ZIndex: =2

                    MLM_conInfoRight_1 As groupContainer.verticalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        Height: =Parent.TemplateHeight
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMode: =LayoutMode.Auto
                        PaddingRight: =20
                        Width: =Parent.Width*(1/3)  - MLM_rtlSelected_1.Width/2
                        X: =MLM_conInfoLeft_1.Width
                        ZIndex: =3

                        MLM_lblCodigoFOP_1 As label:
                            Align: =Align.Right
                            AlignInContainer: =AlignInContainer.Stretch
                            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                            Height: |
                                =20
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingRight: =0
                            Text: |-
                                ="N°: " & ThisItem.Codigo_FOP
                            Width: =300
                            X: =401
                            ZIndex: =1

                        MLM_lblIndice_1 As label:
                            Align: =Align.Right
                            AlignInContainer: =AlignInContainer.Stretch
                            FillPortions: =1
                            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                            Height: =Self.Size * 1.8
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingRight: =0
                            PaddingTop: =0
                            Size: =10
                            Text: |-
                                ="Indice: " & Text(ThisItem.Indice_FOP)
                            VerticalAlign: =VerticalAlign.Top
                            Width: |
                                =100
                            X: =200
                            Y: =21
                            ZIndex: =2

                        MLM_icnShowFOP_1 As icon.ChevronRight:
                            AccessibleLabel: =Self.Tooltip
                            AlignInContainer: =AlignInContainer.End
                            Height: =40
                            Icon: =Icon.View
                            LayoutMinHeight: =0
                            OnSelect: |-
                                =ClearCollect(HistoricoFOP_MPR, 
                                    ForAll(
                                        Filter(FOPs_MPR_Historicos, Codigo_FOP=ThisItem.Codigo_FOP),
                                
                                        {Tipo_Registro: Tipo_Registro,
                                        Codigo_FOP: Codigo_FOP,
                                        Indice: Indice_FOP,
                                        Responsavel: Responsavel,
                                        Registro: Registro,
                                        Data: Data,
                                        Anexos: Anexos}
                                    )
                                );
                                
                                Set(MPRTabelaAfetacao, LookUp(FOPs_MPR_TabelaAfetacao, Codigo_FOP=ThisItem.Codigo_FOP && Indice_FOP=ThisItem.Indice_FOP && Validado=false));
                                
                                Set(FOP_ApprovalFOPDetailsVisible, true);
                            PaddingRight: =10
                            Tooltip: ="MOSTRAR FOP E NAVETTE"
                            Width: =40
                            X: =275
                            Y: =42
                            ZIndex: =3

                    MLM_conInfoLeft_1 As groupContainer.verticalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        Height: =Parent.TemplateHeight
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMode: =LayoutMode.Auto
                        Width: =Parent.Width*(2/3) - MLM_rtlSelected_1.Width/2
                        ZIndex: =4

                        MLM_lblAprovador_1 As label:
                            AlignInContainer: =AlignInContainer.Stretch
                            FillPortions: =1
                            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                            Height: =25
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            PaddingBottom: =0
                            PaddingLeft: =10
                            PaddingRight: =0
                            PaddingTop: =0
                            Size: =12
                            Text: |-
                                ="Aprovador: " & ThisItem.Aprovador.DisplayName
                            Width: =381
                            ZIndex: =1

                        MLM_lblPreparador_1 As label:
                            AlignInContainer: =AlignInContainer.Stretch
                            FillPortions: =1
                            Font: =Font.Arial
                            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                            Height: =20
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            PaddingBottom: =0
                            PaddingLeft: =10
                            PaddingRight: =0
                            PaddingTop: =0
                            Size: =10
                            Text: |-
                                ="Preparador: " & ThisItem.Preparador.DisplayName
                            VerticalAlign: =VerticalAlign.Top
                            Width: =300
                            Y: =22
                            ZIndex: =2

                        MLM_lblProcesso_1 As label:
                            AlignInContainer: =AlignInContainer.Stretch
                            FillPortions: =1
                            Font: =Font.Arial
                            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                            Height: =20
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            PaddingBottom: =0
                            PaddingLeft: =10
                            PaddingRight: =0
                            PaddingTop: =0
                            Size: =10
                            Text: |-
                                ="Processo: " & ThisItem.Processo
                            VerticalAlign: =VerticalAlign.Bottom
                            Width: =544
                            Y: =52
                            ZIndex: =3

                        MLM_lblDataOficilizacao_1 As label:
                            AlignInContainer: =AlignInContainer.Stretch
                            FillPortions: =1
                            Font: =Font.Arial
                            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                            Height: =20
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            PaddingLeft: =10
                            PaddingRight: =0
                            PaddingTop: =0
                            Size: =10
                            Text: |-
                                ="Criado: " & ThisItem.Criado
                            Width: =544
                            Y: =76
                            ZIndex: =4

                "MPR_galConfirmations_T As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    '#CopilotOverlayLabel': ="Filtrada"
                    DelayItemLoading: =true
                    Height: =480
                    Items: |-
                        =Sort(
                            Filter(FOPs_MPR_EmUso, 
                                Or(
                                    And(
                                        Preparador.Email=User().Email,
                                        Or(
                                            Indice_APW=false,
                                            FOS_Validada=false
                                        )
                                    ),
                                    And(
                                        Aprovador.Email=User().Email,
                                        Or(
                                            Indice_APW=false,
                                            FOS_Validada=false
                                        )
                                    ),
                                    And(
                                        Fabricacao.Email=User().Email,
                                        FOS_Criada=false
                                    )           
                                )       
                            ),
                            Criado, 
                            SortOrder.Descending
                        )
                    Layout: =Layout.Vertical
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    LoadingSpinner: =LoadingSpinner.Data
                    Selectable: =true 
                    TemplatePadding: =0
                    TemplateSize: =Parent.Width/8
                    Visible: |
                        =MPR_galNavigation_T.Selected.Value="CONFIRMAÇÕES"
                    Width: =Parent.Width
                    X: =13
                    Y: =89
                    ZIndex: =5

                    MLM_rtlSelected_2 As rectangle:
                        Fill: =RGBA(239, 223, 0, 1)
                        Height: =Parent.TemplateHeight
                        OnSelect: =Select(Parent)
                        Visible: =ThisItem.IsSelected
                        Width: |-
                            =If(ThisItem.IsSelected,
                                15,
                                0
                            )
                        X: =MLM_conInfoLeft_2.Width + MLM_conInfoRight_2.Width - Self.Width
                        ZIndex: =1

                    MLM_rtlSeparator_2 As rectangle:
                        Height: =2
                        OnSelect: =Select(Parent)
                        Width: =Parent.TemplateWidth
                        Y: =Parent.TemplateHeight-2
                        ZIndex: =2

                    MLM_conInfoRight_2 As groupContainer.verticalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        Height: =Parent.TemplateHeight
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMode: =LayoutMode.Auto
                        PaddingRight: =20
                        Width: =Parent.Width*(1/3)  - MLM_rtlSelected_2.Width/2
                        X: =MLM_conInfoLeft_2.Width
                        ZIndex: =3

                        MLM_lblCodigoFOP_2 As label:
                            Align: =Align.Right
                            AlignInContainer: =AlignInContainer.Stretch
                            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                            Height: |
                                =20
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingRight: =0
                            Text: |-
                                ="N°: " & ThisItem.Codigo_FOP
                            Width: =300
                            X: =401
                            ZIndex: =1

                        MLM_lblIndice_2 As label:
                            Align: =Align.Right
                            AlignInContainer: =AlignInContainer.Stretch
                            FillPortions: =1
                            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                            Height: =Self.Size * 1.8
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingRight: =0
                            PaddingTop: =0
                            Size: =10
                            Text: |-
                                ="Indice: " & Text(ThisItem.Indice_FOP)
                            VerticalAlign: =VerticalAlign.Top
                            Width: |
                                =100
                            X: =200
                            Y: =21
                            ZIndex: =2

                        MLM_icnShowFOP_2 As icon.ChevronRight:
                            AccessibleLabel: =Self.Tooltip
                            AlignInContainer: =AlignInContainer.End
                            Height: =40
                            Icon: =Icon.View
                            LayoutMinHeight: =0
                            OnSelect: |-
                                =Set(FOP_PDF, LookUp(MPR_galConfirmations_T.Selected.Anexos, EndsWith(DisplayName, ".pdf"), Value));
                                
                                Set(PDFViewVisible, true);
                            PaddingRight: =10
                            Tooltip: ="MOSTRAR FOP"
                            Width: =40
                            X: =275
                            Y: =42
                            ZIndex: =3

                    MLM_conInfoLeft_2 As groupContainer.verticalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        Height: =Parent.TemplateHeight
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMode: =LayoutMode.Auto
                        Width: =Parent.Width*(2/3) - MLM_rtlSelected_2.Width/2
                        ZIndex: =4

                        MLM_lblAprovador_2 As label:
                            AlignInContainer: =AlignInContainer.Stretch
                            FillPortions: =1
                            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                            Height: =25
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            PaddingBottom: =0
                            PaddingLeft: =10
                            PaddingRight: =0
                            PaddingTop: =0
                            Size: =12
                            Text: |-
                                ="Aprovador: " & ThisItem.Aprovador.DisplayName
                            Width: =381
                            ZIndex: =1

                        MLM_lblPreparador_2 As label:
                            AlignInContainer: =AlignInContainer.Stretch
                            FillPortions: =1
                            Font: =Font.Arial
                            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                            Height: =20
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            PaddingBottom: =0
                            PaddingLeft: =10
                            PaddingRight: =0
                            PaddingTop: =0
                            Size: =10
                            Text: |-
                                ="Preparador: " & ThisItem.Preparador.DisplayName
                            VerticalAlign: =VerticalAlign.Top
                            Width: =300
                            Y: =22
                            ZIndex: =2

                        MLM_lblProcesso_2 As label:
                            AlignInContainer: =AlignInContainer.Stretch
                            FillPortions: =1
                            Font: =Font.Arial
                            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                            Height: =20
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            PaddingBottom: =0
                            PaddingLeft: =10
                            PaddingRight: =0
                            PaddingTop: =0
                            Size: =10
                            Text: |-
                                ="Processo: " & ThisItem.Processo
                            VerticalAlign: =VerticalAlign.Bottom
                            Width: =544
                            Y: =52
                            ZIndex: =3

                        MLM_lblDataOficilizacao_2 As label:
                            AlignInContainer: =AlignInContainer.Stretch
                            FillPortions: =1
                            Font: =Font.Arial
                            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                            Height: =20
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            PaddingLeft: =10
                            PaddingRight: =0
                            PaddingTop: =0
                            Size: =10
                            Text: |-
                                ="Criado: " & ThisItem.Criado
                            Width: =544
                            Y: =76
                            ZIndex: =4

                "MPR_galHistorical_T As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    '#CopilotOverlayLabel': ="Filtrada"
                    Default: |-
                        =/*First(
                            Sort(
                                Self.AllItems;
                                Data; 
                                SortOrder.Descending
                            )
                        )*/
                    DelayItemLoading: =true
                    Height: =480
                    Items: |-
                        =Sort(
                            HistoricoFOP_MPR,
                            Data, 
                            SortOrder.Descending
                        )
                    Layout: =Layout.Vertical
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    LoadingSpinner: =LoadingSpinner.Data
                    Selectable: =true 
                    TemplatePadding: =0
                    TemplateSize: =Parent.Width/8
                    Visible: |
                        =MPR_galNavigation_T.Selected.Value="HISTÓRICOS"
                    Width: =Parent.Width
                    X: =13
                    Y: =89
                    ZIndex: =6

                    MLM_rtlSelected_3 As rectangle:
                        Fill: =RGBA(239, 223, 0, 1)
                        Height: =Parent.TemplateHeight
                        OnSelect: =Select(Parent)
                        Visible: =ThisItem.IsSelected
                        Width: |-
                            =If(ThisItem.IsSelected,
                                15,
                                0
                            )
                        X: =MHT_conInfoLeft.Width + MHT_conInfoRight.Width - Self.Width
                        ZIndex: =1

                    MLM_rtlSeparator_3 As rectangle:
                        Height: =2
                        OnSelect: =Select(Parent)
                        Width: =Parent.TemplateWidth
                        Y: =Parent.TemplateHeight-2
                        ZIndex: =2

                    MHT_conInfoRight As groupContainer.verticalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        Height: =Parent.TemplateHeight
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMode: =LayoutMode.Auto
                        PaddingRight: =20
                        Width: =Parent.Width*(1/3)  - MLM_rtlSelected_3.Width/2
                        X: =MHT_conInfoLeft.Width
                        ZIndex: =3

                        MHT_lblData As label:
                            Align: =Align.Right
                            AlignInContainer: =AlignInContainer.Stretch
                            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                            Height: |
                                =20
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingRight: =0
                            Text: =ThisItem.Data
                            Width: =300
                            X: =401
                            ZIndex: =1

                        MHT_lblIndiceFOP As label:
                            Align: =Align.Right
                            AlignInContainer: =AlignInContainer.Stretch
                            FillPortions: =1
                            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                            Height: =Self.Size * 1.8
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingRight: =0
                            PaddingTop: =0
                            Size: =10
                            Text: |-
                                ="Indice: " & Text(ThisItem.Indice_FOP)
                            VerticalAlign: =VerticalAlign.Top
                            Width: |
                                =100
                            X: =200
                            Y: =21
                            ZIndex: =2

                        MHT_attAnexos As attachments:
                            AlignInContainer: =AlignInContainer.End
                            BorderColor: =RGBA(136, 139, 141, 1)
                            BorderThickness: =1
                            DisabledBorderColor: =RGBA(136, 139, 141, 1)
                            DisabledColor: =RGBA(62, 63, 64, 1)
                            DisabledFill: =RGBA(0, 0, 0, 0)
                            DisplayMode: =DisplayMode.View
                            DropTargetBorderThickness: =1
                            Fill: =RGBA(0, 0, 0, 0)
                            FillPortions: =3
                            FocusedBorderThickness: =1
                            Font: =Font.Arial
                            Height: =45
                            HoverFill: =RGBA(136, 139, 141, 1)
                            IsInDataCard: =true
                            ItemFill: =RGBA(136, 139, 141, 1)
                            ItemHoverColor: =RGBA(255, 255, 255, 1)
                            ItemHoverFill: =RGBA(62, 63, 64, 1)
                            Items: =ThisItem.Anexos
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            PaddingBottom: =5
                            PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                            PaddingRight: =5
                            PaddingTop: =5
                            PressedFill: =RGBA(136, 139, 141, 1)
                            Size: =8
                            Tooltip: ="" 
                            Visible: |
                                =!IsEmpty(Self.Attachments)
                            Width: =Parent.Width/2
                            Y: =40
                            ZIndex: =3

                    MHT_conInfoLeft As groupContainer.verticalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        Height: =Parent.TemplateHeight
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMode: =LayoutMode.Auto
                        Width: =Parent.Width*(2/3) - MLM_rtlSelected_3.Width/2
                        ZIndex: =4

                        MHT_lblTipoRegistro As label:
                            AlignInContainer: =AlignInContainer.Stretch
                            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                            Height: =30
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            PaddingBottom: =0
                            PaddingLeft: =10
                            PaddingRight: =0
                            PaddingTop: =0
                            Size: =12
                            Text: =ThisItem.Tipo_Registro
                            Width: =381
                            ZIndex: =1

                        MHT_lblResponsavel As label:
                            AlignInContainer: =AlignInContainer.Stretch
                            Font: =Font.Arial
                            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                            Height: =30
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            PaddingBottom: =0
                            PaddingLeft: =10
                            PaddingRight: =0
                            PaddingTop: =0
                            Size: =10
                            Text: |-
                                ="Por: " & ThisItem.Responsavel.DisplayName
                            VerticalAlign: =VerticalAlign.Top
                            Width: =300
                            Y: =22
                            ZIndex: =2

                        MHT_lblRegistro As label:
                            AlignInContainer: =AlignInContainer.Stretch
                            FillPortions: =1
                            Font: =Font.Arial
                            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                            Height: =20
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            PaddingBottom: =0
                            PaddingLeft: =10
                            PaddingRight: =0
                            PaddingTop: =0
                            Size: =10
                            Text: =ThisItem.Registro
                            VerticalAlign: =VerticalAlign.Top
                            Width: =544
                            Y: =52
                            ZIndex: =3

                MPR_conForms_T As groupContainer.manualLayoutContainer:
                    DropShadow: =DropShadow.None
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    Visible: =MPR_galNavigation_T.Selected.Value="NOVA FOP"
                    ZIndex: =7

                    MPR_frmNewFOP_T As form:
                        DataSource: =FOPs_MPR_EmValidacao
                        Height: =Parent.Height
                        Item: =Defaults(FOPs_MPR_EmValidacao)
                        Width: =Parent.Width
                        ZIndex: =1

                        MNF_crdProcesso_T As typedDataCard.textualEditCard:
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="Processo"
                            Default: =ThisItem.Processo
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: =DataSourceInfo([@FOPs_MPR_EmValidacao],DataSourceInfo.DisplayName,Processo)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =Parent.Height*0.11
                            MaxLength: =DataSourceInfo([@FOPs_MPR_EmValidacao], DataSourceInfo.MaxLength, Processo)
                            Required: =false
                            Update: =MNF_inpProcesso_T.Text
                            Width: =Parent.Width*2/3
                            X: =1
                            Y: =1
                            ZIndex: =1

                            MNF_lblProcesso_T As label:
                                Align: =Align.Right
                                Color: =RGBA(0, 0, 0, 1)
                                DisabledColor: =RGBA(0, 0, 0, 1)
                                Font: =Font.Arial
                                Height: =Parent.Height
                                Size: =12
                                Text: |-
                                    ="Título:"
                                Width: =100
                                Wrap: =false
                                ZIndex: =3

                            MNF_inpProcesso_T As text:
                                BorderColor: =If(IsBlank(FOPF_ProcessoCard_1.Error), FOPF_ProcessoCard_1.BorderColor, Color.Red)
                                BorderThickness: =1
                                Clear: =true
                                Default: =FOPF_ProcessoCard_1.Default
                                DelayOutput: =true
                                DisabledBorderColor: =RGBA(136, 139, 141, 1)
                                DisabledColor: =RGBA(62, 63, 64, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                DisplayMode: =Parent.DisplayMode
                                Fill: =RGBA(0, 0, 0, 0)
                                Font: =Font.Arial
                                FontWeight: =FontWeight.Bold
                                Height: =Parent.Height*0.8
                                HoverBorderColor: =RGBA(136, 139, 141, 1)
                                HoverFill: =RGBA(187, 188, 188, 1)
                                PaddingLeft: =5
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =12
                                Tooltip: =FOPF_ProcessoCard_1.DisplayName
                                Width: =Parent.Width - Self.X - 15
                                X: =MNF_lblProcesso_T.Width
                                Y: =Parent.Height/2 - Self.Height/2
                                ZIndex: =4

                        MNF_crdUsina_T As typedDataCard.textualEditCard:
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="Usina"
                            Default: =ThisItem.Usina
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: =DataSourceInfo([@FOPs_MPR_EmValidacao],DataSourceInfo.DisplayName,Usina)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =Parent.Height*0.11
                            MaxLength: =DataSourceInfo([@FOPs_MPR_EmValidacao], DataSourceInfo.MaxLength, Usina)
                            Required: =false
                            Update: =MNF_cbxUsina_T.Selected.Value
                            Width: =Parent.Width/3
                            X: =0
                            Y: =0
                            ZIndex: =3

                            MNF_lblUsina_T As label:
                                Align: =Align.Right
                                Color: =RGBA(0, 0, 0, 1)
                                DisabledColor: =RGBA(0, 0, 0, 1)
                                Font: =Font.Arial
                                Height: =Parent.Height
                                Size: =12
                                Text: |-
                                    ="Usina:"
                                Width: |
                                    =80
                                Wrap: =false
                                ZIndex: =1

                            MNF_cbxUsina_T As combobox:
                                BorderColor: =RGBA(136, 139, 141, 1)
                                BorderThickness: =1
                                ChevronBackground: =RGBA(239, 223, 0, 1)
                                ChevronDisabledBackground: =RGBA(0, 0, 0, 0)
                                ChevronDisabledFill: =RGBA(62, 63, 64, 1)
                                ChevronFill: =RGBA(0, 0, 0, 1)
                                ChevronHoverBackground: =ColorFade(RGBA(136, 139, 141, 1), -20%)
                                Default: =Blank()
                                DefaultSelectedItems: |-
                                    ={Value: FOPF_UsinaCard_1.Default}
                                DisabledBorderColor: =RGBA(136, 139, 141, 1)
                                DisabledColor: =RGBA(62, 63, 64, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                DisplayFields: =["Value"]
                                Fill: =RGBA(217, 217, 214, 1)
                                Font: =Font.Arial
                                Height: =Parent.Height*0.8
                                HoverColor: =RGBA(255, 255, 255, 1)
                                HoverFill: =RGBA(136, 139, 141, 1)
                                InputTextPlaceholder: =
                                IsSearchable: =false
                                Items: =Distinct(Pastas_FOPs_MPR, Usina)
                                NoSelectionText: =
                                OnChange: |-
                                    =Reset(MNF_cbxProjeto_T);
                                    Reset(MNF_cbxDiversidade_T);
                                    Reset(MNF_cbxUET_T);
                                    Reset(MNF_cbxPosto_T);
                                PressedColor: =RGBA(0, 0, 0, 1)
                                PressedFill: =RGBA(136, 139, 141, 1)
                                SearchFields: =["Value"]
                                SearchItems: =[]
                                SelectionColor: =RGBA(0, 0, 0, 1)
                                SelectionFill: =RGBA(239, 223, 0, 1)
                                SelectMultiple: =false
                                Size: =12
                                Width: =Parent.Width - Self.X - 15
                                X: =MNF_lblUsina_T.Width
                                Y: =Parent.Height/2 - Self.Height/2
                                ZIndex: =2

                        MNF_crdUET_T As typedDataCard.textualEditCard:
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="UET"
                            Default: =ThisItem.UET
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: =DataSourceInfo([@FOPs_MPR_EmValidacao],DataSourceInfo.DisplayName,UET)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =Parent.Height*0.11
                            MaxLength: =DataSourceInfo([@FOPs_MPR_EmValidacao], DataSourceInfo.MaxLength, UET)
                            Required: =false
                            Update: =MNF_cbxUET_T.Selected.Value
                            Width: =Parent.Width/3
                            X: =1
                            Y: =0
                            ZIndex: =3

                            MNF_lblUET_T As label:
                                Align: =Align.Right
                                Color: =RGBA(0, 0, 0, 1)
                                DisabledColor: =RGBA(0, 0, 0, 1)
                                Font: =Font.Arial
                                Height: =Parent.Height
                                Size: =12
                                Text: |-
                                    ="UET:"
                                Width: =100
                                Wrap: =false
                                ZIndex: =1

                            MNF_cbxUET_T As combobox:
                                BorderColor: =RGBA(136, 139, 141, 1)
                                BorderThickness: =1
                                ChevronBackground: =RGBA(239, 223, 0, 1)
                                ChevronDisabledBackground: =RGBA(0, 0, 0, 0)
                                ChevronDisabledFill: =RGBA(62, 63, 64, 1)
                                ChevronFill: =RGBA(0, 0, 0, 1)
                                ChevronHoverBackground: =ColorFade(RGBA(136, 139, 141, 1), -20%)
                                Default: =Blank()
                                DefaultSelectedItems: |-
                                    ={Value: FOPF_UsinaCard_1.Default}
                                DisabledBorderColor: =RGBA(136, 139, 141, 1)
                                DisabledColor: =RGBA(62, 63, 64, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                DisplayFields: =["Value"]
                                Fill: =RGBA(217, 217, 214, 1)
                                Font: =Font.Arial
                                Height: =Parent.Height*0.8
                                HoverColor: =RGBA(255, 255, 255, 1)
                                HoverFill: =RGBA(136, 139, 141, 1)
                                InputTextPlaceholder: =
                                IsSearchable: =false
                                Items: |-
                                    =Distinct(
                                        Filter(
                                            Pastas_FOPs_MPR,
                                            Usina=MNF_cbxUsina_T.Selected.Value,
                                            Projeto=MNF_cbxProjeto_T.Selected.Value,
                                            Diversidade=MNF_cbxDiversidade_T.Selected.Value
                                        ),
                                        UET
                                    )
                                NoSelectionText: =
                                OnChange: =Reset(MNF_cbxPosto_T);
                                PressedColor: =RGBA(0, 0, 0, 1)
                                PressedFill: =RGBA(136, 139, 141, 1)
                                SearchFields: =["Value"]
                                SearchItems: =[]
                                SelectionColor: =RGBA(0, 0, 0, 1)
                                SelectionFill: =RGBA(239, 223, 0, 1)
                                SelectMultiple: =false
                                Size: =12
                                Width: |
                                    =Parent.Width - Self.X - 15
                                X: =MNF_lblUET_T.Width
                                Y: =Parent.Height/2 - Self.Height/2
                                ZIndex: =2

                        MNF_crdPosto_T As typedDataCard.textualEditCard:
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="Posto"
                            Default: =ThisItem.Posto
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: =DataSourceInfo([@FOPs_MPR_EmValidacao],DataSourceInfo.DisplayName,Posto)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =Parent.Height*0.11
                            MaxLength: =DataSourceInfo([@FOPs_MPR_EmValidacao], DataSourceInfo.MaxLength, Posto)
                            Required: =false
                            Update: =MNF_cbxPosto_T.Selected.Value
                            Width: =Parent.Width/3
                            X: =2
                            Y: =0
                            ZIndex: =3

                            MNF_lblPosto_T As label:
                                Align: =Align.Right
                                Color: =RGBA(0, 0, 0, 1)
                                DisabledColor: =RGBA(0, 0, 0, 1)
                                Font: =Font.Arial
                                Height: =Parent.Height
                                Size: =12
                                Text: |-
                                    ="Posto:"
                                Width: =100
                                Wrap: =false
                                Y: |
                                    =0
                                ZIndex: =1

                            MNF_cbxPosto_T As combobox:
                                BorderColor: =RGBA(136, 139, 141, 1)
                                BorderThickness: =1
                                ChevronBackground: =RGBA(239, 223, 0, 1)
                                ChevronDisabledBackground: =RGBA(0, 0, 0, 0)
                                ChevronDisabledFill: =RGBA(62, 63, 64, 1)
                                ChevronFill: =RGBA(0, 0, 0, 1)
                                ChevronHoverBackground: =ColorFade(RGBA(136, 139, 141, 1), -20%)
                                Default: =Blank()
                                DefaultSelectedItems: |-
                                    ={Value: FOPF_UsinaCard_1.Default}
                                DisabledBorderColor: =RGBA(136, 139, 141, 1)
                                DisabledColor: =RGBA(62, 63, 64, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                DisplayFields: =["Value"]
                                Fill: =RGBA(217, 217, 214, 1)
                                Font: =Font.Arial
                                Height: =Parent.Height*0.8
                                HoverColor: =RGBA(255, 255, 255, 1)
                                HoverFill: =RGBA(136, 139, 141, 1)
                                InputTextPlaceholder: ="Procurar"
                                Items: |-
                                    =Distinct(
                                        Filter(
                                            Pastas_FOPs_MPR,
                                            Usina=MNF_cbxUsina_T.Selected.Value,
                                            Projeto=MNF_cbxProjeto_T.Selected.Value,
                                            Diversidade=MNF_cbxDiversidade_T.Selected.Value,
                                            UET=MNF_cbxUET_T.Selected.Value
                                        ),
                                        Posto
                                    )
                                NoSelectionText: ="Procurar"
                                OnChange: =
                                PressedColor: =RGBA(0, 0, 0, 1)
                                PressedFill: =RGBA(136, 139, 141, 1)
                                SearchFields: =["Value"]
                                SearchItems: |-
                                    =Search(Distinct(
                                        Filter(
                                            Pastas_FOPs_MPR,
                                            Usina=MNF_cbxUsina_T.Selected.Value,
                                            Projeto=MNF_cbxProjeto_T.Selected.Value,
                                            Diversidade=MNF_cbxDiversidade_T.Selected.Value,
                                            UET=MNF_cbxUET_T.Selected.Value
                                        ),
                                        Posto
                                    ),MNF_cbxPosto_T.SearchText,Value)
                                SelectionColor: =RGBA(0, 0, 0, 1)
                                SelectionFill: =RGBA(239, 223, 0, 1)
                                SelectMultiple: =false
                                Size: =12
                                Width: =Parent.Width - Self.X - 15
                                X: =MNF_lblPosto_T.Width
                                Y: =Parent.Height/2 - Self.Height/2
                                ZIndex: =2

                        MNF_crdProjeto_T As typedDataCard.textualEditCard:
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="Projeto"
                            Default: =ThisItem.Projeto
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: =DataSourceInfo([@FOPs_MPR_EmValidacao],DataSourceInfo.DisplayName,Projeto)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =Parent.Height*0.11
                            MaxLength: =DataSourceInfo([@FOPs_MPR_EmValidacao], DataSourceInfo.MaxLength, Projeto)
                            Required: =false
                            Update: =MNF_cbxProjeto_T.Selected.Value
                            Width: =Parent.Width/3
                            X: =0
                            Y: =1
                            ZIndex: =3

                            MNF_lblProjeto_T As label:
                                Align: =Align.Right
                                Color: =RGBA(0, 0, 0, 1)
                                DisabledColor: =RGBA(0, 0, 0, 1)
                                Font: =Font.Arial
                                Height: =Parent.Height
                                Size: =12
                                Text: |-
                                    ="Projeto:"
                                Width: |
                                    =80
                                Wrap: =false
                                ZIndex: =1

                            MNF_cbxProjeto_T As combobox:
                                BorderColor: =RGBA(136, 139, 141, 1)
                                BorderThickness: =1
                                ChevronBackground: =RGBA(239, 223, 0, 1)
                                ChevronDisabledBackground: =RGBA(0, 0, 0, 0)
                                ChevronDisabledFill: =RGBA(62, 63, 64, 1)
                                ChevronFill: =RGBA(0, 0, 0, 1)
                                ChevronHoverBackground: =ColorFade(RGBA(136, 139, 141, 1), -20%)
                                Default: =Blank()
                                DefaultSelectedItems: |-
                                    ={Value: FOPF_UsinaCard_1.Default}
                                DisabledBorderColor: =RGBA(136, 139, 141, 1)
                                DisabledColor: =RGBA(62, 63, 64, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                DisplayFields: =["Value"]
                                Fill: =RGBA(217, 217, 214, 1)
                                Font: =Font.Arial
                                Height: =Parent.Height*0.8
                                HoverColor: =RGBA(255, 255, 255, 1)
                                HoverFill: =RGBA(136, 139, 141, 1)
                                InputTextPlaceholder: =
                                IsSearchable: =false
                                Items: |-
                                    =Distinct(
                                        Filter(
                                            Pastas_FOPs_MPR,
                                            Usina=MNF_cbxUsina_T.Selected.Value
                                        ),
                                        Projeto
                                    )
                                NoSelectionText: =
                                OnChange: |-
                                    =Reset(MNF_cbxDiversidade_T);
                                    Reset(MNF_cbxUET_T);
                                    Reset(MNF_cbxPosto_T);
                                PressedColor: =RGBA(0, 0, 0, 1)
                                PressedFill: =RGBA(136, 139, 141, 1)
                                SearchFields: =["Value"]
                                SearchItems: =[]
                                SelectionColor: =RGBA(0, 0, 0, 1)
                                SelectionFill: =RGBA(239, 223, 0, 1)
                                SelectMultiple: =false
                                Size: =12
                                Width: =Parent.Width - Self.X - 15
                                X: =MNF_lblProjeto_T.Width
                                Y: =Parent.Height/2 - Self.Height/2
                                ZIndex: =2

                        MNF_crdDiversidade_T As typedDataCard.textualEditCard:
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="Diversidade"
                            Default: =ThisItem.Diversidade
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: =DataSourceInfo([@FOPs_MPR_EmValidacao],DataSourceInfo.DisplayName,Diversidade)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =Parent.Height*0.11
                            MaxLength: =DataSourceInfo([@FOPs_MPR_EmValidacao], DataSourceInfo.MaxLength, Diversidade)
                            Required: =false
                            Update: =MNF_cbxDiversidade_T.Selected.Value
                            Width: =Parent.Width/3
                            X: =0
                            Y: =2
                            ZIndex: =3

                            MNF_lblDiversidade_T As label:
                                Align: =Align.Right
                                Color: =RGBA(0, 0, 0, 1)
                                DisabledColor: =RGBA(0, 0, 0, 1)
                                Font: =Font.Arial
                                Height: =Parent.Height
                                Size: =12
                                Text: |-
                                    ="Diversidade:"
                                Width: =80 - Self.X
                                Wrap: =false
                                X: =15
                                ZIndex: =2

                            MNF_cbxDiversidade_T As combobox:
                                BorderColor: =RGBA(136, 139, 141, 1)
                                BorderThickness: =1
                                ChevronBackground: =RGBA(239, 223, 0, 1)
                                ChevronDisabledBackground: =RGBA(0, 0, 0, 0)
                                ChevronDisabledFill: =RGBA(62, 63, 64, 1)
                                ChevronFill: =RGBA(0, 0, 0, 1)
                                ChevronHoverBackground: =ColorFade(RGBA(136, 139, 141, 1), -20%)
                                Default: =Blank()
                                DefaultSelectedItems: |-
                                    ={Value: FOPF_UsinaCard_1.Default}
                                DisabledBorderColor: =RGBA(136, 139, 141, 1)
                                DisabledColor: =RGBA(62, 63, 64, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                DisplayFields: =["Value"]
                                Fill: =RGBA(217, 217, 214, 1)
                                Font: =Font.Arial
                                Height: =Parent.Height*0.8
                                HoverColor: =RGBA(255, 255, 255, 1)
                                HoverFill: =RGBA(136, 139, 141, 1)
                                InputTextPlaceholder: =
                                IsSearchable: =false
                                Items: |-
                                    =Distinct(
                                        Filter(
                                            Pastas_FOPs_MPR,
                                            Usina=MNF_cbxUsina_T.Selected.Value,
                                            Projeto=MNF_cbxProjeto_T.Selected.Value
                                        ),
                                        Diversidade
                                    )
                                NoSelectionText: =
                                OnChange: |-
                                    =Reset(MNF_cbxUET_T);
                                    Reset(MNF_cbxPosto_T);
                                PressedColor: =RGBA(0, 0, 0, 1)
                                PressedFill: =RGBA(136, 139, 141, 1)
                                SearchFields: =["Value"]
                                SearchItems: =[]
                                SelectionColor: =RGBA(0, 0, 0, 1)
                                SelectionFill: =RGBA(239, 223, 0, 1)
                                SelectMultiple: =false
                                Size: =12
                                Width: =Parent.Width - Self.X - 15
                                X: =MNF_lblDiversidade_T.Width + MNF_lblDiversidade_T.X
                                Y: =Parent.Height/2 - Self.Height/2
                                ZIndex: =3

                        MNF_crdAprovador_T As typedDataCard.comboBoxEditCard:
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="Aprovador"
                            Default: =ThisItem.Aprovador
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: =DataSourceInfo([@FOPs_MPR_EmValidacao],DataSourceInfo.DisplayName,Aprovador)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =Parent.Height*0.11
                            Required: =false
                            Update: =MNF_cbxAprovador_T.Selected
                            Width: =Parent.Width*2/3
                            X: =1
                            Y: =2
                            ZIndex: =3

                            MNF_cbxAprovador_T As combobox:
                                BorderColor: =RGBA(136, 139, 141, 1)
                                BorderThickness: =1
                                ChevronBackground: =RGBA(239, 223, 0, 1)
                                ChevronDisabledBackground: =RGBA(0, 0, 0, 0)
                                ChevronDisabledFill: =RGBA(51, 51, 51, 1)
                                ChevronFill: =RGBA(0, 0, 0, 1)
                                ChevronHoverBackground: =ColorFade(RGBA(136, 139, 141, 1), -20%)
                                DefaultSelectedItems: =
                                DisabledColor: =RGBA(0, 0, 0, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                DisplayFields: =["DisplayName","Email","Picture"]
                                DisplayMode: |
                                    =DisplayMode.Edit
                                Fill: =RGBA(217, 217, 214, 1)
                                Font: =Font.Arial
                                Height: =Parent.Height*0.8
                                HoverColor: =RGBA(255, 255, 255, 1)
                                HoverFill: =RGBA(136, 139, 141, 1)
                                InputTextPlaceholder: ="Responsável da Engenharia"
                                Items: =Choices([@FOPs_SommaireContents].Aprovador)
                                NoSelectionText: ="Responsável da Engenharia"
                                OnChange: |-
                                    =If(Self.Selected.Email=MNF_cbxFabricacao_T.Selected.Email,
                                        Notify("O APROVADOR e RESP. FABRICAÇÃO da FOP não podem ser o mesmo.", NotificationType.Warning);
                                        Reset(Self)
                                    )
                                PressedColor: =RGBA(0, 0, 0, 1)
                                PressedFill: =RGBA(136, 139, 141, 1)
                                SearchFields: =["Email"]
                                SearchItems: =Choices(FOPs_SommaireContents.Aprovador,MNF_cbxAprovador_T.SearchText)
                                SelectionColor: =RGBA(0, 0, 0, 1)
                                SelectionFill: =RGBA(239, 223, 0, 1)
                                SelectMultiple: =false
                                Size: =12
                                Template: =ListItemTemplate.Person
                                Width: =Parent.Width - Self.X - 15
                                X: =MNF_lblAprovador_T.Width
                                Y: =Parent.Height/2 - Self.Height/2
                                ZIndex: =2

                            MNF_lblAprovador_T As label:
                                Align: =Align.Right
                                Color: =RGBA(0, 0, 0, 1)
                                DisabledColor: =RGBA(0, 0, 0, 1)
                                Font: =Font.Arial
                                Height: =Parent.Height
                                Size: =12
                                Text: |-
                                    ="Aprovador:"
                                Width: =100
                                Wrap: =false
                                ZIndex: =3

                        MNF_crdIndice_T As typedDataCard.numberEditCard:
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="Indice_FOP"
                            Default: =ThisItem.Indice_FOP
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: =DataSourceInfo([@FOPs_MPR_EmValidacao],DataSourceInfo.DisplayName,Indice_FOP)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =Parent.Height*0.11
                            Required: =false
                            Update: =Value(MNF_inpIndice_T.Text)
                            Width: =Parent.Width/3
                            X: =0
                            Y: =3
                            ZIndex: =3

                            MNF_inpIndice_T As text:
                                Align: =Align.Center
                                BorderColor: =If(IsBlank(FOPF_IndiceCard_1.Error), FOPF_IndiceCard_1.BorderColor, Color.Red)
                                BorderThickness: =1
                                Default: =FOPF_IndiceCard_1.Default
                                DelayOutput: =true
                                DisabledBorderColor: =RGBA(136, 139, 141, 1)
                                DisabledColor: =RGBA(62, 63, 64, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                DisplayMode: =Parent.DisplayMode
                                Fill: =RGBA(0, 0, 0, 0)
                                Font: =Font.Arial
                                FontWeight: =FontWeight.Bold
                                Height: =Parent.Height*0.8
                                HoverBorderColor: =RGBA(136, 139, 141, 1)
                                HoverFill: =RGBA(187, 188, 188, 1)
                                MaxLength: =100
                                PaddingLeft: =5
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =12
                                Tooltip: =FOPF_IndiceCard_1.DisplayName
                                Width: =Parent.Width - Self.X - 15
                                X: =MNF_lblIndice_T.Width
                                Y: =Parent.Height/2 - Self.Height/2
                                ZIndex: =2

                            MNF_lblIndice_T As label:
                                Align: =Align.Right
                                Color: =RGBA(0, 0, 0, 1)
                                DisabledColor: =RGBA(0, 0, 0, 1)
                                Font: =Font.Arial
                                Height: =Parent.Height
                                Size: =12
                                Text: |-
                                    ="Indice:"
                                Width: |
                                    =80
                                Wrap: =false
                                ZIndex: =3

                        MNF_crdFabricacao_T As typedDataCard.comboBoxEditCard:
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="Fabricacao"
                            Default: =ThisItem.Fabricacao
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: =DataSourceInfo([@FOPs_MPR_EmValidacao],DataSourceInfo.DisplayName,Fabricacao)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =Parent.Height*0.11
                            Required: =false
                            Update: =MNF_cbxFabricacao_T.Selected
                            Width: =Parent.Width*2/3
                            X: =1
                            Y: =3
                            ZIndex: =3

                            MNF_cbxFabricacao_T As combobox:
                                BorderColor: =RGBA(136, 139, 141, 1)
                                BorderThickness: =1
                                ChevronBackground: =RGBA(239, 223, 0, 1)
                                ChevronDisabledBackground: =RGBA(0, 0, 0, 0)
                                ChevronDisabledFill: =RGBA(51, 51, 51, 1)
                                ChevronFill: =RGBA(0, 0, 0, 1)
                                ChevronHoverBackground: =ColorFade(RGBA(136, 139, 141, 1), -20%)
                                DefaultSelectedItems: =
                                DisabledColor: =RGBA(0, 0, 0, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                DisplayFields: =["DisplayName","Email","Picture"]
                                DisplayMode: |
                                    =DisplayMode.Edit
                                Fill: =RGBA(217, 217, 214, 1)
                                Font: =Font.Arial
                                Height: =Parent.Height*0.8
                                HoverColor: =RGBA(255, 255, 255, 1)
                                HoverFill: =RGBA(136, 139, 141, 1)
                                InputTextPlaceholder: ="Responsável de Fabricação ou CHUET"
                                Items: =Choices([@FOPs_SommaireContents].Aprovador)
                                NoSelectionText: ="Responsável de Fabricação ou CHUET"
                                OnChange: |-
                                    =If(Self.Selected.Email=User().Email,
                                    
                                        Notify("Você não pode ser o PREPARADOR e RESP. FABRICAÇÃO da FOP ao mesmo tempo.", NotificationType.Warning);
                                        Reset(Self),
                                    
                                    IsBlank(Self.Selected.Email),
                                        true,
                                        
                                    Self.Selected.Email=MNF_cbxAprovador_T.Selected.Email,
                                        Notify("O APROVADOR e RESP. FABRICAÇÃO da FOP não podem ser o mesmo.", NotificationType.Warning);
                                        Reset(Self)
                                    )
                                PressedColor: =RGBA(0, 0, 0, 1)
                                PressedFill: =RGBA(136, 139, 141, 1)
                                SearchFields: =["Email"]
                                SearchItems: =Choices(FOPs_SommaireContents.Aprovador,MNF_cbxFabricacao_T.SearchText)
                                SelectionColor: =RGBA(0, 0, 0, 1)
                                SelectionFill: =RGBA(239, 223, 0, 1)
                                SelectMultiple: =false
                                Size: =12
                                Template: =ListItemTemplate.Person
                                Width: =Parent.Width - Self.X - 15
                                X: =MNF_lblFabricacao_T.Width
                                Y: =Parent.Height/2 - Self.Height/2
                                ZIndex: =1

                            MNF_lblFabricacao_T As label:
                                Align: =Align.Right
                                Color: =RGBA(0, 0, 0, 1)
                                DisabledColor: =RGBA(0, 0, 0, 1)
                                Font: =Font.Arial
                                Height: =Parent.Height
                                Size: =12
                                Text: |-
                                    ="Fabricação:"
                                Width: =100
                                Wrap: =false
                                ZIndex: =2

                        MNF_crdNFOP_T As typedDataCard.textualEditCard:
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="N_FOP"
                            Default: =ThisItem.N_FOP
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: =DataSourceInfo([@FOPs_MPR_EmValidacao],DataSourceInfo.DisplayName,N_FOP)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =Parent.Height*0.11
                            MaxLength: =DataSourceInfo([@FOPs_MPR_EmValidacao], DataSourceInfo.MaxLength, N_FOP)
                            Required: =false
                            Update: =MNF_inpNFOP_T.Text
                            Width: =Parent.Width
                            X: =0
                            Y: =4
                            ZIndex: =3

                            MNF_lblNFOP_T As label:
                                Align: =Align.Right
                                Color: =RGBA(0, 0, 0, 1)
                                DisabledColor: =RGBA(0, 0, 0, 1)
                                Font: =Font.Arial
                                Height: =MNF_lblIndice_T.Height
                                Size: =12
                                Text: |-
                                    ="Nº FOP:"
                                Width: |
                                    =80
                                Wrap: =false
                                ZIndex: =2

                            MNF_inpNFOP_T As text:
                                BorderColor: =If(IsBlank(FOPF_ProcessoCard_1.Error), FOPF_ProcessoCard_1.BorderColor, Color.Red)
                                BorderThickness: =1
                                Clear: =true
                                Default: =FOPF_ProcessoCard_1.Default
                                DelayOutput: =true
                                DisabledBorderColor: =RGBA(136, 139, 141, 1)
                                DisabledColor: =RGBA(62, 63, 64, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                DisplayMode: =Parent.DisplayMode
                                Fill: =RGBA(0, 0, 0, 0)
                                Font: =Font.Arial
                                FontWeight: =FontWeight.Bold
                                Height: =MNF_inpIndice_T.Height
                                HoverBorderColor: =RGBA(136, 139, 141, 1)
                                HoverFill: =RGBA(187, 188, 188, 1)
                                PaddingLeft: =5
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =12
                                Tooltip: =FOPF_ProcessoCard_1.DisplayName
                                Width: =MNF_inpIndice_T.Width
                                X: =MNF_lblNFOP_T.Width
                                Y: =MNF_inpIndice_T.Y
                                ZIndex: =3

                        MNF_crdMotivoModificacao_T As typedDataCard.textualEditCard:
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="Motivo_Modificacao"
                            Default: =ThisItem.Motivo_Modificacao
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: =DataSourceInfo([@FOPs_MPR_EmValidacao],DataSourceInfo.DisplayName,Motivo_Modificacao)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =Parent.Height*0.24
                            MaxLength: =DataSourceInfo([@FOPs_MPR_EmValidacao], DataSourceInfo.MaxLength, Motivo_Modificacao)
                            Required: =false
                            Update: =MNF_inpMotivoModificacao_T.Text
                            Width: =Parent.Width/2
                            X: =0
                            Y: =5
                            ZIndex: =3

                            MNF_lblMotivoModificacao_T As label:
                                Align: =Align.Center
                                Color: =RGBA(0, 0, 0, 1)
                                DisabledColor: =RGBA(0, 0, 0, 1)
                                Font: =Font.Arial
                                Height: =30
                                Size: =12
                                Text: |-
                                    ="Motivo da modificação:"
                                Width: =Parent.Width
                                Wrap: =false
                                ZIndex: =1

                            MNF_inpMotivoModificacao_T As text:
                                BorderColor: =If(IsBlank(FOPF_ProcessoCard_1.Error), FOPF_ProcessoCard_1.BorderColor, Color.Red)
                                BorderThickness: =1
                                Clear: =true
                                Default: =FOPF_ProcessoCard_1.Default
                                DelayOutput: =true
                                DisabledBorderColor: =RGBA(136, 139, 141, 1)
                                DisabledColor: =RGBA(62, 63, 64, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                DisplayMode: =Parent.DisplayMode
                                Fill: =RGBA(0, 0, 0, 0)
                                Font: =Font.Arial
                                FontWeight: =FontWeight.Bold
                                Height: =Parent.Height * 0.9 - MNF_lblMotivoModificacao_T.Height
                                HoverBorderColor: =RGBA(136, 139, 141, 1)
                                HoverFill: =RGBA(187, 188, 188, 1)
                                Mode: =TextMode.MultiLine
                                PaddingLeft: =5
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =12
                                Tooltip: =FOPF_ProcessoCard_1.DisplayName
                                Width: =Parent.Width - 30
                                X: =Parent.Width/2 - Self.Width/2
                                Y: = MNF_lblMotivoModificacao_T.Height //+ (Parent.Height - MNF_lblMotivoModificacao_T.Height)/2 - Self.Height/2
                                ZIndex: =2

                        MNF_crdAnexos_T As typedDataCard.attachmentsEditCard:
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="{Attachments}"
                            Default: =ThisItem.Anexos
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: =DataSourceInfo([@FOPs_MPR_EmValidacao],DataSourceInfo.DisplayName,Anexos)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =Parent.Height*0.21 - 2
                            Required: =false
                            Update: =MNF_attAnexos_T.Attachments
                            Width: =Parent.Width/2
                            X: =0
                            Y: =6
                            ZIndex: =3

                            MNF_attAnexos_T As attachments:
                                BorderColor: =If(IsBlank(FOPF_AnexoCard.Error), FOPF_AnexoCard.BorderColor, Color.Red)
                                BorderThickness: =1
                                DisabledBorderColor: =RGBA(136, 139, 141, 1)
                                DisabledColor: =RGBA(62, 63, 64, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                DisplayMode: =Parent.DisplayMode
                                DropTargetBorderThickness: =1
                                Fill: =RGBA(0, 0, 0, 0)
                                FocusedBorderThickness: =1
                                Font: =Font.Arial
                                Height: =Parent.Height - MNF_lblAnexos_T.Height - 5
                                HoverFill: =RGBA(136, 139, 141, 1)
                                IsInDataCard: =true
                                ItemFill: =RGBA(136, 139, 141, 1)
                                ItemHoverColor: =RGBA(255, 255, 255, 1)
                                ItemHoverFill: =RGBA(62, 63, 64, 1)
                                Items: =FOPF_AnexoCard.Default
                                MaxAttachments: =1
                                MaxAttachmentSize: =100
                                NoAttachmentsText: ="Inserir FOP aqui."
                                PaddingBottom: =5
                                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                                PaddingRight: =5
                                PaddingTop: =5
                                PressedFill: =RGBA(136, 139, 141, 1)
                                Size: =12
                                Tooltip: =FOPF_AnexoCard.DisplayName
                                Width: =Parent.Width - 30
                                X: =Parent.Width/2 - Self.Width/2
                                Y: =MNF_lblAnexos_T.Height
                                ZIndex: =2

                            MNF_lblAnexos_T As label:
                                Align: =Align.Center
                                Color: =RGBA(0, 0, 0, 1)
                                DisabledColor: =RGBA(0, 0, 0, 1)
                                Font: =Font.Arial
                                Height: =25
                                Size: =12
                                Text: ="Anexar arquivos em formato PDF"
                                VerticalAlign: =VerticalAlign.Bottom
                                Width: =Parent.Width
                                Wrap: =false
                                ZIndex: =3

                    MPR_frmTabelaAfetacao_T As form:
                        DataSource: =FOPs_MPR_TabelaAfetacao
                        Height: =Parent.Height*0.21
                        Item: =Defaults(FOPs_MPR_TabelaAfetacao)
                        Visible: |-
                            =Or(
                                MNF_cbxProjeto_T.Selected.Value = "XJD",
                                MNF_cbxProjeto_T.Selected.Value = "XJF",
                                MNF_cbxProjeto_T.Selected.Value = "X1312"
                            )
                        Width: =Parent.Width/2
                        X: =Parent.Width/2
                        Y: =Parent.Height*0.79
                        ZIndex: =2

                        MTA_crdAnexos_T As typedDataCard.attachmentsEditCard:
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="{Attachments}"
                            Default: =ThisItem.Anexos
                            DisplayMode: =Parent.DisplayMode
                            DisplayName: =DataSourceInfo([@FOPs_MPR_TabelaAfetacao],DataSourceInfo.DisplayName,Anexos)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =Parent.Height
                            Required: =false
                            Update: =MTA_attAnexos_T.Attachments
                            Width: =Parent.Width
                            X: =0
                            Y: =0
                            ZIndex: =3

                            MTA_attAnexos_T As attachments:
                                BorderColor: =If(IsBlank(FOPF_AnexoCard.Error), FOPF_AnexoCard.BorderColor, Color.Red)
                                BorderThickness: =1
                                DisabledBorderColor: =RGBA(136, 139, 141, 1)
                                DisabledColor: =RGBA(62, 63, 64, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                DisplayMode: =Parent.DisplayMode
                                DropTargetBorderThickness: =1
                                Fill: =RGBA(0, 0, 0, 0)
                                FocusedBorderThickness: =1
                                Font: =Font.Arial
                                Height: =Parent.Height - Self.Y - 5
                                HoverFill: =RGBA(136, 139, 141, 1)
                                IsInDataCard: =true
                                ItemFill: =RGBA(136, 139, 141, 1)
                                ItemHoverColor: =RGBA(255, 255, 255, 1)
                                ItemHoverFill: =RGBA(62, 63, 64, 1)
                                Items: =FOPF_AnexoCard.Default
                                MaxAttachments: =1
                                MaxAttachmentSize: =100
                                NoAttachmentsText: ="Inserir Tab. Afetação aqui."
                                PaddingBottom: =5
                                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                                PaddingRight: =5
                                PaddingTop: =5
                                PressedFill: =RGBA(136, 139, 141, 1)
                                Size: =12
                                Tooltip: =FOPF_AnexoCard.DisplayName
                                Width: =Parent.Width - 30
                                X: =Parent.Width/2 - Self.Width/2
                                Y: =25
                                ZIndex: =1

                    MNF_conQuestion_T As groupContainer.verticalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        Height: =MNF_crdNFOP_T.Height
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutJustifyContent: =LayoutJustifyContent.End
                        LayoutMode: =LayoutMode.Auto
                        Visible: |-
                            =And(
                                MNF_cbxProjeto_T.Selected.Value <> "XJD",
                                MNF_cbxProjeto_T.Selected.Value <> "XJF",
                                MNF_cbxProjeto_T.Selected.Value <> "X1312",
                                AssinaturaCadastrada
                            )
                        Width: =Parent.Width*2/3
                        X: =Parent.Width/3
                        Y: =Parent.Height*0.44
                        ZIndex: =3

                        MNF_lblQuestion_T As label:
                            Align: =Align.Right
                            Color: =RGBA(0, 0, 0, 1)
                            DisabledColor: =RGBA(0, 0, 0, 1)
                            FillPortions: =1
                            Font: =Font.Arial
                            Height: =29
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            Size: =10
                            Text: |-
                                =If(MNF_radQuestion_T.Selected.Value="Não", "Insira sua assinatura",
                                
                                                                       "Assinar automaticamente?")
                            VerticalAlign: =VerticalAlign.Bottom
                            Width: =200
                            Wrap: =false
                            X: =256
                            Y: =22
                            ZIndex: =1

                        MNF_radQuestion_T As radio:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            Font: =Font.Arial
                            Height: =32
                            HoverColor: =RGBA(0, 0, 0, 1)
                            Items: =["Sim","Não"]
                            Layout: =Layout.Horizontal
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            PaddingBottom: =0
                            PaddingTop: =0
                            RadioBackgroundFill: =RGBA(0, 0, 0, 0)
                            RadioBorderColor: =RGBA(136, 139, 141, 1)
                            RadioSize: =30
                            Reset: =true
                            Size: =10
                            Width: =200
                            X: =200
                            Y: =30
                            ZIndex: =2

                    MNF_conSignature_T As groupContainer.verticalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        Height: =Parent.Height*0.24
                        LayoutAlignItems: =LayoutAlignItems.End
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMode: =LayoutMode.Auto
                        PaddingRight: =30
                        PaddingTop: =30
                        Visible: |-
                            =And(
                                MNF_cbxProjeto_T.Selected.Value <> "XJD",
                                MNF_cbxProjeto_T.Selected.Value <> "XJF",
                                MNF_cbxProjeto_T.Selected.Value <> "X1312"
                            )
                                
                        Width: =Parent.Width/2
                        X: =Parent.Width/2
                        Y: =Parent.Height*0.55
                        ZIndex: =4

                        MPR_btnSign_T As button:
                            BorderColor: =RGBA(239, 223, 0, 1)
                            Color: =RGBA(0, 0, 0, 1)
                            Fill: =RGBA(239, 223, 0, 1)
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Bold
                            Height: =35
                            HoverBorderColor: =RGBA(238, 235, 76, 1)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =RGBA(238, 235, 76, 1)
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            OnSelect: |-
                                =Set(PopUpVisible, true);
                                Set(PopUpSignVisible, true);
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Text: ="Assinar"
                            Visible: =MNF_radQuestion_T.Selected.Value <> "Sim"
                            Width: =120
                            X: =589
                            Y: =586
                            ZIndex: =1

                        MNF_imgUserSignature_T As image:
                            BorderColor: =RGBA(136, 139, 141, 1)
                            BorderThickness: =1
                            DisabledFill: =RGBA(0, 0, 0, 0)
                            Height: =Parent.Height*0.9 - Parent.PaddingTop
                            Image: =LookUp(Assinaturas_Usuarios, Usuario.Email=User().Email, Assinatura)
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            Visible: =MNF_radQuestion_T.Selected.Value="Sim"
                            Width: =Parent.Width*0.75
                            X: =1
                            Y: =391
                            ZIndex: =2

                MPR_conDetailsAproval_T As groupContainer.manualLayoutContainer:
                    DropShadow: =DropShadow.None
                    LayoutMinHeight: =0
                    LayoutMinWidth: =250
                    Visible: |-
                        =And(
                            MPR_galNavigation_T.Selected.Value="APROVAÇÕES",
                            FOP_ApprovalFOPDetailsVisible
                        )
                    ZIndex: =8

                    MPR_frmDetails_T As form:
                        DataSource: =FOPs_MPR_EmValidacao
                        DefaultMode: =FormMode.View
                        Height: =Parent.Height
                        Item: =MPR_galApprovals_T.Selected
                        NumberOfColumns: =2
                        Width: =Parent.Width
                        ZIndex: =1

                        MDA_crdCodigoFOP_T As typedDataCard.textualEditCard:
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="Codigo_FOP"
                            Default: =ThisItem.Codigo_FOP
                            DisplayMode: =DisplayMode.Disabled
                            DisplayName: =DataSourceInfo([@FOPs_MPR_EmValidacao],DataSourceInfo.DisplayName,Codigo_FOP)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =50
                            MaxLength: =DataSourceInfo([@FOPs_MPR_EmValidacao], DataSourceInfo.MaxLength, Codigo_FOP)
                            Required: =false
                            Update: =MDA_inpCodigoFOP_T.Text
                            Width: =Parent.Width/2
                            X: =0
                            Y: =0
                            ZIndex: =2

                            MDA_lblCodigoFOP_T As label:
                                Align: =Align.Right
                                AutoHeight: =true
                                Color: =RGBA(0, 0, 0, 1)
                                DisabledColor: =RGBA(0, 0, 0, 1)
                                DisplayMode: =Parent.DisplayMode
                                Font: =Font.Arial
                                Overflow: =Overflow.Scroll
                                Size: =12
                                Text: |-
                                    ="Codigo FOP:"
                                Width: =120
                                Wrap: =false
                                Y: =Parent.Height/2 - Self.Height/2
                                ZIndex: =1

                            MDA_inpCodigoFOP_T As text:
                                Align: =Align.Center
                                BorderColor: =RGBA(136, 139, 141, 1)
                                BorderThickness: =1
                                Default: =MDA_crdCodigoFOP_T.Default
                                DelayOutput: =true
                                DisabledColor: =RGBA(62, 63, 64, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                DisplayMode: =Parent.DisplayMode
                                Fill: =RGBA(0, 0, 0, 0)
                                Font: =Font.Arial
                                FontWeight: =FontWeight.Bold
                                Height: =Parent.Height*0.8
                                HoverBorderColor: =RGBA(136, 139, 141, 1)
                                HoverFill: =RGBA(187, 188, 188, 1)
                                MaxLength: =500
                                PaddingLeft: =5
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =12
                                Tooltip: ="Identificador unico de FOP"
                                Width: =Parent.Width - Self.X - 1
                                X: =MDA_lblCodigoFOP_T.Width
                                Y: =Parent.Height/2 - Self.Height/2
                                ZIndex: =2

                        MDA_crdIndice_T As typedDataCard.numberEditCard:
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="Indice_FOP"
                            Default: =Text(ThisItem.Indice_FOP)
                            DisplayMode: =DisplayMode.Disabled
                            DisplayName: =DataSourceInfo([@FOPs_MPR_EmValidacao],DataSourceInfo.DisplayName,Indice_FOP)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =50
                            Required: =false
                            Update: =Value(MDA_inpIndice_T.Text)
                            Width: =Parent.Width/2
                            X: =1
                            Y: =0
                            ZIndex: =2

                            MDA_lblIndice_T As label:
                                Align: =Align.Right
                                AutoHeight: =true
                                Color: =RGBA(0, 0, 0, 1)
                                DisabledColor: =RGBA(0, 0, 0, 1)
                                DisplayMode: =Parent.DisplayMode
                                Font: =Font.Arial
                                Size: =12
                                Text: |-
                                    ="Indice: "
                                Width: =120
                                Wrap: =false
                                Y: =Parent.Height/2 - Self.Height/2
                                ZIndex: =1

                            MDA_inpIndice_T As text:
                                Align: =Align.Center
                                BorderColor: =RGBA(136, 139, 141, 1)
                                BorderThickness: =1
                                Default: =MDA_crdIndice_T.Default
                                DelayOutput: =true
                                DisabledColor: =RGBA(62, 63, 64, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                DisplayMode: =Parent.DisplayMode
                                Fill: =RGBA(0, 0, 0, 0)
                                Font: =Font.Arial
                                FontWeight: =FontWeight.Bold
                                Height: =Parent.Height*0.8
                                HoverBorderColor: =RGBA(136, 139, 141, 1)
                                HoverFill: =RGBA(187, 188, 188, 1)
                                MaxLength: =500
                                PaddingLeft: =5
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =12
                                Tooltip: ="Identificador unico de FOP"
                                Width: =Parent.Width - Self.X - 150
                                X: =MDA_lblIndice_T.Width
                                Y: =Parent.Height/2 - Self.Height/2
                                ZIndex: =2

                        MDA_crdPreparador_T As typedDataCard.comboBoxEditCard:
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="Preparador"
                            Default: =ThisItem.Preparador
                            DisplayMode: |-
                                =If(User().Email = MPR_galApprovals_T.Selected.Preparador.Email,
                                    
                                    Parent.DisplayMode,
                                    DisplayMode.Disabled
                                )
                            DisplayName: =DataSourceInfo([@FOPs_MPR_EmValidacao],DataSourceInfo.DisplayName,Preparador)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =Parent.Height/2 - 25
                            Required: =false
                            Update: =MDA_cbxPreparador_T.Selected
                            Width: =Parent.Width/2
                            X: =0
                            Y: =1
                            ZIndex: =2

                            MDA_lblPreparador_T As label:
                                Align: =Align.Right
                                Color: =RGBA(0, 0, 0, 1)
                                DisabledColor: =RGBA(0, 0, 0, 1)
                                Font: =Font.Arial
                                Height: =50
                                Size: =12
                                Text: |-
                                    ="Preparador:"
                                Width: |
                                    =120
                                Wrap: =false
                                ZIndex: =1

                            MDA_cbxPreparador_T As combobox:
                                BorderColor: =RGBA(136, 139, 141, 1)
                                BorderThickness: =1
                                ChevronBackground: =RGBA(239, 223, 0, 1)
                                ChevronDisabledBackground: =RGBA(0, 0, 0, 0)
                                ChevronDisabledFill: =RGBA(62, 63, 64, 1)
                                ChevronFill: =RGBA(0, 0, 0, 1)
                                ChevronHoverBackground: =ColorFade(RGBA(136, 139, 141, 1), -20%)
                                Default: =Blank()
                                DefaultSelectedItems: =MDA_crdPreparador_T.Default
                                DisabledBorderColor: =RGBA(136, 139, 141, 1)
                                DisabledColor: =RGBA(62, 63, 64, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                DisplayFields: =["DisplayName","Email","Picture"]
                                DisplayMode: |-
                                    =If(IsBlank(ThisItem.AssPreparador),  
                                        
                                        If(Parent.DisplayMode = DisplayMode.View,
                                    
                                            DisplayMode.Disabled,
                                            DisplayMode.Edit
                                        ),
                                        
                                        DisplayMode.Disabled
                                    )
                                Fill: =RGBA(217, 217, 214, 1)
                                Font: =Font.Arial
                                HoverColor: =RGBA(255, 255, 255, 1)
                                HoverFill: =RGBA(136, 139, 141, 1)
                                InputTextPlaceholder: =
                                Items: =Choices([@FOPs_MPR_EmValidacao].Preparador)
                                NoSelectionText: =
                                OnChange: |-
                                    =If(Self.Selected.Email=MDA_cbxFabricacao_T.Selected.Email,
                                        Notify("O PREPARADOR e RESP. FABRICAÇÃO da FOP não podem ser o mesmo.", NotificationType.Warning);
                                        Reset(Self)
                                    )
                                PressedColor: =RGBA(0, 0, 0, 1)
                                PressedFill: =RGBA(136, 139, 141, 1)
                                SearchFields: =["Email"]
                                SearchItems: =Choices(FOPs_MPR_EmValidacao.Preparador,MDA_cbxPreparador_T.SearchText)
                                SelectionColor: =RGBA(0, 0, 0, 1)
                                SelectionFill: =RGBA(239, 223, 0, 1)
                                SelectMultiple: =false
                                Size: =12
                                Template: =ListItemTemplate.Person
                                Width: =Parent.Width - Self.X - 1
                                X: =MDA_lblPreparador_T.Width
                                Y: =MDA_lblPreparador_T.Height/2 - Self.Height/2
                                ZIndex: =2

                            MDA_imgAssPreparador_T As image:
                                BorderColor: =RGBA(136, 139, 141, 1)
                                BorderThickness: =1
                                DisabledBorderColor: =RGBA(136, 139, 141, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                Height: =Parent.Height - Self.Y - 20
                                HoverBorderColor: =Self.BorderColor
                                Image: =ThisItem.AssPreparador
                                PressedBorderColor: =Self.BorderColor
                                Visible: =!IsBlank(ThisItem.AssPreparador)
                                Width: =Parent.Width - Self.X - 1
                                X: =15
                                Y: =MDA_lblPreparador_T.Height
                                ZIndex: =3

                            MDA_inpDataAssPreparador_T As text:
                                BorderColor: =If(IsBlank(FDP_AprovadorCard_1.Error), FDP_AprovadorCard_1.BorderColor, Color.Red)
                                BorderThickness: =1
                                Default: |-
                                    ="Assinado: " & Text(ThisItem.Data_AssPreparador)
                                DelayOutput: =true
                                DisabledBorderColor: =RGBA(136, 139, 141, 1)
                                DisabledColor: =RGBA(62, 63, 64, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                DisplayMode: =DisplayMode.Disabled
                                Fill: =RGBA(0, 0, 0, 0)
                                Font: =Font.Arial
                                FontWeight: =FontWeight.Bold
                                Height: =30
                                HoverBorderColor: =RGBA(136, 139, 141, 1)
                                HoverFill: =RGBA(187, 188, 188, 1)
                                MaxLength: =100
                                PaddingLeft: =5
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =12
                                Tooltip: =FDP_AprovadorCard_1.DisplayName
                                Visible: =!IsBlank(ThisItem.AssPreparador)
                                Width: =MDA_imgAssPreparador_T.Width
                                X: =MDA_imgAssPreparador_T.X
                                Y: =MDA_imgAssPreparador_T.Y + MDA_imgAssPreparador_T.Height - Self.Height
                                ZIndex: =4

                            MDA_btnSignPreparador_T As button:
                                BorderColor: =RGBA(239, 223, 0, 1)
                                Color: =RGBA(0, 0, 0, 1)
                                Fill: =RGBA(239, 223, 0, 1)
                                Font: =Font.Arial
                                FontWeight: =FontWeight.Bold
                                Height: =35
                                HoverBorderColor: =RGBA(238, 235, 76, 1)
                                HoverColor: =RGBA(0, 0, 0, 1)
                                HoverFill: =RGBA(238, 235, 76, 1)
                                OnSelect: |-
                                    =Set(PopUpVisible, true);
                                    Set(PopUpSignVisible, true);
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Text: ="Assinar"
                                Visible: |-
                                    =And(
                                        Parent.DisplayMode = DisplayMode.Edit,
                                        IsBlank(ThisItem.AssPreparador),
                                    
                                        If(AssinaturaCadastrada,
                                            MQP_radQuestion_T.Selected.Value = "Não",
                                            MQP_radQuestion_T.Selected.Value <> "Sim"
                                        )
                                    )
                                Width: =120
                                X: =Parent.Width - Self.Width - 1
                                Y: =MDA_lblPreparador_T.Height
                                ZIndex: =5

                            MDA_conQuestionPreparador_T As groupContainer.verticalAutoLayoutContainer:
                                DropShadow: =DropShadow.None
                                Height: =40
                                LayoutAlignItems: =LayoutAlignItems.Center
                                LayoutJustifyContent: =LayoutJustifyContent.End
                                LayoutMode: =LayoutMode.Auto
                                Visible: |-
                                    =And(
                                        Parent.DisplayMode = DisplayMode.Edit,
                                        IsBlank(ThisItem.AssPreparador),
                                        AssinaturaCadastrada
                                    )
                                Width: =Parent.Width - MDA_btnSignPreparador_T.Width - 10
                                Y: =MDA_lblPreparador_T.Height
                                ZIndex: =6

                                MQP_lblQuestion_T As label:
                                    Align: =Align.Right
                                    AlignInContainer: =AlignInContainer.Stretch
                                    Color: =RGBA(0, 0, 0, 1)
                                    DisabledColor: =RGBA(0, 0, 0, 1)
                                    FillPortions: =1
                                    Font: =Font.Arial
                                    Height: =29
                                    LayoutMinHeight: =0
                                    LayoutMinWidth: =0
                                    Size: =9
                                    Text: ="Assinatura automatica?"
                                    Width: =200
                                    X: =256
                                    Y: =22
                                    ZIndex: =1

                                MQP_radQuestion_T As radio:
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    Font: =Font.Arial
                                    Height: =32
                                    HoverColor: =RGBA(0, 0, 0, 1)
                                    Items: =["Sim","Não"]
                                    Layout: =Layout.Horizontal
                                    LayoutMinHeight: =0
                                    LayoutMinWidth: =0
                                    PaddingBottom: =0
                                    PaddingTop: =0
                                    RadioBackgroundFill: =RGBA(0, 0, 0, 0)
                                    RadioBorderColor: =RGBA(136, 139, 141, 1)
                                    RadioSize: =30
                                    Reset: =true
                                    Size: =10
                                    Width: =170
                                    X: =200
                                    Y: =30
                                    ZIndex: =2

                            MDA_imgUserAssPreparador_T As image:
                                BorderColor: =RGBA(136, 139, 141, 1)
                                BorderThickness: =1
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                DisplayMode: =Parent.DisplayMode
                                Height: =Parent.Height - Self.Y - 20
                                Image: =UserAssinatura
                                Visible: |-
                                    =And(
                                        MQP_radQuestion_T.Selected.Value="Sim",
                                        IsBlank(ThisItem.AssPreparador)
                                    )
                                Width: =Parent.Width - Self.X - 1
                                X: =15
                                Y: =MDA_lblPreparador_T.Height + 40
                                ZIndex: =7

                        MDA_crdAprovador_T As typedDataCard.comboBoxEditCard:
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="Aprovador"
                            Default: =ThisItem.Aprovador
                            DisplayMode: |-
                                =If(
                                    Or(
                                        User().Email = MPR_galApprovals_T.Selected.Aprovador.Email,
                                        User().Email = MPR_galApprovals_T.Selected.Preparador.Email
                                    ),
                                    
                                    Parent.DisplayMode,
                                    DisplayMode.Disabled
                                )
                            DisplayName: =DataSourceInfo([@FOPs_MPR_EmValidacao],DataSourceInfo.DisplayName,Aprovador)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =Parent.Height/2 - 25
                            Required: =false
                            Update: =MDA_cbxAprovador_T.Selected
                            Width: =Parent.Width/2
                            X: =1
                            Y: =1
                            ZIndex: =2

                            MDA_lblAprovador_T As label:
                                Align: =Align.Right
                                Color: =RGBA(0, 0, 0, 1)
                                DisabledColor: =RGBA(0, 0, 0, 1)
                                Font: =Font.Arial
                                Height: =50
                                Size: =12
                                Text: |-
                                    ="Aprovador:"
                                Width: |
                                    =120
                                Wrap: =false
                                ZIndex: =1

                            MDA_cbxAprovador_T As combobox:
                                BorderColor: =RGBA(136, 139, 141, 1)
                                BorderThickness: =1
                                ChevronBackground: =RGBA(239, 223, 0, 1)
                                ChevronDisabledBackground: =RGBA(0, 0, 0, 0)
                                ChevronDisabledFill: =RGBA(62, 63, 64, 1)
                                ChevronFill: =RGBA(0, 0, 0, 1)
                                ChevronHoverBackground: =ColorFade(RGBA(136, 139, 141, 1), -20%)
                                Default: =Blank()
                                DefaultSelectedItems: =MDA_crdAprovador_T.Default
                                DisabledBorderColor: =RGBA(136, 139, 141, 1)
                                DisabledColor: =RGBA(62, 63, 64, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                DisplayFields: =["DisplayName","Email","Picture"]
                                DisplayMode: |-
                                    =If(IsBlank(ThisItem.AssAprovador),  
                                        If(Parent.DisplayMode = DisplayMode.View,
                                    
                                            DisplayMode.Disabled,
                                            DisplayMode.Edit
                                        ),
                                        DisplayMode.Disabled
                                    )
                                Fill: =RGBA(217, 217, 214, 1)
                                Font: =Font.Arial
                                HoverColor: =RGBA(255, 255, 255, 1)
                                HoverFill: =RGBA(136, 139, 141, 1)
                                InputTextPlaceholder: =
                                Items: =Choices([@FOPs_MPR_EmValidacao].Aprovador)
                                NoSelectionText: =
                                OnChange: |-
                                    =If(Self.Selected.Email=MDA_cbxFabricacao_T.Selected.Email,
                                        Notify("O APROVADOR e RESP. FABRICAÇÃO da FOP não podem ser o mesmo.", NotificationType.Warning);
                                        Reset(Self)
                                    )
                                PressedColor: =RGBA(0, 0, 0, 1)
                                PressedFill: =RGBA(136, 139, 141, 1)
                                SearchFields: =["Email"]
                                SearchItems: =Choices(FOPs_MPR_EmValidacao.Aprovador,MDA_cbxAprovador_T.SearchText)
                                SelectionColor: =RGBA(0, 0, 0, 1)
                                SelectionFill: =RGBA(239, 223, 0, 1)
                                SelectMultiple: =false
                                Size: =12
                                Template: =ListItemTemplate.Person
                                Width: =Parent.Width - Self.X -15
                                X: =MDA_lblAprovador_T.Width
                                Y: =MDA_lblAprovador_T.Height/2 - Self.Height/2
                                ZIndex: =2

                            MDA_imgAssAprovador_T As image:
                                BorderColor: =RGBA(136, 139, 141, 1)
                                BorderThickness: =1
                                DisabledBorderColor: =RGBA(136, 139, 141, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                Height: =Parent.Height - Self.Y - 20
                                HoverBorderColor: =Self.BorderColor
                                Image: =ThisItem.AssAprovador
                                PressedBorderColor: =Self.BorderColor
                                Visible: =!IsBlank(ThisItem.AssAprovador)
                                Width: =Parent.Width - Self.X - 15
                                X: =20
                                Y: =MDA_lblPreparador_T.Height
                                ZIndex: =3

                            MDA_inpDataAssAprovador_T As text:
                                BorderColor: =If(IsBlank(FDP_AprovadorCard_1.Error), FDP_AprovadorCard_1.BorderColor, Color.Red)
                                BorderThickness: =1
                                Default: |-
                                    ="Assinado: " & Text(ThisItem.Data_AssAprovador)
                                DelayOutput: =true
                                DisabledBorderColor: =RGBA(136, 139, 141, 1)
                                DisabledColor: =RGBA(62, 63, 64, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                DisplayMode: =DisplayMode.Disabled
                                Fill: =RGBA(0, 0, 0, 0)
                                Font: =Font.Arial
                                FontWeight: =FontWeight.Bold
                                Height: =30
                                HoverBorderColor: =RGBA(136, 139, 141, 1)
                                HoverFill: =RGBA(187, 188, 188, 1)
                                MaxLength: =100
                                PaddingLeft: =5
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =12
                                Tooltip: =FDP_AprovadorCard_1.DisplayName
                                Visible: =!IsBlank(ThisItem.AssAprovador)
                                Width: =MDA_imgAssAprovador_T.Width
                                X: =MDA_imgAssAprovador_T.X
                                Y: =MDA_imgAssAprovador_T.Y + MDA_imgAssAprovador_T.Height - Self.Height
                                ZIndex: =4

                            MDA_btnSignAprovador_T As button:
                                BorderColor: =RGBA(239, 223, 0, 1)
                                Color: =RGBA(0, 0, 0, 1)
                                DisplayMode: |-
                                    =If(MDA_cbxAprovador_T.Selected.Email=MPR_galApprovals_T.Selected.Aprovador.Email,
                                        
                                        DisplayMode.Edit,
                                        DisplayMode.Disabled
                                    )
                                Fill: =RGBA(239, 223, 0, 1)
                                Font: =Font.Arial
                                FontWeight: =FontWeight.Bold
                                Height: =35
                                HoverBorderColor: =RGBA(238, 235, 76, 1)
                                HoverColor: =RGBA(0, 0, 0, 1)
                                HoverFill: =RGBA(238, 235, 76, 1)
                                OnSelect: |-
                                    =Set(PopUpVisible, true);
                                    Set(PopUpSignVisible, true);
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Text: ="Assinar"
                                Visible: |-
                                    =And(
                                        Parent.DisplayMode = DisplayMode.Edit,
                                        User().Email = MPR_galApprovals_T.Selected.Aprovador.Email,
                                        IsBlank(ThisItem.AssAprovador),
                                        
                                        If(AssinaturaCadastrada,
                                            MQA_radQuestion_T.Selected.Value = "Não",
                                            MQA_radQuestion_T.Selected.Value <> "Sim"
                                        )
                                    )
                                Width: =120
                                X: =Parent.Width - Self.Width - 15
                                Y: =MDA_lblPreparador_T.Height
                                ZIndex: =5

                            MDA_conQuestionAprovador_T As groupContainer.verticalAutoLayoutContainer:
                                DropShadow: =DropShadow.None
                                Height: =40
                                LayoutAlignItems: =LayoutAlignItems.Center
                                LayoutJustifyContent: =LayoutJustifyContent.End
                                LayoutMode: =LayoutMode.Auto
                                Visible: |-
                                    =And(
                                        Parent.DisplayMode = DisplayMode.Edit,
                                        User().Email = MPR_galApprovals_T.Selected.Aprovador.Email,
                                        IsBlank(ThisItem.AssAprovador),
                                        AssinaturaCadastrada,
                                    
                                        !Or(
                                            MPR_galApprovals_T.Selected.Projeto="XJD",
                                            MPR_galApprovals_T.Selected.Projeto="XJF",
                                            MPR_galApprovals_T.Selected.Projeto="X1312"
                                        )
                                    )
                                Width: =Parent.Width - MDA_btnSignAprovador_T.Width - 15
                                X: =1
                                Y: =MDA_lblPreparador_T.Height
                                ZIndex: =6

                                MQA_lblQuestion_T As label:
                                    Align: =Align.Right
                                    AlignInContainer: =AlignInContainer.Stretch
                                    Color: =RGBA(0, 0, 0, 1)
                                    DisabledColor: =RGBA(0, 0, 0, 1)
                                    FillPortions: =1
                                    Font: =Font.Arial
                                    Height: =29
                                    LayoutMinHeight: =0
                                    LayoutMinWidth: =0
                                    Size: =9
                                    Text: ="Assinatura automatica?"
                                    Width: =200
                                    X: =256
                                    Y: =22
                                    ZIndex: =1

                                MQA_radQuestion_T As radio:
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    Font: =Font.Arial
                                    Height: =32
                                    HoverColor: =RGBA(0, 0, 0, 1)
                                    Items: =["Sim","Não"]
                                    Layout: =Layout.Horizontal
                                    LayoutMinHeight: =0
                                    LayoutMinWidth: =0
                                    PaddingBottom: =0
                                    PaddingTop: =0
                                    RadioBackgroundFill: =RGBA(0, 0, 0, 0)
                                    RadioBorderColor: =RGBA(136, 139, 141, 1)
                                    RadioSize: =30
                                    Reset: =true
                                    Size: =10
                                    Width: =170
                                    X: =200
                                    Y: =30
                                    ZIndex: =2

                            MDA_imgUserAssAprovador_T As image:
                                BorderColor: =RGBA(136, 139, 141, 1)
                                BorderThickness: =1
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                DisplayMode: =Parent.DisplayMode
                                Height: =Parent.Height - Self.Y - 20
                                Image: =UserAssinatura
                                Visible: |-
                                    =And(
                                        MQA_radQuestion_T.Selected.Value="Sim",
                                        IsBlank(ThisItem.AssAprovador)
                                    )
                                Width: =Parent.Width - Self.X - 1
                                X: =20
                                Y: =MDA_lblPreparador_T.Height + 40
                                ZIndex: =7

                        MDA_crdFabricacao_T As typedDataCard.comboBoxEditCard:
                            BorderStyle: =BorderStyle.Solid
                            DataField: ="Fabricacao"
                            Default: =ThisItem.Fabricacao
                            DisplayMode: |-
                                =If(
                                    Or(
                                        User().Email = MPR_galApprovals_T.Selected.Fabricacao.Email,
                                        User().Email = MPR_galApprovals_T.Selected.Preparador.Email
                                    ),
                                    
                                    Parent.DisplayMode,
                                    DisplayMode.Disabled
                                )
                            DisplayName: =DataSourceInfo([@FOPs_MPR_EmValidacao],DataSourceInfo.DisplayName,Fabricacao)
                            Fill: =RGBA(0, 0, 0, 0)
                            Height: =Parent.Height/2 - 25
                            Required: =false
                            Update: =MDA_cbxFabricacao_T.Selected
                            Width: =Parent.Width
                            X: =0
                            Y: =2
                            ZIndex: =2

                            MDA_lblFabricacao_T As label:
                                Align: =Align.Right
                                Color: =RGBA(0, 0, 0, 1)
                                DisabledColor: =RGBA(0, 0, 0, 1)
                                Font: =Font.Arial
                                Height: =50
                                Size: =12
                                Text: |-
                                    ="Fabricação:"
                                Width: |
                                    =120
                                Wrap: =false
                                ZIndex: =1

                            MDA_cbxFabricacao_T As combobox:
                                BorderColor: =RGBA(136, 139, 141, 1)
                                BorderThickness: =1
                                ChevronBackground: =RGBA(239, 223, 0, 1)
                                ChevronDisabledBackground: =RGBA(0, 0, 0, 0)
                                ChevronDisabledFill: =RGBA(62, 63, 64, 1)
                                ChevronFill: =RGBA(0, 0, 0, 1)
                                ChevronHoverBackground: =ColorFade(RGBA(136, 139, 141, 1), -20%)
                                Default: =Blank()
                                DefaultSelectedItems: =MDA_crdFabricacao_T.Default
                                DisabledBorderColor: =RGBA(136, 139, 141, 1)
                                DisabledColor: =RGBA(62, 63, 64, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                DisplayFields: =["DisplayName","Email","Picture"]
                                DisplayMode: |-
                                    =If(IsBlank(ThisItem.AssFabricacao),  
                                        
                                        If(Parent.DisplayMode = DisplayMode.View,
                                    
                                            DisplayMode.Disabled,
                                            DisplayMode.Edit
                                        ),
                                        
                                        DisplayMode.Disabled
                                    )
                                Fill: =RGBA(217, 217, 214, 1)
                                Font: =Font.Arial
                                HoverColor: =RGBA(255, 255, 255, 1)
                                HoverFill: =RGBA(136, 139, 141, 1)
                                InputTextPlaceholder: =
                                Items: =Choices([@FOPs_MPR_EmValidacao].Fabricacao)
                                NoSelectionText: =
                                OnChange: |-
                                    =If(Self.Selected.Email=MDA_cbxPreparador_T.Selected.Email,
                                        Notify("O PREPARADOR e RESP. FABRICAÇÃO da FOP não podem ser o mesmo.", NotificationType.Warning);
                                        Reset(Self),
                                    
                                        Self.Selected.Email=MDA_cbxAprovador_T.Selected.Email,
                                        Notify("O APROVADOR e RESP. FABRICAÇÃO da FOP não podem ser o mesmo.", NotificationType.Warning);
                                        Reset(Self)
                                    )
                                PressedColor: =RGBA(0, 0, 0, 1)
                                PressedFill: =RGBA(136, 139, 141, 1)
                                SearchFields: =["Email"]
                                SearchItems: =Choices(FOPs_MPR_EmValidacao.Fabricacao,MDA_cbxFabricacao_T.SearchText)
                                SelectionColor: =RGBA(0, 0, 0, 1)
                                SelectionFill: =RGBA(239, 223, 0, 1)
                                SelectMultiple: =false
                                Size: =12
                                Template: =ListItemTemplate.Person
                                Width: =Parent.Width/2 - Self.X - 1
                                X: =MDA_lblFabricacao_T.Width
                                Y: =MDA_lblFabricacao_T.Height/2 - Self.Height/2
                                ZIndex: =2

                            MDA_imgAssFabricacao_T As image:
                                BorderColor: =RGBA(136, 139, 141, 1)
                                BorderThickness: =1
                                DisabledBorderColor: =RGBA(136, 139, 141, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                Height: =Parent.Height - Self.Y - 20
                                HoverBorderColor: =Self.BorderColor
                                Image: =ThisItem.AssFabricacao
                                PressedBorderColor: =Self.BorderColor
                                Visible: =!IsBlank(ThisItem.AssFabricacao)
                                Width: =MDA_lblFabricacao_T.Width + MDA_cbxFabricacao_T.Width - Self.X
                                X: =15
                                Y: =MDA_lblPreparador_T.Height
                                ZIndex: =3

                            MDA_inpDataAssFabricacao_T As text:
                                BorderColor: =If(IsBlank(FDP_AprovadorCard_1.Error), FDP_AprovadorCard_1.BorderColor, Color.Red)
                                BorderThickness: =1
                                Default: |-
                                    ="Assinado: " & Text(ThisItem.Data_AssFabricacao)
                                DelayOutput: =true
                                DisabledBorderColor: =RGBA(136, 139, 141, 1)
                                DisabledColor: =RGBA(62, 63, 64, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                DisplayMode: =DisplayMode.Disabled
                                Fill: =RGBA(0, 0, 0, 0)
                                Font: =Font.Arial
                                FontWeight: =FontWeight.Bold
                                Height: =30
                                HoverBorderColor: =RGBA(136, 139, 141, 1)
                                HoverFill: =RGBA(187, 188, 188, 1)
                                MaxLength: =100
                                PaddingLeft: =5
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =12
                                Tooltip: =FDP_AprovadorCard_1.DisplayName
                                Visible: =!IsBlank(ThisItem.AssFabricacao)
                                Width: =MDA_imgAssFabricacao_T.Width
                                X: =MDA_imgAssFabricacao_T.X
                                Y: =MDA_imgAssFabricacao_T.Y + MDA_imgAssFabricacao_T.Height - Self.Height
                                ZIndex: =4

                            MDA_lblCodigoFOS_T As label:
                                Align: =Align.Right
                                Color: =RGBA(0, 0, 0, 1)
                                DisabledColor: =RGBA(0, 0, 0, 1)
                                Font: =Font.Arial
                                Height: =50
                                Size: =12
                                Text: |-
                                    ="Codigo FOS:"
                                Width: |
                                    =160
                                Wrap: =false
                                X: =MDA_lblFabricacao_T.Width + MDA_cbxFabricacao_T.Width
                                ZIndex: =5

                            MDA_inpCodigoFOS_T As text:
                                Align: =Align.Center
                                BorderColor: =RGBA(136, 139, 141, 1)
                                BorderThickness: =1
                                Default: =ThisItem.Codigo_FOS
                                DelayOutput: =true
                                DisabledBorderColor: =RGBA(136, 139, 141, 1)
                                DisabledColor: =RGBA(62, 63, 64, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                DisplayMode: |-
                                    =If(IsBlank(ThisItem.AssFabricacao),
                                        If(User().Email=MPR_galApprovals_T.Selected.Fabricacao.Email,      
                                            If(Parent.DisplayMode = DisplayMode.View,
                                                DisplayMode.Disabled,
                                                DisplayMode.Edit
                                            ),
                                            DisplayMode.Disabled
                                        ),
                                        DisplayMode.Disabled
                                    )
                                Fill: =RGBA(0, 0, 0, 0)
                                Font: =Font.Arial
                                FontWeight: =FontWeight.Bold
                                HoverBorderColor: =RGBA(136, 139, 141, 1)
                                HoverFill: =RGBA(187, 188, 188, 1)
                                MaxLength: =100
                                PaddingLeft: =5
                                PaddingRight: =0
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =12
                                Width: =Parent.Width - Self.X -15
                                X: =MDA_lblCodigoFOS_T.X + MDA_lblCodigoFOS_T.Width
                                Y: =MDA_lblCodigoFOS_T.Height/2 - Self.Height/2
                                ZIndex: =6

                            MDA_inpDataMod_T As datepicker:
                                BorderColor: =RGBA(136, 139, 141, 1)
                                BorderThickness: =1
                                DefaultDate: =ThisItem.Data_Mod_FOS
                                DisabledBorderColor: =RGBA(136, 139, 141, 1)
                                DisabledColor: =RGBA(62, 63, 64, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                DisplayMode: |-
                                    =If(IsBlank(ThisItem.AssFabricacao),
                                        If(User().Email=MPR_galApprovals_T.Selected.Fabricacao.Email,      
                                            If(Parent.DisplayMode = DisplayMode.View,
                                                DisplayMode.Disabled,
                                                DisplayMode.Edit
                                            ),
                                            DisplayMode.Disabled
                                        ),
                                        DisplayMode.Disabled
                                    )
                                Fill: =RGBA(0, 0, 0, 0)
                                IconBackground: =RGBA(239, 223, 0, 1)
                                IconFill: =RGBA(0, 0, 0, 1)
                                InputTextPlaceholder: ="Data Prevista de Modificação de FOS" 
                                IsEditable: =true
                                Reset: =true
                                Size: =12
                                Width: =Parent.Width - Self.X - 15
                                X: =MDA_lblCodigoFOS_T.X + 20
                                Y: =MDA_lblCodigoFOS_T.Height
                                ZIndex: =7

                            MDA_inpComentarioFab_T As text:
                                Align: =Align.Justify
                                BorderColor: =RGBA(136, 139, 141, 1)
                                BorderThickness: =1
                                Default: =
                                DelayOutput: =true
                                DisabledBorderColor: =RGBA(136, 139, 141, 1)
                                DisabledColor: =RGBA(62, 63, 64, 1)
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                DisplayMode: |-
                                    =If(IsBlank(ThisItem.AssFabricacao),
                                        If(User().Email=MPR_galApprovals_T.Selected.Fabricacao.Email,      
                                            If(Parent.DisplayMode = DisplayMode.View,
                                                DisplayMode.Disabled,
                                                DisplayMode.Edit
                                            ),
                                            DisplayMode.Disabled
                                        ),
                                        DisplayMode.Disabled
                                    )
                                Fill: =RGBA(0, 0, 0, 0)
                                Font: =Font.Arial
                                Height: =Parent.Height - Self.Y - 20
                                HintText: ="Comentário de Responsável de Fabricação"
                                HoverBorderColor: =RGBA(136, 139, 141, 1)
                                HoverFill: =RGBA(187, 188, 188, 1)
                                MaxLength: =100
                                Mode: =TextMode.MultiLine
                                PaddingLeft: =5
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =12
                                Width: =MDA_inpDataMod_T.Width
                                X: =MDA_inpDataMod_T.X
                                Y: =MDA_inpDataMod_T.Y + MDA_inpDataMod_T.Height + 5
                                ZIndex: =8

                            MDA_btnSignFabricacao_T As button:
                                BorderColor: =RGBA(239, 223, 0, 1)
                                Color: =RGBA(0, 0, 0, 1)
                                DisplayMode: |-
                                    =If(MDA_cbxFabricacao_T.Selected.Email=MPR_galApprovals_T.Selected.Fabricacao.Email,
                                        
                                        If(MPR_galApprovals_T.Selected.Posto_Robotizado,
                                            
                                            DisplayMode.Edit,
                                    
                                            If(
                                                Or(
                                                    IsBlank(MDA_inpCodigoFOS_T.Text),
                                                    IsBlank(MDA_inpDataMod_T.SelectedDate)
                                                ),
                                    
                                                DisplayMode.Disabled,
                                                DisplayMode.Edit
                                            )
                                        ),
                                    
                                        DisplayMode.Disabled
                                    )
                                Fill: =RGBA(239, 223, 0, 1)
                                Font: =Font.Arial
                                FontWeight: =FontWeight.Bold
                                Height: =35
                                HoverBorderColor: =RGBA(238, 235, 76, 1)
                                HoverColor: =RGBA(0, 0, 0, 1)
                                HoverFill: =RGBA(238, 235, 76, 1)
                                OnSelect: |-
                                    =Set(PopUpVisible, true);
                                    Set(PopUpSignVisible, true);
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Text: ="Assinar"
                                Visible: |-
                                    =And(
                                        Parent.DisplayMode = DisplayMode.Edit,
                                        User().Email = MPR_galApprovals_T.Selected.Fabricacao.Email,
                                        IsBlank(ThisItem.AssFabricacao),
                                        If(AssinaturaCadastrada,
                                            MQF_radQuestion_T.Selected.Value = "Não",
                                            MQF_radQuestion_T.Selected.Value <> "Sim"
                                        )
                                    )
                                Width: =120
                                X: =MDA_lblFabricacao_T.Width + MDA_cbxFabricacao_T.Width - Self.Width
                                Y: =MDA_lblFabricacao_T.Height
                                ZIndex: =9

                            MDA_conQuestionFabricacao_T As groupContainer.verticalAutoLayoutContainer:
                                DropShadow: =DropShadow.None
                                Height: =40
                                LayoutAlignItems: =LayoutAlignItems.Center
                                LayoutJustifyContent: =LayoutJustifyContent.End
                                LayoutMode: =LayoutMode.Auto
                                Visible: |-
                                    =And(
                                        Parent.DisplayMode = DisplayMode.Edit,
                                        User().Email = MPR_galApprovals_T.Selected.Fabricacao.Email,
                                        IsBlank(ThisItem.AssFabricacao),
                                        AssinaturaCadastrada
                                    )
                                Width: =MDA_lblFabricacao_T.Width + MDA_cbxFabricacao_T.Width - MDA_btnSignFabricacao_T.Width - 10
                                Y: =MDA_lblPreparador_T.Height
                                ZIndex: =10

                                MQF_lblQuestion_T As label:
                                    Align: =Align.Right
                                    Color: =RGBA(0, 0, 0, 1)
                                    DisabledColor: =RGBA(0, 0, 0, 1)
                                    FillPortions: =1
                                    Font: =Font.Arial
                                    Height: =29
                                    LayoutMinHeight: =0
                                    LayoutMinWidth: =0
                                    Size: =9
                                    Text: ="Assinatura automatica?"
                                    Width: =200
                                    X: =256
                                    Y: =22
                                    ZIndex: =1

                                MQF_radQuestion_T As radio:
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    Font: =Font.Arial
                                    Height: =32
                                    HoverColor: =RGBA(0, 0, 0, 1)
                                    Items: =["Sim","Não"]
                                    Layout: =Layout.Horizontal
                                    LayoutMinHeight: =0
                                    LayoutMinWidth: =0
                                    PaddingBottom: =0
                                    PaddingTop: =0
                                    RadioBackgroundFill: =RGBA(0, 0, 0, 0)
                                    RadioBorderColor: =RGBA(136, 139, 141, 1)
                                    RadioSize: =30
                                    Reset: =true
                                    Size: =10
                                    Width: =170
                                    X: =200
                                    Y: =30
                                    ZIndex: =2

                            MDA_imgUserAssFabricacao_T As image:
                                BorderColor: =RGBA(136, 139, 141, 1)
                                BorderThickness: =1
                                DisabledFill: =RGBA(0, 0, 0, 0)
                                DisplayMode: =Parent.DisplayMode
                                Height: =Parent.Height - Self.Y - 20
                                Image: =UserAssinatura
                                Visible: |-
                                    =And(
                                        MQF_radQuestion_T.Selected.Value="Sim",
                                        IsBlank(ThisItem.AssFabricacao)
                                    )
                                Width: =MDA_lblFabricacao_T.Width + MDA_cbxFabricacao_T.Width - Self.X - 1
                                X: =15
                                Y: =MDA_lblPreparador_T.Height + 40
                                ZIndex: =11

                    MDA_imgClose_T As image:
                        AccessibleLabel: ="FECHAR DETALHES"
                        Height: =60
                        Image: |+
                            ="data:image/svg+xml;utf8, "&
                            EncodeUrl(
                            "
                            <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 60 60'><defs><style>.cls-1{fill:#1d1d1b;}</style></defs><g id='Picto'><path class='cls-1' d='M16.79,41.84,28.26,30.37,16.79,18.9l1.44-1.44L29.7,28.93,41.18,17.46l1.44,1.39L31.14,30.37,42.66,41.89l-1.44,1.44L29.7,31.81,18.23,43.28Z'/></g></svg>
                            ")
                            
                        OnSelect: |-
                            =Set(FOP_ApprovalFOPDetailsVisible, false);
                            Clear(HistoricoFOP_MPR);
                            ResetForm(MPR_frmDetails_T);
                        Tooltip: ="FECHAR DETALHES"
                        Width: =60
                        X: =Parent.Width - Self.Width - 10
                        Y: =10 - 15
                        ZIndex: =2

                MPR_conSignature_T As groupContainer.manualLayoutContainer:
                    DropShadow: =DropShadow.None
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Visible: =MPR_galNavigation_T.Selected.Value="ASSINATURA"
                    ZIndex: =9

                    MST_lblInfo_T As label:
                        Align: =Align.Justify
                        DisplayMode: =DisplayMode.View
                        Height: =Parent.Height/2
                        HoverColor: =RGBA(238, 235, 76, 1)
                        HoverFill: =RGBA(238, 235, 76, 1)
                        Overflow: =Overflow.Scroll
                        PaddingRight: =15
                        PressedFill: =RGBA(238, 235, 76, 1)
                        Size: =8
                        Text: |-
                            ="Esta assinatura será armazenada na base de dados do Time Digital PE Carroceria.
                            
                            A assinatura cadastrada é usada para que você possa agilizar o processo de assinatura das FOPs.
                            
                            Caso você desejar, poderá a qualquer momento descadastrar sua assinatura da nossa base de dados.
                            
                            Em caso de duvidas sobre a assinatra digital, pode entrar em contato conosco pela aba SUPORTE.
                            
                            Ao cadastrar sua assinatura, você está de acordo com a LGPD Renault."
                        Width: =Parent.Width/2
                        X: =Parent.Width/2
                        ZIndex: =1

                    MST_lblRegister_T As label:
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Bold
                        PaddingLeft: =20
                        Size: =18
                        Text: =If(IsBlank(MST_imgUserAssinatura_T.Image),"Cadastrar", "Visualizar")
                        Width: =Parent.Width/2
                        ZIndex: =2

                    MST_imgUserAssinatura_T As image:
                        BorderColor: =RGBA(136, 139, 141, 1)
                        BorderThickness: =1
                        Height: =Self.Y - 25
                        Image: =UserAssinatura
                        Visible: |-
                            =!IsBlank(UserAssinatura)
                                    
                        Width: =Self.Height*1.7
                        X: =Parent.Width/2 - Self.Width/2
                        Y: =Parent.Height/2 + 5
                        ZIndex: =3

                    MST_btnDelete_T As button:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        DisplayMode: |-
                            =If(
                                !IsBlank(UserAssinatura),
                                DisplayMode.Edit,
                                DisplayMode.Disabled
                            )
                                    
                        Fill: =RGBA(0, 0, 0, 1)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Bold
                        Height: =35
                        HoverBorderColor: =RGBA(238, 235, 76, 1)
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =RGBA(238, 235, 76, 1)
                        OnSelect: |-
                            =Remove(Assinaturas_Usuarios, LookUp(Assinaturas_Usuarios, Usuario.Email=User().Email));
                            Set(UserAssinatura, Blank());
                            Set(AssinaturaCadastrada, false);
                            
                            Notify("ASSINATURA ELIMINADA COM SUCESSO",NotificationType.Success);
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Text: ="Deletar"
                        Visible: =!FOP_ApprovalFOPDetailsVisible
                        Width: =120
                        X: =Parent.Width/4 + 15
                        Y: =80
                        ZIndex: =4

                    MST_btnRegister_T As button:
                        BorderColor: =RGBA(239, 223, 0, 1)
                        Color: =RGBA(0, 0, 0, 1)
                        DisplayMode: |-
                            =If(
                                IsBlank(UserAssinatura),
                                DisplayMode.Edit,
                                DisplayMode.Disabled
                            )
                                    
                        Fill: =RGBA(239, 223, 0, 1)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Bold
                        Height: =35
                        HoverBorderColor: =RGBA(238, 235, 76, 1)
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =RGBA(238, 235, 76, 1)
                        OnSelect: |
                            =Set(PopUpVisible, true);
                            Set(PopUpSignVisible, true);
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Text: ="Assinar"
                        Width: =120
                        X: =Parent.Width/4  - Self.Width
                        Y: =80
                        ZIndex: =6

                MPR_conBtns_T As groupContainer.horizontalAutoLayoutContainer:
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: =50
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutGap: =15
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =15
                    PaddingRight: =15
                    ZIndex: =10

                    MPR_btnReturn_T As button:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        DisplayMode: |-
                            =DisplayMode.Edit
                                    
                        Fill: =RGBA(0, 0, 0, 1)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Bold
                        Height: =Parent.Height*0.7
                        HoverBorderColor: =RGBA(238, 235, 76, 1)
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =RGBA(238, 235, 76, 1)
                        LayoutMinWidth: =0
                        OnSelect: |-
                            =Set(UsinaGalleryVisible, true);       
                            Set(DiversityGalleryVisible, false);  
                            Set(UETGalleryVisible, false);       
                            Set(PostoGalleryVisible, false);      
                            
                            Set(SelectedUsina,Blank());    
                            Set(SelectedDiversity,Blank());
                            Set(SelectedUET,Blank());      
                            Set(SelectedPosto,Blank());   
                            
                            Set(CodigoFOP,Blank());  
                            
                            Navigate(FOPs_MPR_Main, ScreenTransition.Fade);
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Text: ="Voltar"
                        Visible: =!FOP_ApprovalFOPDetailsVisible
                        Width: =120
                        X: =43
                        Y: =586
                        ZIndex: =1

                    MDA_btnEdit_T As button:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        DisplayMode: |-
                            =If(
                                Or(
                                    IsBlank(MPR_galApprovals_T.Selected.AssPreparador),
                                    IsBlank(MPR_galApprovals_T.Selected.AssAprovador),
                                    IsBlank(MPR_galApprovals_T.Selected.AssFabricacao)
                                ),
                                DisplayMode.Edit,
                                DisplayMode.Disabled
                            )
                                    
                        Fill: =RGBA(0, 0, 0, 1)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Bold
                        Height: =Parent.Height*0.7
                        HoverBorderColor: =RGBA(238, 235, 76, 1)
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =RGBA(238, 235, 76, 1)
                        LayoutMinWidth: =0
                        OnSelect: |-
                            =If(MPR_frmDetails_T.DisplayMode = DisplayMode.View,
                            
                                EditForm(MPR_frmDetails_T),
                            
                                ViewForm(MPR_frmDetails_T);
                                ResetForm(MPR_frmDetails_T)
                            )
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Text: |-
                            =If(MPR_frmDetails_T.DisplayMode = DisplayMode.View,
                                
                                "Editar",
                                "Cancelar"
                            )
                        Visible: =FOP_ApprovalFOPDetailsVisible
                        Width: =120
                        X: =43
                        Y: =586
                        ZIndex: =2

                    Rectangle2_8 As rectangle:
                        AlignInContainer: =AlignInContainer.Stretch
                        Fill: =RGBA(0, 0, 0, 0)
                        FillPortions: =1
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        ZIndex: =3

                    MNF_btnSend_T As button:
                        AlignInContainer: =AlignInContainer.Center
                        BorderColor: =RGBA(239, 223, 0, 1)
                        Color: =RGBA(0, 0, 0, 1)
                        DisplayMode: |-
                            =If(
                                Or(
                                    IsBlank(MNF_cbxUsina_T.Selected.Value),
                                    IsBlank(MNF_cbxUET_T.Selected.Value),
                                    IsBlank(MNF_cbxPosto_T.Selected.Value),
                                    IsBlank(MNF_cbxProjeto_T.Selected.Value),
                                    IsBlank(MNF_inpProcesso_T.Text),
                                    IsBlank(MNF_cbxDiversidade_T.Selected.Value),
                                    IsBlank(MNF_cbxAprovador_T.Selected.Email),
                                    IsBlank(MNF_inpIndice_T.Text),
                                    IsBlank(MNF_cbxFabricacao_T.Selected.Email),
                                    IsBlank(MNF_inpNFOP_T.Text),
                                    IsBlank(MNF_inpMotivoModificacao_T.Text),
                                    IsEmpty(MNF_attAnexos_T.Attachments),
                            
                                    If(
                                        Or(
                                            MNF_cbxProjeto_T.Selected.Value = "XJD",
                                            MNF_cbxProjeto_T.Selected.Value = "XJF",
                                            MNF_cbxProjeto_T.Selected.Value = "X1312"
                                        ),
                                        
                                        IsEmpty(MTA_attAnexos_T.Attachments),
                                        If(
                                            Or(
                                                MNF_radQuestion_T.Selected.Value="Não",
                                                MNF_radQuestion_T.Selected.Value=Blank()
                                            ),
                                            
                                            SignatureImage<>MPS_inpSignature_T.Image,
                                            false
                                        )
                            
                                    )
                                ),
                            
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Fill: =RGBA(239, 223, 0, 1)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Bold
                        Height: =Parent.Height*0.7
                        HoverBorderColor: =RGBA(238, 235, 76, 1)
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =RGBA(238, 235, 76, 1)
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        OnSelect: |
                            =Set(CodigoFOP, MNF_cbxUsina_T.Selected.Value&"-"&
                                            MNF_cbxUET_T.Selected.Value&"-"&
                                            MNF_cbxPosto_T.Selected.Value&"-"&
                                            MNF_cbxDiversidade_T.Selected.Value);
                            
                            Set(PostoRobotizado,    LookUp(Pastas_FOPs_MPR, 
                                                        And(
                                                            Usina=MNF_cbxUsina_T.Selected.Value,
                                                            UET=MNF_cbxUET_T.Selected.Value,
                                                            Posto=MNF_cbxPosto_T.Selected.Value,
                                                            Projeto=MNF_cbxProjeto_T.Selected.Value,
                                                            Diversidade=MNF_cbxDiversidade_T.Selected.Value
                                                        ),
                                                        Robotizado
                                                    )
                            );
                            
                            If(MNF_cbxProjeto_T.Selected.Value="XJD" || MNF_cbxProjeto_T.Selected.Value="XJF" || MNF_cbxProjeto_T.Selected.Value="X1312",
                            
                            
                                Set(SignatureImage, Substitute(JSON(CarimboProAPW.Image, JSONFormat.IncludeBinaryData),"""",""));
                                Set(ArquivoModificado, "FOP + Tab. Afetação"),
                            
                                Set(ArquivoModificado, "FOP"); 
                                Switch(MNF_radQuestion_T.Selected.Value, 
                            
                                    "Sim", Set(SignatureImage, MNF_imgUserSignature_T.Image),
                            
                                    Set(SignatureImage, Substitute(JSON(MPS_inpSignature_T.Image, JSONFormat.IncludeBinaryData),"""",""))
                                )
                            );
                            
                            If(
                                !IsBlank(LookUp(FOPs_MPR_EmValidacao, Codigo_FOP=CodigoFOP)), 
                            
                                    Notify("ESTA FOP JÁ ESTÁ SENDO VALIDADA, ENTRAR EM CONTATO COM " & LookUp(FOPs_MPR_EmValidacao, Codigo_FOP=CodigoFOP, Preparador.DisplayName), NotificationType.Warning),
                            
                                !IsBlank(LookUp(FOPs_MPR_EmUso, Codigo_FOP=CodigoFOP)), 
                            
                                    Notify("JÁ EXISTE UMA FOP CARREGADA NESTE POSTO PARA A DIVERSIDADE INFORMADA.", NotificationType.Warning),
                            
                            
                                Patch(FOPs_MPR_EmValidacao, Defaults(FOPs_MPR_EmValidacao),
                                    MPR_frmNewFOP_T.Updates, 
                                    {Tipo_Navette: "NOUVELLE",
                                    Posto_Robotizado: PostoRobotizado, 
                                    Codigo_FOP: CodigoFOP,
                                    Preparador: {DisplayName: User().FullName,
                                                Claims: "i:0#.f|membership|" & Lower(User().Email),
                                                Department: "",
                                                JobTitle: "",
                                                Picture: User().Image,
                                                Email: User().Email},
                                    AssPreparador: SignatureImage,
                                    Data_AssPreparador: Now()}
                                );
                            
                                If(MNF_cbxProjeto_T.Selected.Value="XJD" || MNF_cbxProjeto_T.Selected.Value="XJF" || MNF_cbxProjeto_T.Selected.Value="X1312",        
                                    
                                    Patch(FOPs_MPR_TabelaAfetacao, Defaults(FOPs_MPR_TabelaAfetacao),
                                        MPR_frmTabelaAfetacao_T.Updates,
                                        {Codigo_FOP: CodigoFOP,
                                        Indice_FOP: Value(MNF_inpIndice_T.Text),
                                        Usina: MNF_cbxUsina_T.Selected.Value,
                                        UET: MNF_cbxUET_T.Selected.Value,
                                        Posto: MNF_cbxPosto_T.Selected.Value,
                                        Projeto: MNF_cbxProjeto_T.Selected.Value,
                                        Diversidade: MNF_cbxDiversidade_T.Selected.Value,
                                        N_FOP: MNF_inpNFOP_T.Text,
                                        Validado: false,
                                        Responsavel: {DisplayName: User().FullName,
                                                    Claims: "i:0#.f|membership|" & Lower(User().Email),
                                                    Department: "",
                                                    JobTitle: "",
                                                    Picture: User().Image,
                                                    Email: User().Email},
                                        Registro: MNF_inpMotivoModificacao_T.Text}
                                    )
                                );
                            
                                If(MNF_cbxAprovador_T.Selected.Email=User().Email,  
                                    
                                    Patch(FOPs_MPR_EmValidacao, LookUp(FOPs_MPR_EmValidacao, Codigo_FOP=CodigoFOP),
                                        {AssAprovador: SignatureImage,
                                        Data_AssAprovador: Now()}
                                    )
                                );
                            
                                Patch(FOPs_MPR_Historicos, 
                                    {Tipo_Registro: "Carregamento: NOUVELLE - " & ArquivoModificado,
                                    Codigo_FOP: CodigoFOP,
                                    Usina: MNF_cbxUsina_T.Selected.Value,
                                    UET: MNF_cbxUET_T.Selected.Value,
                                    Posto: MNF_cbxPosto_T.Selected.Value,
                                    Projeto: MNF_cbxProjeto_T.Selected.Value,
                                    Diversidade: MNF_cbxDiversidade_T.Selected.Value,
                                    N_FOP: MNF_inpNFOP_T.Text,
                                    Indice_FOP: Value(MNF_inpIndice_T.Text),
                                    Responsavel: {DisplayName: User().FullName,
                                                Claims: "i:0#.f|membership|" & Lower(User().Email),
                                                Department: "",
                                                JobTitle: "",
                                                Picture: User().Image,
                                                Email: User().Email}}
                                );
                                
                                Notify("FOP ENVIADA PARA VALIDAÇÃO", NotificationType.Success);
                            
                                ResetForm(MPR_frmNewFOP_T);
                                ResetForm(MPR_frmTabelaAfetacao_T);
                                Reset(MPS_inpSignature_T);
                            
                                Set(CodigoFOP, Blank());
                                Set(PostoRobotizado, false);
                            )
                            
                            
                            
                            
                            
                             
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Text: ="Enviar"
                        Visible: =MPR_galNavigation_T.Selected.Value="NOVA FOP"
                        Width: =120
                        X: =589
                        Y: =586
                        ZIndex: =4

                    MDA_btnReject_T As button:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        DisplayMode: |-
                            =DisplayMode.Edit
                                    
                        Fill: =RGBA(0, 0, 0, 1)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Bold
                        Height: =Parent.Height*0.7
                        HoverBorderColor: =RGBA(238, 235, 76, 1)
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =RGBA(238, 235, 76, 1)
                        LayoutMinWidth: =0
                        OnSelect: |-
                            =Set(PopUpVisible, true);
                            Set(PopUpRejectVisible, true);
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Text: ="Rejeitar"
                        Visible: |-
                            =And(
                                FOP_ApprovalFOPDetailsVisible,
                                MPR_frmDetails_T.DisplayMode = DisplayMode.Edit
                            )
                        Width: =120
                        X: =43
                        Y: =586
                        ZIndex: =5

                    MDA_btnSave_T As button:
                        AlignInContainer: =AlignInContainer.Center
                        BorderColor: =RGBA(239, 223, 0, 1)
                        Color: =RGBA(0, 0, 0, 1)
                        DisplayMode: |-
                            =If(And(
                                    MPR_galApprovals_T.Selected.Preparador.Email=User().Email,
                                    MPR_galApprovals_T.Selected.Aprovador.Email=User().Email
                                ),
                            
                                If(
                                    Or(
                                        MPR_galApprovals_T.Selected.Aprovador.Email<>MDA_cbxAprovador_T.Selected.Email,
                                        MPR_galApprovals_T.Selected.Fabricacao.Email<>MDA_cbxFabricacao_T.Selected.Email
                                    ),
                            
                                    If(
                                        Or(
                                            IsBlank(MDA_cbxPreparador_T.Selected.Email),
                                            IsBlank(MDA_cbxAprovador_T.Selected.Email),
                                            IsBlank(MDA_cbxFabricacao_T.Selected.Email)
                                        ),
                            
                                        DisplayMode.Disabled,
                                        DisplayMode.Edit
                                    ),
                            
                                    If(
                                        Or(
                                            MQA_radQuestion_T.Selected.Value="Sim",
                                            MPR_galApprovals_T.Selected.Projeto="XJD",
                                            MPR_galApprovals_T.Selected.Projeto="XJF",
                                            MPR_galApprovals_T.Selected.Projeto="X1312"
                                        ),
                            
                                        DisplayMode.Edit,
                                        DisplayMode.Disabled
                                    )
                                ),
                                
                                
                            MPR_galApprovals_T.Selected.Preparador.Email=User().Email,
                            
                                If(
                                    Or(
                                        IsBlank(MDA_cbxPreparador_T.Selected.Email),
                                        IsBlank(MDA_cbxAprovador_T.Selected.Email),
                                        IsBlank(MDA_cbxFabricacao_T.Selected.Email)
                                    ),
                            
                                    DisplayMode.Disabled,
                                    DisplayMode.Edit
                                ),
                             
                            
                            MPR_galApprovals_T.Selected.Aprovador.Email=User().Email,
                            
                                If(MPR_galApprovals_T.Selected.Aprovador.Email<>MDA_cbxAprovador_T.Selected.Email,
                                    If(
                                        IsBlank(MDA_cbxAprovador_T.Selected.Email),
                            
                                        DisplayMode.Disabled,
                                        DisplayMode.Edit
                                    ),
                                
                                    If(
                                        Or(
                                            MQA_radQuestion_T.Selected.Value="Sim",
                                            MPR_galApprovals_T.Selected.Projeto="XJD",
                                            MPR_galApprovals_T.Selected.Projeto="XJF",
                                            MPR_galApprovals_T.Selected.Projeto="X1312"
                                        ),
                            
                                        DisplayMode.Edit,
                                        DisplayMode.Disabled
                                    )
                                ),
                            
                            MPR_galApprovals_T.Selected.Fabricacao.Email=User().Email,
                                
                                If(MPR_galApprovals_T.Selected.Fabricacao.Email<>MDA_cbxFabricacao_T.Selected.Email,
                                    If(
                                        IsBlank(MDA_cbxFabricacao_T.Selected.Email),
                            
                                        DisplayMode.Disabled,
                                        DisplayMode.Edit
                                    ),
                                
                                    If(MPR_galApprovals_T.Selected.Posto_Robotizado,
                            
                                        If(MQF_radQuestion_T.Selected.Value="Sim",
                                            DisplayMode.Edit,
                                            DisplayMode.Disabled
                                        ),
                            
                                        If(    
                                            And(
                                                MQF_radQuestion_T.Selected.Value="Sim",
                                                !IsBlank(MDA_inpCodigoFOS_T.Text),
                                                !IsBlank(MDA_inpDataMod_T.SelectedDate)   
                                            ),
                            
                                            DisplayMode.Edit,
                                            DisplayMode.Disabled
                                        )  
                                    )
                                )    
                            )
                        Fill: =RGBA(239, 223, 0, 1)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Bold
                        Height: =Parent.Height*0.7
                        HoverBorderColor: =RGBA(238, 235, 76, 1)
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =RGBA(238, 235, 76, 1)
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        OnSelect: |-
                            =Set(ProAPWFOP,  Or(
                                                MPR_galApprovals_T.Selected.Projeto="XJD", 
                                                MPR_galApprovals_T.Selected.Projeto="XJF",
                                                MPR_galApprovals_T.Selected.Projeto="X1312"
                                            )
                            );
                            
                            If(
                                And(
                                    ProAPWFOP,
                                    MPR_galApprovals_T.Selected.Fabricacao.Email<>User().Email
                                ),
                                Set(SignatureImage, Substitute(JSON(CarimboProAPW.Image, JSONFormat.IncludeBinaryData),"""",""));
                                Set(RegistroHistorico, "FOP ProAPW. Não requer assinatura."),
                            
                                Or(
                                    MQA_radQuestion_T.Selected.Value="Sim",
                                    MQF_radQuestion_T.Selected.Value="Sim"
                                ),
                                Set(SignatureImage, UserAssinatura);
                                Set(RegistroHistorico, "FOP assinada digitalmente pelo aplicativo"),
                            
                                Set(SignatureImage, Substitute(JSON(MPS_inpSignature_T.Image, JSONFormat.IncludeBinaryData),"""",""));
                                Set(RegistroHistorico, "FOP assinada digitalmente pelo aplicativo")
                            );
                            
                            If(
                                And(
                                    MDA_btnShowTable_T.Visible,
                                    MDA_btnShowFOP_T.Visible
                                ),
                                    Set(ArquivoModificado, "FOP + Tab. Afetação"),
                            
                                MDA_btnShowTable_T.Visible,
                                    Set(ArquivoModificado, "Tab. Afetação"),
                            
                                MDA_btnShowFOP_T.Visible,
                                    Set(ArquivoModificado, "FOP")
                            );
                            
                            
                            If(
                                And(
                                    MPR_galApprovals_T.Selected.Preparador.Email=User().Email,
                                    MPR_galApprovals_T.Selected.Aprovador.Email=User().Email
                                ),
                            
                                If(MDA_cbxAprovador_T.Selected.Email<>MPR_galApprovals_T.Selected.Aprovador.Email,
                            
                                    Set(TipoHistorico, "Notificação: Troca de Aprovador");
                                    Set(RegistroHistorico, "Antigo Aprovador: " & MPR_galApprovals_T.Selected.Aprovador.DisplayName);
                                    Patch(FOPs_MPR_EmValidacao, MPR_galApprovals_T.Selected, MPR_frmDetails_T.Updates);
                                    Notify("SUCESSO NA TROCA DE APROVADOR", NotificationType.Success), 
                            
                                MDA_cbxFabricacao_T.Selected.Email<>MPR_galApprovals_T.Selected.Fabricacao.Email,
                            
                                    Set(TipoHistorico, "Notificação: Troca de Resp. Fabricação");
                                    Set(RegistroHistorico, "Antigo Resp. Fabricação: " & MPR_galApprovals_T.Selected.Fabricacao.DisplayName);
                                    Patch(FOPs_MPR_EmValidacao, MPR_galApprovals_T.Selected, MPR_frmDetails_T.Updates);
                                    Notify("SUCESSO NA TROCA DE RESP. FABRICAÇÃO", NotificationType.Success),
                            
                                    If(IsBlank(MPR_galApprovals_T.Selected.AssAprovador),
                            
                                        Patch(FOPs_MPR_EmValidacao, MPR_galApprovals_T.Selected, 
                                            {Data_AssAprovador: Now(),
                                            AssAprovador: SignatureImage}
                                        );
                                        Notify("FOP ASSINADA. Documento enviado para " & MPR_galApprovals_T.Selected.Fabricacao.DisplayName & " para validação.", NotificationType.Success);
                                        Set(TipoHistorico, "Aprovação: Aprovador - " & ArquivoModificado),
                            
                                        Notify("FOP JÁ FOI ASSINADA", NotificationType.Warning)
                                    )
                                ),
                            
                            
                            MPR_galApprovals_T.Selected.Preparador.Email=User().Email,
                            
                                If(MDA_cbxAprovador_T.Selected.Email<>MPR_galApprovals_T.Selected.Aprovador.Email,
                            
                                    Set(TipoHistorico, "Notificação: Troca de Aprovador");
                                    Set(RegistroHistorico, "Antigo Aprovador: " & MPR_galApprovals_T.Selected.Aprovador.DisplayName), 
                            
                                   MDA_cbxFabricacao_T.Selected.Email<>MPR_galApprovals_T.Selected.Fabricacao.Email,
                            
                                    Set(TipoHistorico, "Notificação: Troca de Resp. Fabricação");
                                    Set(RegistroHistorico, "Antigo Resp. Fabricação: " & MPR_galApprovals_T.Selected.Fabricacao.DisplayName); 
                                );
                                Patch(FOPs_MPR_EmValidacao, MPR_galApprovals_T.Selected, MPR_frmDetails_T.Updates);
                                Notify("SUCESSO NA TROCA DE VALIDADOR", NotificationType.Success),
                               
                            
                            MPR_galApprovals_T.Selected.Aprovador.Email=User().Email,
                            
                                If(MDA_cbxAprovador_T.Selected.Email=MPR_galApprovals_T.Selected.Aprovador.Email,
                                        
                                    Patch(FOPs_MPR_EmValidacao, MPR_galApprovals_T.Selected, 
                                        {Data_AssAprovador: Now(),
                                        AssAprovador: SignatureImage}
                                    );
                                    Notify("FOP ASSINADA. Documento enviado para " & MPR_galApprovals_T.Selected.Fabricacao.DisplayName & " para validação.", NotificationType.Success);
                                    Set(TipoHistorico, "Aprovação: Aprovador " & ArquivoModificado),
                            
                            
                                    Patch(FOPs_MPR_EmValidacao, MPR_galApprovals_T.Selected, MPR_frmDetails_T.Updates);
                                    Notify("SUCESSO NA TROCA DE APROVADOR", NotificationType.Success);  
                                    Set(TipoHistorico, "Notificação: Troca de Aprovador");
                                    Set(RegistroHistorico, "Antigo Aprovador: " & MPR_galApprovals_T.Selected.Aprovador.DisplayName)
                                ),
                            
                            MPR_galApprovals_T.Selected.Fabricacao.Email=User().Email,
                                
                                If(MDA_cbxFabricacao_T.Selected.Email=MPR_galApprovals_T.Selected.Fabricacao.Email,
                            
                                    Patch(FOPs_MPR_EmValidacao, MPR_galApprovals_T.Selected, 
                                        {Data_AssFabricacao: Now(),
                                        AssFabricacao: SignatureImage,
                                        Data_Mod_FOS: MDA_inpDataMod_T.SelectedDate,
                                        Codigo_FOS: MDA_inpCodigoFOS_T.Text}
                                    );
                                    Notify(ArquivoModificado & " ASSINADA. O Documento será atualizado nos proximos minutos", NotificationType.Success);
                                    Set(TipoHistorico, "Aprovação: Fabricação - " & ArquivoModificado);
                                    Set(RegistroHistorico,  "FOP assinada digitalmente pelo aplicativo
                                    " & MDA_inpComentarioFab_T.Text),
                            
                            
                                    Patch(FOPs_MPR_EmValidacao, MPR_galApprovals_T.Selected, MPR_frmDetails_T.Updates);
                                    Notify("SUCESSO NA TROCA DE RESPONSÁVEL", NotificationType.Success);
                                    Set(TipoHistorico, "Notificação: Troca de Resp. Fabricação")  
                                )    
                            );
                            
                            Patch(FOPs_MPR_Historicos, Defaults(FOPs_MPR_Historicos), 
                                {Tipo_Registro: TipoHistorico,
                                Codigo_FOP: MPR_galApprovals_T.Selected.Codigo_FOP,
                                Usina: MPR_galApprovals_T.Selected.Usina,
                                UET: MPR_galApprovals_T.Selected.UET,
                                Posto: MPR_galApprovals_T.Selected.Posto,
                                Projeto: MPR_galApprovals_T.Selected.Projeto,
                                Diversidade: MPR_galApprovals_T.Selected.Diversidade,
                                N_FOP: MPR_galApprovals_T.Selected.N_FOP,
                                Indice_FOP: MPR_galApprovals_T.Selected.Indice_FOP,
                                Registro: RegistroHistorico,
                                Responsavel: {DisplayName: User().FullName,
                                                    Claims: "i:0#.f|membership|" & Lower(User().Email),
                                                    Department: "",
                                                    JobTitle: "",
                                                    Picture: User().Image,
                                                    Email: User().Email}}
                            );
                            
                            ViewForm(MPR_frmDetails_T)
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Text: ="Salvar"
                        Visible: |-
                            =And(
                                FOP_ApprovalFOPDetailsVisible,
                                MPR_frmDetails_T.DisplayMode = DisplayMode.Edit
                            )
                        Width: =120
                        X: =589
                        Y: =586
                        ZIndex: =6

                    MPR_imgRefresh_T As image:
                        AccessibleLabel: ="RECARREGAR"
                        Height: =60
                        Image: |+
                            ="data:image/svg+xml;utf8, "&
                            EncodeUrl(
                            "
                            <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 60 60'><defs><style>.cls-1{fill:#1d1d1b;}</style></defs><g id='Picto'><path class='cls-1' d='M44.37,25.53l-1.88.67c-1.72-5.43-6.48-9.12-13-9.12-5.81,0-9.94,2.64-12.29,7.39,1.49-.72,2.64-1.34,4.41-2.16l.72,1.78c-2.49,1.05-3.79,1.68-6.43,2.73l-1.54-.67A44.69,44.69,0,0,1,13.74,19l1.87-.1c0,2,.05,3.12.1,4.42a14.55,14.55,0,0,1,13.78-8.16C36.93,15.21,42.35,19.38,44.37,25.53ZM13.74,36.76l1.87-.67c1.73,5.42,6.48,9.12,13,9.12,5.81,0,9.94-2.64,12.29-7.4-1.49.73-2.64,1.35-4.42,2.16l-.72-1.77c2.5-1.06,3.8-1.68,6.44-2.74l1.53.67a45.1,45.1,0,0,1,.63,7.16l-1.88.09c0-2,0-3.12-.09-4.41a14.55,14.55,0,0,1-13.78,8.16C21.18,47.08,15.76,42.9,13.74,36.76Z'/></g></svg>
                            ")
                            
                        LayoutMinHeight: =0
                        OnSelect: |+
                            =If(MPR_galNavigation_T.Selected.Value="APROVAÇÕES",
                            
                                Refresh(FOPs_MPR_EmValidacao);
                                Refresh(FOPs_MPR_TabelaAfetacao);
                                Clear(HistoricoFOP_MPR);
                                If(FOP_ApprovalFOPDetailsVisible,
                                    Refresh(FOPs_MPR_Historicos);
                                    ClearCollect(HistoricoFOP_MPR, 
                                        ForAll(
                                            Filter(FOPs_MPR_Historicos, Codigo_FOP=MPR_galApprovals_T.Selected.Codigo_FOP),
                                            {Tipo_Registro: Tipo_Registro,
                                            Codigo_FOP: Codigo_FOP,
                                            Indice: Indice_FOP,
                                            Responsavel: Responsavel,
                                            Registro: Registro,
                                            Data: Data,
                                            Anexos: Anexos}
                                        )
                                    );
                                    Set(MPRTabelaAfetacao, LookUp(FOPs_MPR_TabelaAfetacao, Codigo_FOP=MPR_galApprovals_T.Selected.Codigo_FOP && Indice_FOP=MPR_galApprovals_T.Selected.Indice_FOP && Validado=false))
                                ),
                            
                            MPR_galNavigation_T.Selected.Value="CONFIRMAÇÕES",
                                Refresh(FOPs_MPR_EmUso),
                            
                            MPR_galNavigation_T.Selected.Value="HISTÓRICOS",
                                Refresh(Pastas_FOPs_MPR);
                                ClearCollect(ListaPostosMPR,
                                    ForAll(Pastas_FOPs_MPR,
                                        {Usina: Usina,
                                        UET: UET,                      
                                        Posto: Posto,
                                        Diversidade: Diversidade}
                                    )
                                );
                                Clear(HistoricoFOP_MPR);
                                If(!IsBlank(CodigoFOP),
                                    Refresh(FOPs_MPR_Historicos);
                                    ClearCollect(HistoricoFOP_MPR, 
                                        ForAll(
                                            Filter(FOPs_MPR_Historicos, Codigo_FOP=CodigoFOP),
                                            {Tipo_Registro: Tipo_Registro,
                                            Codigo_FOP: Codigo_FOP,
                                            Indice_FOP: Indice_FOP,
                                            Responsavel: Responsavel,
                                            Registro: Registro,
                                            Data: Data,
                                            Anexos: Anexos}
                                        )
                                    )
                                )
                            );
                            Notify("RECARREGADO", NotificationType.Information);
                            
                        Tooltip: ="RECARREGAR"
                        Visible: |-
                            =And(
                                MPR_galNavigation_T.Selected.Value <> "NOVA FOP",
                                MPR_galNavigation_T.Selected.Value <> "ASSINATURA"
                            )
                        Width: =60
                        ZIndex: =7

            MPR_conTools_Right As groupContainer.verticalAutoLayoutContainer:
                DropShadow: =DropShadow.None
                Fill: =RGBA(217, 217, 214, 1)
                FillPortions: =2
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =0
                LayoutMinWidth: =0
                LayoutMode: =LayoutMode.Auto
                ZIndex: =2

                MPR_rtlPadTop_T As rectangle:
                    AlignInContainer: =AlignInContainer.Stretch
                    Fill: =RGBA(255, 255, 255, 1)
                    Height: =15
                    LayoutMinWidth: =0
                    ZIndex: =1

                MTR_conLabels As groupContainer.horizontalAutoLayoutContainer:
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: =40
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutGap: =10
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    LayoutMode: =LayoutMode.Auto
                    PaddingRight: =10
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    ZIndex: =2

                    MTR_lblHistorical As label:
                        AlignInContainer: =AlignInContainer.Stretch
                        FillPortions: =1
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Bold
                        Height: =35
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        PaddingLeft: =15
                        Size: =12
                        Text: |-
                            =If(MPR_galNavigation_T.Selected.Value="APROVAÇÕES",
                                "Histórico",
                            
                            MPR_galNavigation_T.Selected.Value="CONFIRMAÇÕES",
                                "Ações para FOP: " & MPR_galConfirmations_T.Selected.Codigo_FOP
                            )
                        Visible: =MPR_galNavigation_T.Selected.Value<>"HISTÓRICOS"
                        Width: =316
                        X: =776
                        Y: =34
                        ZIndex: =2

                    MTR_lblNavigation As label:
                        FillPortions: =1
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Bold
                        Height: =30
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        PaddingBottom: =0
                        PaddingLeft: =15
                        PaddingRight: =0
                        PaddingTop: =0
                        Size: =12
                        Text: |-
                            =If(IsBlank(SelectedUsina),
                            
                                /*Caso usuário não tenha escolhido nenhuma usina*/
                                "Procurar Histórico", 
                            
                                /*Quando visualiza os diferentes projetos*/
                                "Usina: " & SelectedUsina
                            
                             & 
                            
                            If(SelectedUsina="CVU",
                            
                                " - Diversidade" & If(IsBlank(SelectedDiversity),
                            
                                                        /*Quando não foi selecionada Diversidade, não mostra o resto de infos*/ 
                                                        "",
                            
                                                        /*Ao escolher diversidade mostra a escolha*/
                                                        ": " & SelectedDiversity & " - UET" & If(IsBlank(SelectedUET),
                            
                                                                /*Quando não foi selecionada UET, não mostra o resto de infos*/ 
                                                                "" ,
                            
                                                                /*Ao escolher UET mostra a escolha*/
                                                                ": " & SelectedUET & " - Posto"
                                                        )
                                                    ),
                            
                                " - UET" & If(IsBlank(SelectedUET),
                            
                                                                /*Quando não foi selecionada UET, não mostra o resto de infos*/ 
                                                                "" ,
                            
                                                                /*Ao escolher UET mostra a escolha*/
                                                                ": " & SelectedUET & Switch(SelectedUET,
                            
                                                                                            "PRP", " - Diversidade" & If(IsBlank(SelectedDiversity),
                            
                                                                                                                            /*Quando não foi selecionada Diversidade, não mostra o resto de infos*/ 
                                                                                                                            "",
                            
                                                                                                                            /*Ao escolher diversidade mostra a escolha*/
                                                                                                                            ": " & SelectedDiversity
                                                                                                                        ),
                            
                                                                                            "PK2", " - Diversidade" & If(IsBlank(SelectedDiversity),
                            
                                                                                                                            /*Quando não foi selecionada Diversidade, não mostra o resto de infos*/ 
                                                                                                                            "",
                            
                                                                                                                            /*Ao escolher diversidade mostra a escolha*/
                                                                                                                            ": " & SelectedDiversity
                                                                                                                        ),
                                                               
                                                                                            " - Posto" & If(IsBlank(SelectedPosto),
                            
                                                                                                            /*Quando não foi selecionado posto, não mostra o resto de infos*/ 
                                                                                                            "",
                            
                                                                                                            /*Ao escolher posto mostra a escolha*/
                                                                                                             ": " & SelectedPosto
                                                                                                        )
                                                                                    )
                                                            )
                            )
                            )
                        Visible: =MPR_galNavigation_T.Selected.Value="HISTÓRICOS"
                        Width: =Parent.Width
                        X: =16
                        Y: =36
                        ZIndex: =3

                    MTR_icnReturnUET As icon.Add:
                        Color: =RGBA(0, 0, 0, 1)
                        Height: =35
                        Icon: =Icon.BackArrow
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        OnSelect: |
                            =Set(SelectedUsina, Blank());
                            Set(SelectedUET, Blank());
                            
                            Set(UETGalleryVisible, false);
                            Set(UsinaGalleryVisible, true);
                        Visible: |-
                            =And(
                                MPR_galNavigation_T.Selected.Value="HISTÓRICOS",
                                UETGalleryVisible
                            )
                        Width: =30
                        X: =532
                        Y: =36
                        ZIndex: =4

                    MTR_inpPosto As text:
                        Align: =Align.Justify
                        AlignInContainer: =AlignInContainer.Center
                        BorderColor: =RGBA(136, 139, 141, 1)
                        BorderThickness: =1
                        Clear: =true
                        Default: =""
                        DelayOutput: =true
                        Fill: =RGBA(0, 0, 0, 0)
                        Font: =Font.Arial
                        Height: =30
                        HintText: ="Procure o posto"
                        HoverBorderColor: =RGBA(136, 139, 141, 1)
                        HoverFill: =RGBA(187, 188, 188, 1)
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        MaxLength: =500
                        PaddingBottom: =0
                        PaddingLeft: =10
                        PaddingRight: =10
                        PaddingTop: =0
                        RadiusBottomLeft: =15
                        RadiusBottomRight: =15
                        RadiusTopLeft: =15
                        RadiusTopRight: =15
                        Size: =12
                        Tooltip: ="Procurar posto"
                        Visible: |-
                            =And(
                                MPR_galNavigation_T.Selected.Value="HISTÓRICOS",
                                PostoGalleryVisible
                            )
                        Width: =200
                        X: =71
                        Y: =66
                        ZIndex: =5

                    MTR_icnReturnPosto As icon.Add:
                        Color: =RGBA(0, 0, 0, 1)
                        Height: =35
                        Icon: =Icon.BackArrow
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        OnSelect: |-
                            =Set(SelectedUET, Blank());  
                            Set(UETGalleryVisible, true);
                            
                            Set(PostoGalleryVisible, false);
                            Set(SelectedPosto, Blank());
                            
                            Reset(MTR_inpPosto)
                        Visible: |-
                            =And(
                                MPR_galNavigation_T.Selected.Value="HISTÓRICOS",
                                PostoGalleryVisible
                            )
                        Width: =30
                        X: =532
                        Y: =36
                        ZIndex: =6

                    MTR_icnReturnDiversidade As icon.Add:
                        Color: =RGBA(0, 0, 0, 1)
                        Height: =35
                        Icon: =Icon.BackArrow
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        OnSelect: |+
                            =Set(SelectedPosto, Blank());
                            Set(SelectedDiversity, Blank());
                            
                            Set(PostoGalleryVisible, true);
                            Set(DiversityGalleryVisible, false);
                            
                        Visible: |-
                            =And(
                                MPR_galNavigation_T.Selected.Value="HISTÓRICOS",
                                DiversityGalleryVisible
                            )
                        Width: =30
                        X: =532
                        Y: =36
                        ZIndex: =7

                "MTR_galHistorical_T As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    '#CopilotOverlayLabel': ="Filtrada"
                    Default: =//First(SortByColumns(Self.AllItems; "Data"; SortOrder.Descending))
                    DelayItemLoading: =true
                    Height: =485
                    Items: |-
                        =Sort(
                            HistoricoFOP_MPR,
                            Data,
                            SortOrder.Descending
                        )
                    Layout: =Layout.Vertical
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    LoadingSpinner: =LoadingSpinner.Data
                    TemplatePadding: =0
                    TemplateSize: =110
                    Visible: =MPR_galNavigation_T.Selected.Value="APROVAÇÕES"
                    Width: =555
                    X: =776
                    Y: =93
                    ZIndex: =3

                    MHR_rtlLastHistorical As rectangle:
                        Fill: =RGBA(239, 223, 0, 1)
                        Height: =Parent.TemplateHeight
                        OnSelect: =
                        Visible: =ThisItem.IsSelected
                        Width: =15
                        X: =Parent.TemplateWidth - Self.Width - 15
                        ZIndex: =1

                    MHR_rtlSeparator As rectangle:
                        Height: =2
                        OnSelect: =Select(Parent)
                        Width: =Parent.TemplateWidth
                        Y: =Parent.TemplateHeight - Self.Height
                        ZIndex: =2

                    MHR_conRightInfo As groupContainer.verticalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        Height: =110
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMode: =LayoutMode.Auto
                        PaddingRight: =35
                        Width: =Parent.TemplateWidth/3
                        X: =Parent.TemplateWidth*2/3
                        ZIndex: =3

                        MHR_lblData As label:
                            Align: =Align.Right
                            AlignInContainer: =AlignInContainer.Stretch
                            FillPortions: =1
                            Font: =Font.Arial
                            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                            Height: =25
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            OnSelect: =
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingRight: =0
                            PaddingTop: =0
                            Size: =12
                            Text: =ThisItem.Data
                            Width: =175
                            ZIndex: =1

                        MHR_lblIndex As label:
                            Align: =Align.Right
                            AlignInContainer: =AlignInContainer.Stretch
                            FillPortions: =If(!IsEmpty(MHR_attAnexos.Attachments), 1 , 4)
                            Font: =Font.Arial
                            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                            Height: =25
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            OnSelect: =
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingRight: =0
                            PaddingTop: =0
                            Size: =12
                            Text: |-
                                ="Indice: " & ThisItem.Indice
                            VerticalAlign: =VerticalAlign.Top
                            Width: =175
                            Y: =18
                            ZIndex: =2

                        MHR_attAnexos As attachments:
                            AlignInContainer: =AlignInContainer.Stretch
                            BorderColor: =RGBA(136, 139, 141, 1)
                            BorderThickness: =1
                            DisabledBorderColor: =RGBA(136, 139, 141, 1)
                            DisabledColor: =RGBA(62, 63, 64, 1)
                            DisabledFill: =RGBA(0, 0, 0, 0)
                            DisplayMode: =DisplayMode.View
                            DropTargetBorderThickness: =1
                            Fill: =RGBA(0, 0, 0, 0)
                            FillPortions: =3
                            FocusedBorderThickness: =1
                            Font: =Font.Arial
                            Height: =45
                            HoverFill: =RGBA(136, 139, 141, 1)
                            IsInDataCard: =true
                            ItemFill: =RGBA(136, 139, 141, 1)
                            ItemHoverColor: =RGBA(255, 255, 255, 1)
                            ItemHoverFill: =RGBA(62, 63, 64, 1)
                            Items: =ThisItem.Anexos
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            PaddingBottom: =5
                            PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                            PaddingRight: =5
                            PaddingTop: =5
                            PressedFill: =RGBA(136, 139, 141, 1)
                            Size: =8
                            Tooltip: ="" 
                            Visible: =!IsEmpty(Self.Attachments)
                            Width: =137
                            Y: =45
                            ZIndex: =3

                    MHR_conLeftInfo As groupContainer.verticalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        Height: =Parent.TemplateHeight
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMode: =LayoutMode.Auto
                        Width: =Parent.TemplateWidth*2/3
                        ZIndex: =4

                        MHR_lblHistoricalType As label:
                            AlignInContainer: =AlignInContainer.Stretch
                            Font: =Font.Arial
                            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                            Height: =20
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            OnSelect: |
                                =
                            PaddingBottom: =0
                            PaddingLeft: =10
                            PaddingRight: =0
                            PaddingTop: =0
                            Size: =11
                            Text: =ThisItem.Tipo_Registro
                            Width: =430
                            ZIndex: =1

                        MHR_lblResponsable As label:
                            AlignInContainer: =AlignInContainer.Stretch
                            Font: =Font.Arial
                            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                            Height: =15
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            OnSelect: =
                            PaddingBottom: =0
                            PaddingLeft: =10
                            PaddingRight: =0
                            PaddingTop: =0
                            Size: =10
                            Text: |-
                                ="Por: " & ThisItem.Responsavel.DisplayName
                            Width: =Parent.Width
                            X: =1
                            Y: =25
                            ZIndex: =2

                        MHR_lblDescription As label:
                            AlignInContainer: =AlignInContainer.Stretch
                            FillPortions: =3
                            Font: =Font.Arial
                            FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                            Height: =45
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            OnSelect: =
                            Overflow: =Overflow.Scroll
                            PaddingBottom: =0
                            PaddingLeft: =10
                            PaddingRight: =0
                            Size: =10
                            Text: =ThisItem.Registro
                            VerticalAlign: =VerticalAlign.Top
                            Width: =360
                            Y: =45
                            ZIndex: =3

                "MTR_glrUsina As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    '#CopilotOverlayLabel': ="Filtrada"
                    Default: =Blank()
                    DelayItemLoading: =true
                    Height: =537
                    Items: =Distinct(ListaPostosMPR, Usina)
                    Layout: =Layout.Vertical
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    LoadingSpinner: =LoadingSpinner.Data
                    TemplatePadding: =0
                    TemplateSize: =130
                    Visible: |-
                        =And(
                            MPR_galNavigation_T.Selected.Value="HISTÓRICOS",
                            UsinaGalleryVisible
                        )
                    Width: =Parent.Width
                    WrapCount: =2
                    X: =16
                    Y: =82
                    ZIndex: =4

                    MTR_btnUsina As button:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        DisplayMode: |-
                            =DisplayMode.Edit
                                    
                        Fill: =RGBA(0, 0, 0, 1)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Bold
                        Height: =50
                        HoverBorderColor: =RGBA(238, 235, 76, 1)
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =RGBA(238, 235, 76, 1)
                        OnSelect: |+
                            =Set(SelectedUsina, ThisItem.Value);
                            
                            Set(UsinaGalleryVisible, false);
                            Set(UETGalleryVisible, true);
                            
                            
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =30
                        RadiusTopLeft: =30
                        RadiusTopRight: =0
                        Text: =ThisItem.Value
                        Width: =180
                        X: =Parent.TemplateWidth/2 - Self.Width/2
                        Y: =Parent.TemplateHeight/2 - Self.Height/2
                        ZIndex: =1

                "MTR_glrUET As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    '#CopilotOverlayLabel': ="Filtrada"
                    Default: =Blank()
                    DelayItemLoading: =true
                    Height: =567
                    Items: |-
                        =Sort(    
                            Distinct(   
                                Filter(
                                    ListaPostosMPR,            
                                    Usina=SelectedUsina
                                ),  
                                UET
                            ),
                            Value,
                            SortOrder.Ascending
                        )
                    Layout: =Layout.Vertical
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    LoadingSpinner: =LoadingSpinner.Data
                    TemplatePadding: =0
                    TemplateSize: =60
                    Visible: |-
                        =And(
                            MPR_galNavigation_T.Selected.Value="HISTÓRICOS",
                            UETGalleryVisible
                        )
                    Width: =585
                    WrapCount: =2
                    Y: =80
                    ZIndex: =5

                    MTR_btnUET As button:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Fill: =RGBA(0, 0, 0, 1)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Bold
                        HoverBorderColor: =RGBA(238, 235, 76, 1)
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =RGBA(238, 235, 76, 1)
                        OnSelect: |-
                            =Set(PostoGalleryVisible, true);
                            Set(UETGalleryVisible, false);
                            
                            Set(SelectedUET, ThisItem.Value)
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =30
                        Text: =ThisItem.Value
                        Width: =180
                        X: =Parent.TemplateWidth/2 - Self.Width/2
                        Y: =Parent.TemplateHeight/2 - Self.Height/2
                        ZIndex: =1

                "MTR_glrPosto As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    '#CopilotOverlayLabel': ="Filtrada"
                    Default: =Blank()
                    DelayItemLoading: =true
                    Height: =565
                    Items: |-
                        =Search(
                            Sort(
                                Distinct(  
                                    Filter(
                                        ListaPostosMPR,       
                                            Usina=SelectedUsina,
                                            UET=SelectedUET
                                    ), 
                                    Posto
                                ), 
                                Value,
                                SortOrder.Ascending
                            ), 
                            MTR_inpPosto.Text,
                            Value
                        )
                    Layout: =Layout.Vertical
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    LoadingSpinner: =LoadingSpinner.Data
                    TemplatePadding: =0
                    TemplateSize: =60
                    Visible: |-
                        =And(
                            MPR_galNavigation_T.Selected.Value="HISTÓRICOS",
                            PostoGalleryVisible
                        )
                    Width: =585
                    WrapCount: =2
                    Y: =82
                    ZIndex: =6

                    MTR_btnPosto As button:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Fill: =RGBA(0, 0, 0, 1)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Bold
                        HoverBorderColor: =RGBA(238, 235, 76, 1)
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =RGBA(238, 235, 76, 1)
                        OnSelect: |+
                            =Set(SelectedPosto, ThisItem.Value);
                             
                            Set(PostoGalleryVisible, false);
                            Set(DiversityGalleryVisible, true);
                            
                            
                            
                            
                            
                            
                            
                            
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopRight: =30
                        Size: |-
                            =If(SelectedUET="PK2",
                            12,
                            15
                            )
                        Text: =ThisItem.Value
                        Width: =180
                        X: =Parent.TemplateWidth/2 - Self.Width/2
                        Y: =Parent.TemplateHeight/2 - Self.Height/2
                        ZIndex: =1

                "MTR_glrDiversidade As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    '#CopilotOverlayLabel': ="Filtrada"
                    Default: =Blank()
                    DelayItemLoading: =true
                    Height: =565
                    Items: |-
                        =Sort(
                            Distinct(   
                                Filter(
                                    ListaPostosMPR,           
                                    Usina=SelectedUsina,
                                    UET=SelectedUET,
                                    Posto=SelectedPosto         
                                ),   
                                Diversidade),
                            Value,
                            SortOrder.Ascending
                        )
                    Layout: =Layout.Vertical
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    LoadingSpinner: =LoadingSpinner.Data
                    TemplatePadding: =0
                    TemplateSize: =130
                    Visible: |-
                        =And(
                            MPR_galNavigation_T.Selected.Value="HISTÓRICOS",
                            DiversityGalleryVisible
                        )
                    Width: =585
                    WrapCount: =2
                    Y: =82
                    ZIndex: =7

                    MTR_btnDiversidade As button:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        DisplayMode: |-
                            =DisplayMode.Edit
                                    
                        Fill: =RGBA(0, 0, 0, 1)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Bold
                        Height: =60
                        HoverBorderColor: =RGBA(238, 235, 76, 1)
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =RGBA(238, 235, 76, 1)
                        OnSelect: |+
                            =Set(SelectedDiversity, ThisItem.Value);
                            Set(CodigoFOP, Concatenate(SelectedUsina,"-",SelectedUET,"-",SelectedPosto,"-",SelectedDiversity));
                            
                            ClearCollect(HistoricoFOP_MPR, 
                                ForAll(
                                    Filter(FOPs_MPR_Historicos, Codigo_FOP=CodigoFOP),
                                    {Tipo_Registro: Tipo_Registro,
                                    Codigo_FOP: Codigo_FOP,
                                    Indice_FOP: Indice_FOP,
                                    Responsavel: Responsavel,
                                    Registro: Registro,
                                    Data: Data,
                                    Anexos: Anexos}
                                )
                            )
                            
                            
                            
                            
                            
                            
                            
                        RadiusBottomLeft: =0
                        RadiusBottomRight: |
                            =25
                        RadiusTopLeft: =50
                        RadiusTopRight: =25
                        Text: =ThisItem.Value
                        Width: =140
                        X: =MTR_imgDiversidade.X + MTR_imgDiversidade.Width*0.6
                        Y: =Parent.TemplateHeight/2 - Self.Height/2
                        ZIndex: =1

                    MTR_imgDiversidade As image:
                        Height: =120
                        Image: =LookUp(Fotos_Projetos, Diversidade=ThisItem.Value, Foto)          
                        OnSelect: |+
                            =Set(SelectedDiversity, ThisItem.Value);
                            Set(CodigoFOP, Concatenate(SelectedUsina,"-",SelectedUET,"-",SelectedPosto,"-",SelectedDiversity));
                            
                            ClearCollect(HistoricoFOP_MPR, 
                                    ForAll(
                                            Filter(FOPs_MPR_Historicos, Codigo_FOP=CodigoFOP),
                            
                                            {Tipo_Registro: Tipo_Registro,
                                            Codigo_FOP: Codigo_FOP,
                                            Indice_FOP: Indice_FOP,
                                            Responsavel: Responsavel,
                                            Registro: Registro,
                                            Data: Data,
                                            Anexos: Anexos}
                                    )
                            )
                            
                            
                            
                            
                            
                            
                            
                        Width: =160
                        X: =Parent.TemplateWidth*0.05
                        Y: =Parent.TemplateHeight/2 - Self.Height/2
                        ZIndex: =2

                MTR_conConfirmations_T As groupContainer.verticalAutoLayoutContainer:
                    DropShadow: =DropShadow.None
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    LayoutMode: =LayoutMode.Auto
                    Visible: =MPR_galNavigation_T.Selected.Value="CONFIRMAÇÕES" 
                    ZIndex: =8

                    MRC_conUpdateAPW_T As groupContainer.horizontalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =80
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        LayoutMode: =LayoutMode.Auto
                        PaddingBottom: =20
                        PaddingLeft: =10
                        PaddingRight: =10
                        PaddingTop: =20
                        ZIndex: =2

                        CUA_lblUpdateAPW_T As label:
                            Align: =Align.Justify
                            Font: =Font.Arial
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            Size: =12
                            Text: ="Índice da FOP atualizada no ProAPW"
                            Width: =320
                            X: =776
                            Y: =34
                            ZIndex: =1

                        Rectangle14_3 As rectangle:
                            AlignInContainer: =AlignInContainer.Stretch
                            Fill: =RGBA(0, 0, 0, 0)
                            FillPortions: =1
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            ZIndex: =2

                        CUA_icnUpdateAPW_T As icon.CheckBadge:
                            AccessibleLabel: ="FEITO"
                            AlignInContainer: =AlignInContainer.Stretch
                            Color: =RGBA(0, 0, 0, 1)
                            Icon: =Icon.CheckBadge
                            LayoutMinHeight: =0
                            Tooltip: ="FEITO"
                            Visible: = MPR_galConfirmations_T.Selected.Indice_APW
                            Width: =70
                            ZIndex: =3

                        CUA_icnNotUpdateAPW_T As icon.CheckBadge:
                            AccessibleLabel: ="PENDENTE"
                            AlignInContainer: =AlignInContainer.Stretch
                            Color: =RGBA(0, 0, 0, 1)
                            Icon: =Icon.Error
                            LayoutMinHeight: =0
                            Tooltip: ="PENDENTE"
                            Visible: =!MPR_galConfirmations_T.Selected.Indice_APW
                            Width: =70
                            ZIndex: =4

                        CUA_btnUpdateAPW_T As button:
                            BorderColor: =RGBA(239, 223, 0, 1)
                            Color: =RGBA(0, 0, 0, 1)
                            Fill: =RGBA(239, 223, 0, 1)
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Bold
                            Height: =Parent.Height*0.6
                            HoverBorderColor: =RGBA(238, 235, 76, 1)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =RGBA(238, 235, 76, 1)
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            OnSelect: |-
                                =Patch(FOPs_MPR_EmUso, MPR_galConfirmations_T.Selected, {Indice_APW: true});
                                
                                Patch(FOPs_MPR_Historicos, Defaults(FOPs_MPR_Historicos), 
                                    {Tipo_Registro: "Notificação: ProAPW",
                                    Codigo_FOP: MPR_galConfirmations_T.Selected.Codigo_FOP,
                                    Usina: MPR_galConfirmations_T.Selected.Usina,
                                    UET: MPR_galConfirmations_T.Selected.UET,
                                    Posto: MPR_galConfirmations_T.Selected.Posto,
                                    Projeto: MPR_galConfirmations_T.Selected.Projeto,
                                    Diversidade: MPR_galConfirmations_T.Selected.Diversidade,
                                    N_FOP: MPR_galConfirmations_T.Selected.N_FOP,
                                    Indice_FOP: MPR_galConfirmations_T.Selected.Indice_FOP,
                                    Registro: "FOP atualizada no ProAPW por Engenharia.",
                                    Responsavel: {DisplayName: User().FullName,
                                                        Claims: "i:0#.f|membership|" & Lower(User().Email),
                                                        Department: "",
                                                        JobTitle: "",
                                                        Picture: User().Image,
                                                        Email: User().Email}}
                                );
                                   
                                Notify("FOP ATUALIZADA COM SUCESSO", NotificationType.Success);
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Text: ="Sim"
                            Visible: |-
                                =And(
                                    !MPR_galConfirmations_T.Selected.Indice_APW,
                                
                                    Or(
                                        MPR_galConfirmations_T.Selected.Preparador.Email = User().Email,
                                        MPR_galConfirmations_T.Selected.Aprovador.Email  = User().Email
                                    )
                                ) 
                            Width: =100
                            X: =589
                            Y: =586
                            ZIndex: =5

                    MRC_conFOSCreated_T As groupContainer.horizontalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =80
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        LayoutMode: =LayoutMode.Auto
                        PaddingBottom: =20
                        PaddingLeft: =10
                        PaddingRight: =10
                        PaddingTop: =20
                        ZIndex: =3

                        CFC_lblFOSCreated_T As label:
                            Align: =Align.Justify
                            Font: =Font.Arial
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            Size: =12
                            Text: ="FOS atualizada e carregada no ProAPW"
                            Width: =320
                            X: =776
                            Y: =34
                            ZIndex: =1

                        Rectangle14_4 As rectangle:
                            AlignInContainer: =AlignInContainer.Stretch
                            Fill: =RGBA(0, 0, 0, 0)
                            FillPortions: =1
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            ZIndex: =2

                        CFC_icnFOSCreated_T As icon.CheckBadge:
                            AccessibleLabel: ="FEITO"
                            AlignInContainer: =AlignInContainer.Stretch
                            Color: =RGBA(0, 0, 0, 1)
                            Icon: =Icon.CheckBadge
                            LayoutMinHeight: =0
                            Tooltip: ="FEITO"
                            Visible: =MPR_galConfirmations_T.Selected.FOS_Criada
                            Width: =70
                            ZIndex: =3

                        CFC_icnFOSNotCreated_T As icon.CheckBadge:
                            AccessibleLabel: ="PENDENTE"
                            AlignInContainer: =AlignInContainer.Stretch
                            Color: =RGBA(0, 0, 0, 1)
                            Icon: =Icon.Error
                            LayoutMinHeight: =0
                            Tooltip: ="PENDENTE"
                            Visible: |-
                                =And(
                                    !MPR_galConfirmations_T.Selected.FOS_Criada,
                                    MPR_galConfirmations_T.Selected.Indice_APW
                                )    
                            Width: =70
                            ZIndex: =4

                        CFC_btnFOSCreated_T As button:
                            AlignInContainer: =AlignInContainer.Center
                            BorderColor: =RGBA(239, 223, 0, 1)
                            Color: =RGBA(0, 0, 0, 1)
                            Fill: =RGBA(239, 223, 0, 1)
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Bold
                            Height: =Parent.Height*0.6
                            HoverBorderColor: =RGBA(238, 235, 76, 1)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =RGBA(238, 235, 76, 1)
                            LayoutMinHeight: =0
                            OnSelect: |-
                                =Patch(FOPs_MPR_EmUso, MPR_galConfirmations_T.Selected, {FOS_Criada: true});
                                
                                Patch(FOPs_MPR_Historicos, Defaults(FOPs_MPR_Historicos), 
                                    {Tipo_Registro: "Notificação: FOS Criada",
                                    Codigo_FOP: MPR_galConfirmations_T.Selected.Codigo_FOP,
                                    Usina: MPR_galConfirmations_T.Selected.Usina,
                                    UET: MPR_galConfirmations_T.Selected.UET,
                                    Posto: MPR_galConfirmations_T.Selected.Posto,
                                    Projeto: MPR_galConfirmations_T.Selected.Projeto,
                                    Diversidade: MPR_galConfirmations_T.Selected.Diversidade,
                                    N_FOP: MPR_galConfirmations_T.Selected.N_FOP,
                                    Indice_FOP: MPR_galConfirmations_T.Selected.Indice_FOP,
                                    Registro: "FOS criada e carregada no ProAPW por Fabricação.",
                                    Responsavel: {DisplayName: User().FullName,
                                                        Claims: "i:0#.f|membership|" & Lower(User().Email),
                                                        Department: "",
                                                        JobTitle: "",
                                                        Picture: User().Image,
                                                        Email: User().Email}}
                                );
                                    
                                Notify("FOP ATUALIZADA COM SUCESSO", NotificationType.Success);
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Text: ="Sim"
                            Visible: |-
                                =And(
                                    !MPR_galConfirmations_T.Selected.FOS_Criada,
                                    MPR_galConfirmations_T.Selected.Indice_APW,   
                                    MPR_galConfirmations_T.Selected.Fabricacao.Email = User().Email
                                )
                            Width: =100
                            X: =1205
                            Y: =586
                            ZIndex: =5

                    MRC_conFOSValidated_T As groupContainer.horizontalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: =80
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        LayoutMode: =LayoutMode.Auto
                        PaddingBottom: =20
                        PaddingLeft: =10
                        PaddingRight: =10
                        PaddingTop: =20
                        ZIndex: =4

                        CFV_lblFOSValidated_T As label:
                            Align: =Align.Justify
                            Font: =Font.Arial
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            Size: =12
                            Text: ="FOS validada por Engenharia"
                            Width: =300
                            X: =776
                            Y: =34
                            ZIndex: =1

                        Rectangle14_5 As rectangle:
                            Fill: =RGBA(0, 0, 0, 0)
                            FillPortions: =1
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            ZIndex: =2

                        CFV_icnFOSValidated_T As icon.CheckBadge:
                            AlignInContainer: =AlignInContainer.Stretch
                            Color: =RGBA(0, 0, 0, 1)
                            Icon: =Icon.CheckBadge
                            LayoutMinHeight: =0
                            Visible: =MPR_galConfirmations_T.Selected.FOS_Validada
                            Width: =70
                            ZIndex: =3

                        CFV_icnNotFOSValidated_T As icon.CheckBadge:
                            AccessibleLabel: ="PENDENTE"
                            AlignInContainer: =AlignInContainer.Stretch
                            Color: =RGBA(0, 0, 0, 1)
                            Icon: =Icon.Error
                            LayoutMinHeight: =0
                            Tooltip: ="PENDENTE"
                            Visible: |-
                                =And(
                                    !MPR_galConfirmations_T.Selected.FOS_Validada,
                                    MPR_galConfirmations_T.Selected.FOS_Criada
                                )
                            Width: =70
                            ZIndex: =4

                        CFV_btnFOSValidated_T As button:
                            BorderColor: =RGBA(239, 223, 0, 1)
                            Color: =RGBA(0, 0, 0, 1)
                            Fill: =RGBA(239, 223, 0, 1)
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Bold
                            Height: =Parent.Height*0.6
                            HoverBorderColor: =RGBA(238, 235, 76, 1)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =RGBA(238, 235, 76, 1)
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            OnSelect: |-
                                =Patch(FOPs_MPR_EmUso, MPR_galConfirmations_T.Selected, {FOS_Validada: true});
                                
                                Patch(FOPs_MPR_Historicos, Defaults(FOPs_MPR_Historicos), 
                                    {Tipo_Registro: "Notificação: FOS Validada",
                                    Codigo_FOP: MPR_galConfirmations_T.Selected.Codigo_FOP,
                                    Usina: MPR_galConfirmations_T.Selected.Usina,
                                    UET: MPR_galConfirmations_T.Selected.UET,
                                    Posto: MPR_galConfirmations_T.Selected.Posto,
                                    Projeto: MPR_galConfirmations_T.Selected.Projeto,
                                    Diversidade: MPR_galConfirmations_T.Selected.Diversidade,
                                    N_FOP: MPR_galConfirmations_T.Selected.N_FOP,
                                    Indice_FOP: MPR_galConfirmations_T.Selected.Indice_FOP,
                                    Registro: "FOS validada no ProAPW por Engenharia.",
                                    Responsavel: {DisplayName: User().FullName,
                                                        Claims: "i:0#.f|membership|" & Lower(User().Email),
                                                        Department: "",
                                                        JobTitle: "",
                                                        Picture: User().Image,
                                                        Email: User().Email}}
                                );
                                 
                                Notify("VALIDAÇÃO REGISTRADA COM SUCESSO", NotificationType.Success);
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Text: ="Sim"
                            Visible: |-
                                =And(
                                    !MPR_galConfirmations_T.Selected.FOS_Validada,
                                    MPR_galConfirmations_T.Selected.FOS_Criada,
                                
                                    Or(
                                        MPR_galConfirmations_T.Selected.Preparador.Email = User().Email,
                                        MPR_galConfirmations_T.Selected.Aprovador.Email = User().Email
                                    )
                                ) 
                            Width: =100
                            X: =589
                            Y: =586
                            ZIndex: =5

                MTR_conBtns_T As groupContainer.horizontalAutoLayoutContainer:
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: =50
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutGap: =15
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =15
                    PaddingRight: =15
                    Visible: |-
                        =And(
                            MPR_galNavigation_T.Selected.Value="APROVAÇÕES",
                            FOP_ApprovalFOPDetailsVisible
                        )
                    ZIndex: =9

                    MDA_btnEditDoc_T As button:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        DisplayMode: |-
                            =DisplayMode.Edit
                                    
                        Fill: =RGBA(0, 0, 0, 1)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Bold
                        HoverBorderColor: =RGBA(238, 235, 76, 1)
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =RGBA(238, 235, 76, 1)
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        OnSelect: |-
                            =Set(PopUpVisible, true);
                            Set(PopUpModifyFOPVisible, true);
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Text: ="Alterar FOP"
                        Visible: |-
                            =And(
                                MPR_frmDetails_T.DisplayMode=DisplayMode.Edit,     
                                MDA_cbxPreparador_T.Selected.Email=User().Email,             
                                IsBlank(MDA_imgAssAprovador_T.Image)
                            )              
                        Width: =FOP_PE_ReturnBtn.Width
                        X: =43
                        Y: =586
                        ZIndex: =1

                    Rectangle2_9 As rectangle:
                        Fill: =RGBA(0, 0, 0, 0)
                        FillPortions: =1
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        ZIndex: =2

                    MDA_btnShowTable_T As button:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        DisplayMode: |-
                            =DisplayMode.Edit
                                    
                        Fill: =RGBA(0, 0, 0, 1)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Bold
                        Height: =Parent.Height*0.7
                        HoverBorderColor: =RGBA(238, 235, 76, 1)
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =RGBA(238, 235, 76, 1)
                        LayoutMinWidth: =0
                        OnSelect: |-
                            =Set(FOP_PDF, LookUp(MPRTabelaAfetacao.Anexos, EndsWith(DisplayName, ".pdf"), Value));
                            Set(PDFViewVisible, true);
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =12
                        Text: ="Ver Tab. Afetação"
                        Visible: =!IsBlank(MPRTabelaAfetacao)
                        Width: =120
                        X: =43
                        Y: =586
                        ZIndex: =3

                    MDA_btnShowFOP_T As button:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        DisplayMode: |-
                            =DisplayMode.Edit
                                    
                        Fill: =RGBA(0, 0, 0, 1)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Bold
                        Height: =Parent.Height*0.7
                        HoverBorderColor: =RGBA(238, 235, 76, 1)
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =RGBA(238, 235, 76, 1)
                        LayoutMinWidth: =0
                        OnSelect: |-
                            =Set(FOP_PDF, LookUp(MPR_galApprovals_T.Selected.Anexos, EndsWith(DisplayName, ".pdf"), Value));
                            Set(PDFViewVisible, true);
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Text: ="Ver FOP"
                        Visible: =!IsEmpty(MPR_galApprovals_T.Selected.Anexos) //Verifica se existe um arquivo FOP para aprovar
                        Width: =120
                        X: =43
                        Y: =586
                        ZIndex: =4

    MPR_pdfNewFOP_T As pdfViewer:
        BorderColor: =RGBA(0, 0, 0, 1)
        Document: |-
            =If(IsEmpty(MNF_attAnexos_T.Attachments),
            
                    //Se não tem documento em anexo, usa o padrão do app
                    PDF_Padrao,
            
                    //Quando carregou o arquivo, mostra o arquivo do controle de anexos 
                    LookUp(MNF_attAnexos_T.Attachments, EndsWith(Name, ".pdf"), Value)
            )
        Fill: =RGBA(0, 0, 0, 0.5)
        Height: =MPR_conTools_Right.Height - MPR_rtlPadTop_T.Height
        ShowControls: =!IsEmpty(MNF_attAnexos_T.Attachments)
        Visible: =MPR_galNavigation_T.Selected.Value="NOVA FOP"
        Width: =MPR_conTools_Right.Width
        X: =MPR_conTools_Left.Width + MPR_conMain_Tools.LayoutGap + MPR_conMain_Tools.PaddingLeft
        Y: =FOP_CabecalhoCont_3.Height + MPR_rtlPadTop_T.Height
        ZIndex: =2

    MPR_pdfViewer_T As pdfViewer:
        BorderColor: =RGBA(0, 0, 0, 1)
        Document: |-
            =If(IsBlank(FOP_PDF),
            
                PDF_Padrao,
                FOP_PDF
            )
        Fill: =RGBA(0, 0, 0, 0.5)
        Height: =App.Height
        ShowControls: =true
        Visible: =PDFViewVisible
        Width: =App.Width
        ZIndex: =3

    MPR_btnReturnView_T As button:
        BorderColor: =RGBA(239, 223, 0, 1)
        Color: =RGBA(0, 0, 0, 1)
        Fill: =RGBA(239, 223, 0, 1)
        Font: =Font.Arial
        FontWeight: =FontWeight.Bold
        Height: =35
        HoverBorderColor: =RGBA(238, 235, 76, 1)
        HoverColor: =RGBA(0, 0, 0, 1)
        HoverFill: =RGBA(238, 235, 76, 1)
        OnSelect: |-
            =Set(FOP_PDF, Blank());
            Set(PDFViewVisible, false);
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Text: ="Voltar"
        Visible: =PDFViewVisible
        Width: =100
        X: =App.Width - Self.Width - 120
        Y: =12
        ZIndex: =4

    MPR_conPopUp_T As groupContainer.verticalAutoLayoutContainer:
        DropShadow: =DropShadow.None
        Fill: =RGBA(0, 0, 0, 0.33)
        Height: =App.Height - Self.Y
        LayoutAlignItems: =LayoutAlignItems.Center
        LayoutDirection: =LayoutDirection.Vertical
        LayoutJustifyContent: =LayoutJustifyContent.Center
        LayoutMode: =LayoutMode.Auto
        Visible: =PopUpVisible
        Width: =App.Width
        X: =
        Y: =FOP_CabecalhoCont_3.Height
        ZIndex: =5

        MPU_conReject_T As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.Center
            Fill: =RGBA(217, 217, 214, 1)
            FillPortions: =0
            Height: =Parent.Height*0.75
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMinHeight: =0
            LayoutMinWidth: =0
            LayoutMode: =LayoutMode.Auto
            Visible: =PopUpRejectVisible
            Width: =Parent.Width*0.4
            ZIndex: =3

            MPE_frmRejectFOP_T As form:
                DataSource: =FOPs_MPR_Historicos
                Item: =Defaults(FOPs_MPR_Historicos)
                LayoutMinHeight: =0
                LayoutMinWidth: =0
                NumberOfColumns: =1
                ZIndex: =1

                MPE_crdRegistro_T As typedDataCard.textualEditCard:
                    BorderColor: =RGBA(149, 149, 149, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="Registro"
                    Default: =ThisItem.Registro
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: =DataSourceInfo([@FOPs_MPR_Historicos],DataSourceInfo.DisplayName,Registro)
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =Parent.Height*0.69
                    MaxLength: =DataSourceInfo([@FOPs_MPR_Historicos], DataSourceInfo.MaxLength, Registro)
                    Required: =false
                    Update: =MPE_inpRegistro_T.Text
                    Width: =Parent.Width
                    X: =0
                    Y: =0
                    ZIndex: =4

                    MPE_inpRegistro_T As text:
                        BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                        BorderThickness: =1
                        Default: =Parent.Default
                        DelayOutput: =true
                        DisabledColor: =RGBA(62, 63, 64, 1)
                        DisplayMode: =Parent.DisplayMode
                        Fill: =RGBA(0, 0, 0, 0)
                        Font: =Font.Arial
                        Height: =Parent.Height - Self.Y*2
                        HintText: ="Informe o motivo da rejeição *"
                        HoverBorderColor: =RGBA(166, 166, 166, 1)
                        HoverFill: =RGBA(187, 188, 188, 1)
                        MaxLength: =Parent.MaxLength
                        Mode: =TextMode.MultiLine
                        PaddingLeft: =5
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =12
                        Tooltip: =Parent.DisplayName
                        Width: =Parent.Width - Self.X*2
                        X: =15
                        Y: |
                            =15
                        ZIndex: =1

                MPE_crdAnexos_T As typedDataCard.attachmentsEditCard:
                    BorderColor: =RGBA(149, 149, 149, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="{Attachments}"
                    Default: =ThisItem.Anexos
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: =DataSourceInfo([@FOPs_MPR_Historicos],DataSourceInfo.DisplayName,Anexos)
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =Parent.Height*0.3
                    Required: =false
                    Update: =MPE_attAnexos_T.Attachments
                    Width: =Parent.Width
                    X: =0
                    Y: =1
                    ZIndex: =4

                    MPE_attAnexos_T As attachments:
                        BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                        BorderThickness: =1
                        DisplayMode: =Parent.DisplayMode
                        Fill: =RGBA(0, 0, 0, 0)
                        Font: =Font.Arial
                        Height: =Parent.Height - Self.Y*2
                        HoverFill: =RGBA(187, 188, 188, 1)
                        IsInDataCard: =true
                        Items: =Parent.Default
                        PaddingBottom: =5
                        PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                        PaddingRight: =5
                        PaddingTop: =5
                        PressedColor: =RGBA(0, 0, 0, 1)
                        PressedFill: =RGBA(0, 0, 0, 0)
                        Size: =12
                        Tooltip: =Parent.DisplayName
                        Width: =Parent.Width - Self.X*2
                        X: =15
                        Y: =15
                        ZIndex: =1

            MPE_conRejectBttns As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                DropShadow: =DropShadow.None
                FillPortions: =0
                Height: =80
                LayoutGap: =40
                LayoutJustifyContent: =LayoutJustifyContent.Center
                LayoutMinHeight: =0
                LayoutMinWidth: =0
                LayoutMode: =LayoutMode.Auto
                PaddingBottom: =10
                PaddingLeft: =50
                PaddingRight: =50
                PaddingTop: =10
                Width: =Parent.Width
                ZIndex: =3

                MPE_btnSend_T As button:
                    AlignInContainer: =AlignInContainer.Center
                    BorderColor: =RGBA(239, 223, 0, 1)
                    Color: =RGBA(0, 0, 0, 1)
                    DisplayMode: |-
                        =//Verifica que o 'motivo da rejeição' seja preenchido com informação
                        If(IsBlank(MPE_inpRegistro_T.Text),
                            
                            //Se estiver vazio, fica desabilitado
                            DisplayMode.Disabled,
                        
                            //Caso contrario, é habilitado
                            DisplayMode.Edit
                        )
                    Fill: =RGBA(239, 223, 0, 1)
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Bold
                    Height: =35
                    HoverBorderColor: =RGBA(238, 235, 76, 1)
                    HoverColor: =RGBA(0, 0, 0, 1)
                    HoverFill: =RGBA(238, 235, 76, 1)
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    OnSelect: |+
                        =If(
                            And(
                                MDA_btnShowTable_T.Visible,
                                MDA_btnShowFOP_T.Visible
                            ),
                                Set(ArquivoModificado, "FOP + Tab. Afetação"),
                        
                            MDA_btnShowTable_T.Visible,
                                Set(ArquivoModificado, "Tab. Afetação"),
                        
                            MDA_btnShowFOP_T.Visible,
                                Set(ArquivoModificado, "FOP")
                        );
                        
                        If(MPR_galApprovals_T.Selected.Preparador.Email = User().Email,
                            Set(TipoHistorico, "Cancelamento: Preparador - " & ArquivoModificado),
                             
                        MPR_galApprovals_T.Selected.Aprovador.Email = User().Email,
                            Set(TipoHistorico, "Rejeição: Aprovador - " & ArquivoModificado), 
                        
                        MPR_galApprovals_T.Selected.Fabricacao.Email = User().Email,
                            Set(TipoHistorico, "Rejeição: Fabricação - " & ArquivoModificado)
                        );
                        
                        Patch(FOPs_MPR_Historicos, Defaults(FOPs_MPR_Historicos),
                                    MPE_frmRejectFOP_T.Updates, 
                                    {Tipo_Registro: TipoHistorico,
                                    Codigo_FOP: MPR_galApprovals_T.Selected.Codigo_FOP,
                                    Usina: MPR_galApprovals_T.Selected.Usina,
                                    UET: MPR_galApprovals_T.Selected.UET,
                                    Posto: MPR_galApprovals_T.Selected.Posto,
                                    Projeto: MPR_galApprovals_T.Selected.Projeto,
                                    Diversidade: MPR_galApprovals_T.Selected.Diversidade,
                                    N_FOP: MPR_galApprovals_T.Selected.N_FOP,
                                    Indice_FOP: MPR_galApprovals_T.Selected.Indice_FOP,
                                    Responsavel: {DisplayName: User().FullName,
                                                Claims: "i:0#.f|membership|" & Lower(User().Email),
                                                Department: "",
                                                JobTitle: "",
                                                Picture: User().Image,
                                                Email: User().Email}}
                        );
                        
                        Notify("Documento Rejeitado com sucesso. Os validadores serão notificados.", NotificationType.Warning);
                        
                        ResetForm(MPE_frmRejectFOP_T); 
                        
                        Set(TipoHistorico, Blank());
                        Set(ArquivoModificado, Blank());
                        
                        Set(PopUpVisible,false);   
                        Set(PopUpRejectVisible, false); 
                        Set(FOP_ApprovalFOPDetailsVisible, false) 
                        
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Text: ="Enviar"
                    Width: =120
                    X: =141
                    Y: =388
                    ZIndex: =1

                MPE_btnCancel_T As button:
                    AlignInContainer: =AlignInContainer.Center
                    BorderColor: =RGBA(0, 0, 0, 1)
                    Fill: =RGBA(0, 0, 0, 1)
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Bold
                    Height: =35
                    HoverBorderColor: =RGBA(238, 235, 76, 1)
                    HoverColor: =RGBA(0, 0, 0, 1)
                    HoverFill: =RGBA(238, 235, 76, 1)
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    OnSelect: |-
                        =Set(PopUpVisible, false);
                        Set(PopUpRejectVisible,false);
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Text: ="Cancelar"
                    Width: =120
                    X: =550
                    Y: =388
                    ZIndex: =2

        MPU_conSign_T As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.None
            Fill: =RGBA(217, 217, 214, 1)
            FillPortions: =0
            Height: =Parent.Height*0.75
            LayoutDirection: =LayoutDirection.Vertical
            LayoutMinHeight: =0
            LayoutMinWidth: =0
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =15
            PaddingRight: =15
            PaddingTop: =15
            Visible: =PopUpSignVisible
            Width: =Parent.Width*0.4
            ZIndex: =4

            MPS_inpSignature_T As inkControl:
                AlignInContainer: =AlignInContainer.Stretch
                BorderColor: =RGBA(136, 139, 141, 1)
                BorderThickness: =1
                FillPortions: =1
                LayoutMinHeight: =0
                LayoutMinWidth: =0
                OnSelect: =Set(SignatureImage, Self.Image)
                ZIndex: =1

            MPS_conApproveBtts_T As groupContainer.horizontalAutoLayoutContainer:
                DropShadow: =DropShadow.None
                FillPortions: =0
                Height: =80
                LayoutGap: =40
                LayoutJustifyContent: =LayoutJustifyContent.Center
                LayoutMinHeight: =0
                LayoutMinWidth: =0
                LayoutMode: =LayoutMode.Auto
                PaddingBottom: =10
                PaddingLeft: =50
                PaddingRight: =50
                PaddingTop: =10
                Visible: =MPR_galNavigation_T.Selected.Value="APROVAÇÕES"
                Width: =Parent.Width
                ZIndex: =2

                MPS_btnAprove_T As button:
                    AlignInContainer: =AlignInContainer.Center
                    BorderColor: =RGBA(239, 223, 0, 1)
                    Color: =RGBA(0, 0, 0, 1)
                    DisplayMode: |
                        =If(MPS_inpSignature_T.Image<>SignatureImage,
                        
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Fill: =RGBA(239, 223, 0, 1)
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Bold
                    Height: =35
                    HoverBorderColor: =RGBA(238, 235, 76, 1)
                    HoverColor: =RGBA(0, 0, 0, 1)
                    HoverFill: =RGBA(238, 235, 76, 1)
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    OnSelect: |-
                        =If(
                            And(
                                MDA_btnShowTable_T.Visible,
                                MDA_btnShowFOP_T.Visible
                            ),
                                Set(ArquivoModificado, "FOP + Tab. Afetação"),
                        
                            MDA_btnShowTable_T.Visible,
                                Set(ArquivoModificado, "Tab. Afetação"),
                        
                            MDA_btnShowFOP_T.Visible,
                                Set(ArquivoModificado, "FOP")
                        );
                        
                        
                        If(MPR_galApprovals_T.Selected.Aprovador.Email=User().Email,
                        
                            Patch(FOPs_MPR_EmValidacao, MPR_galApprovals_T.Selected, 
                                {Data_AssAprovador: Now(),
                                AssAprovador: Substitute(JSON(MPS_inpSignature_T.Image, JSONFormat.IncludeBinaryData),"""","")}
                            );
                            Notify("FOP ASSINADA. Documento enviado para " & MPR_galApprovals_T.Selected.Fabricacao.DisplayName & " para validação.", NotificationType.Success);
                            Set(TipoHistorico, "Aprovação: Aprovador - " & ArquivoModificado);
                            Set(RegistroHistorico, "FOP assinada digitalmente pelo aplicativo"),
                        
                        MPR_galApprovals_T.Selected.Fabricacao.Email=User().Email,
                            
                            Patch(FOPs_MPR_EmValidacao, MPR_galApprovals_T.Selected, 
                                {Data_AssFabricacao: Now(),
                                AssFabricacao: Substitute(JSON(MPS_inpSignature_T.Image, JSONFormat.IncludeBinaryData),"""",""),
                                Data_Mod_FOS: MDA_inpDataMod_T.SelectedDate,
                                Codigo_FOS: MDA_inpCodigoFOS_T.Text}
                            );
                            Notify(ArquivoModificado & " ASSINADA. O Documento será atualizado nos proximos minutos", NotificationType.Success);
                            Set(TipoHistorico, "Aprovação: Fabricação - " & ArquivoModificado);
                            Set(RegistroHistorico,  "FOP assinada digitalmente pelo aplicativo
                                                    " & MDA_inpComentarioFab_T.Text)    
                        );
                        
                        Patch(FOPs_MPR_Historicos, Defaults(FOPs_MPR_Historicos), 
                            {Tipo_Registro: TipoHistorico,
                            Codigo_FOP: MPR_galApprovals_T.Selected.Codigo_FOP,
                            Usina: MPR_galApprovals_T.Selected.Usina,
                            UET: MPR_galApprovals_T.Selected.UET,
                            Posto: MPR_galApprovals_T.Selected.Posto,
                            Projeto: MPR_galApprovals_T.Selected.Projeto,
                            Diversidade: MPR_galApprovals_T.Selected.Diversidade,
                            N_FOP: MPR_galApprovals_T.Selected.N_FOP,
                            Indice_FOP: MPR_galApprovals_T.Selected.Indice_FOP,
                            Registro: RegistroHistorico,
                            Responsavel: {DisplayName: User().FullName,
                                                Claims: "i:0#.f|membership|" & Lower(User().Email),
                                                Department: "",
                                                JobTitle: "",
                                                Picture: User().Image,
                                                Email: User().Email}}
                        );
                        
                        ViewForm(MPR_frmDetails_T);
                        
                        Set(PopUpVisible, false);
                        Set(PopUpSignVisible,false);
                        
                        Reset(MPS_inpSignature_T);
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Text: ="Enviar"
                    Width: =120
                    X: =141
                    Y: =388
                    ZIndex: =1

                MPS_btnNO_T As button:
                    AlignInContainer: =AlignInContainer.Center
                    BorderColor: =RGBA(0, 0, 0, 1)
                    Fill: =RGBA(0, 0, 0, 1)
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Bold
                    Height: =35
                    HoverBorderColor: =RGBA(238, 235, 76, 1)
                    HoverColor: =RGBA(0, 0, 0, 1)
                    HoverFill: =RGBA(238, 235, 76, 1)
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    OnSelect: |-
                        =Set(PopUpVisible, false);
                        Set(PopUpSignVisible,false);
                        
                        Reset(MPS_inpSignature_T);
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Text: ="Cancelar"
                    Width: =120
                    X: =550
                    Y: =388
                    ZIndex: =2

            MPS_conSignBtts_T As groupContainer.horizontalAutoLayoutContainer:
                DropShadow: =DropShadow.None
                FillPortions: =0
                Height: =80
                LayoutAlignItems: =LayoutAlignItems.Center
                LayoutGap: =40
                LayoutJustifyContent: =LayoutJustifyContent.Center
                LayoutMinHeight: =0
                LayoutMinWidth: =0
                LayoutMode: =LayoutMode.Auto
                PaddingBottom: =10
                PaddingLeft: =50
                PaddingRight: =50
                PaddingTop: =10
                Visible: =MPR_galNavigation_T.Selected.Value="NOVA FOP"
                Width: =Parent.Width
                ZIndex: =3

                MPS_btnOK_T As button:
                    BorderColor: =RGBA(0, 0, 0, 1)
                    Fill: =RGBA(0, 0, 0, 1)
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Bold
                    Height: =35
                    HoverBorderColor: =RGBA(238, 235, 76, 1)
                    HoverColor: =RGBA(0, 0, 0, 1)
                    HoverFill: =RGBA(238, 235, 76, 1)
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    OnSelect: |-
                        =Set(PopUpVisible, false);
                        Set(PopUpSignVisible,false);
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Text: ="OK"
                    Width: =80
                    X: =550
                    Y: =388
                    ZIndex: =2

            MPS_conUserSignBtts_T As groupContainer.horizontalAutoLayoutContainer:
                DropShadow: =DropShadow.None
                FillPortions: =0
                Height: =80
                LayoutGap: =40
                LayoutJustifyContent: =LayoutJustifyContent.Center
                LayoutMinHeight: =0
                LayoutMinWidth: =0
                LayoutMode: =LayoutMode.Auto
                PaddingBottom: =10
                PaddingLeft: =50
                PaddingRight: =50
                PaddingTop: =10
                Visible: =MPR_galNavigation_T.Selected.Value="ASSINATURA"
                Width: =Parent.Width
                ZIndex: =4

                MPS_btnRegister_T As button:
                    AlignInContainer: =AlignInContainer.Center
                    BorderColor: =RGBA(239, 223, 0, 1)
                    Color: =RGBA(0, 0, 0, 1)
                    DisplayMode: |
                        =If(MPS_inpSignature_T.Image<>SignatureImage,
                        
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Fill: =RGBA(239, 223, 0, 1)
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Bold
                    Height: =35
                    HoverBorderColor: =RGBA(238, 235, 76, 1)
                    HoverColor: =RGBA(0, 0, 0, 1)
                    HoverFill: =RGBA(238, 235, 76, 1)
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    OnSelect: |
                        =Patch(Assinaturas_Usuarios, Defaults(Assinaturas_Usuarios),
                            {Assinatura: Substitute(JSON(MPS_inpSignature_T.Image, JSONFormat.IncludeBinaryData),"""",""),
                            Usuario: {DisplayName: User().FullName,
                                        Claims: "i:0#.f|membership|" & Lower(User().Email),
                                        Department: "",
                                        JobTitle: "",
                                        Picture: User().Image,
                                        Email: User().Email}
                            }
                        );
                        
                        Set(UserAssinatura, Substitute(JSON(MPS_inpSignature_T.Image, JSONFormat.IncludeBinaryData),"""",""));
                        Set(AssinaturaCadastrada, true);
                        
                        Set(PopUpVisible, false);
                        Set(PopUpSignVisible,false);
                        
                        Reset(MPS_inpSignature_T);
                        
                        Notify("ASSINATURA CADASTRADA COM SUCESSO",NotificationType.Success);
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Text: ="Cadastrar"
                    Width: =120
                    X: =141
                    Y: =388
                    ZIndex: =1

                MPS_btnCancel_T As button:
                    AlignInContainer: =AlignInContainer.Center
                    BorderColor: =RGBA(0, 0, 0, 1)
                    Fill: =RGBA(0, 0, 0, 1)
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Bold
                    Height: =35
                    HoverBorderColor: =RGBA(238, 235, 76, 1)
                    HoverColor: =RGBA(0, 0, 0, 1)
                    HoverFill: =RGBA(238, 235, 76, 1)
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    OnSelect: |-
                        =Set(PopUpVisible, false);
                        Set(PopUpSignVisible,false);
                        
                        Reset(MPS_inpSignature_T);
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Text: ="Cancelar"
                    Width: =120
                    X: =550
                    Y: =388
                    ZIndex: =2

        FOP_ModifyFOPCont_1 As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.None
            FillPortions: =0
            Height: =Parent.Height*0.5
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutDirection: =LayoutDirection.Vertical
            LayoutJustifyContent: =LayoutJustifyContent.Center
            LayoutMinHeight: =0
            LayoutMinWidth: =0
            LayoutMode: =LayoutMode.Auto
            Visible: =PopUpModifyFOPVisible
            Width: =Parent.Width*0.7
            ZIndex: =5

            MFPU_ModifyFOP_Lbl_1 As label:
                Align: =Align.Center
                AlignInContainer: =AlignInContainer.Stretch
                AutoHeight: =true
                Color: =RGBA(0, 0, 0, 1)
                DisabledColor: =RGBA(0, 0, 0, 1)
                DisplayMode: =Parent.DisplayMode
                FillPortions: =1
                Font: =Font.Arial
                Height: =Parent.Height*0.8
                LayoutMinWidth: =0
                Size: =11
                Text: ="Delete a FOP errada e carregue uma nova FOP em Formato PDF."
                Width: =110
                Wrap: =false
                X: =2
                Y: =20
                ZIndex: =1

            FOP_ModifyFOP_Forms_1 As form:
                AlignInContainer: =AlignInContainer.SetByContainer
                DataSource: =FOPs_SommaireContents_EmValidacao
                FillPortions: =4
                Height: =252
                Item: |
                    =FOP_ApprovalsPE.Selected
                LayoutMinHeight: =0
                LayoutMinWidth: =0
                Width: =436
                X: =465
                Y: =136
                ZIndex: =2

                MFPU_AnexosCard_1 As typedDataCard.attachmentsEditCard:
                    BorderColor: =RGBA(136, 139, 141, 1)
                    BorderStyle: =BorderStyle.Solid
                    DataField: ="{Attachments}"
                    Default: =ThisItem.Anexos
                    DisplayMode: =Parent.DisplayMode
                    DisplayName: =DataSourceInfo([@FOPs_SommaireContents_EmValidacao],DataSourceInfo.DisplayName,Anexos)
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =Parent.Height
                    Required: =false
                    Update: =MFPU_Anexos_1.Attachments
                    Width: =Parent.Width
                    X: =0
                    Y: =0
                    ZIndex: =48

                    MFPU_Anexos_1 As attachments:
                        BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                        BorderThickness: =1
                        DisplayMode: =Parent.DisplayMode
                        Fill: =RGBA(0, 0, 0, 0)
                        Font: =Font.Arial
                        Height: =Parent.Height*0.9
                        HoverFill: =RGBA(187, 188, 188, 1)
                        IsInDataCard: =true
                        Items: =Parent.Default
                        MaxAttachments: =2
                        MaxAttachmentSize: =50
                        OnRemoveFile: =Clear(FOP_ApprovalsPE.Selected.Anexos)
                        PaddingBottom: =5
                        PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                        PaddingRight: =5
                        PaddingTop: =5
                        PressedColor: =RGBA(0, 0, 0, 1)
                        PressedFill: =RGBA(0, 0, 0, 0)
                        Reset: =true
                        Size: =12
                        Tooltip: =Parent.DisplayName
                        Width: =Parent.Width - Self.X*2
                        X: =15
                        Y: =1
                        ZIndex: =2

            FOP_ModifyFOPBtns_1 As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                DropShadow: =DropShadow.None
                LayoutAlignItems: =LayoutAlignItems.Center
                LayoutGap: =40
                LayoutJustifyContent: =LayoutJustifyContent.Center
                LayoutMinHeight: =0
                LayoutMinWidth: =0
                LayoutMode: =LayoutMode.Auto
                PaddingBottom: =10
                PaddingLeft: =50
                PaddingRight: =50
                PaddingTop: =10
                Width: =Parent.Width
                ZIndex: =3

                FOP_MFPU_OKButton_1 As button:
                    BorderColor: =RGBA(239, 223, 0, 1)
                    Color: =RGBA(0, 0, 0, 1)
                    DisplayMode: |-
                        =//Verifica-se que a quantidade de arquivos (itens) do controle do formulário só tenha um unico arquivo
                        If(CountRows(MFPU_Anexos_1.Attachments)=1,
                        
                            DisplayMode.Edit,
                        
                            //Caso não tenha nenhum ou mais de um, fica desabilitado
                            DisplayMode.Disabled
                        )
                    Fill: =RGBA(239, 223, 0, 1)
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Bold
                    HoverBorderColor: =RGBA(238, 235, 76, 1)
                    HoverColor: =RGBA(0, 0, 0, 1)
                    HoverFill: =RGBA(238, 235, 76, 1)
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    OnSelect: |+
                        =SubmitForm(FOP_ModifyFOP_Forms_1);
                        
                        Notify("FOP Trocada com sucesso.", NotificationType.Success);
                        
                        Set(PopUpVisible,false);   //<--Deixa de mostrar o PopUp
                        Set(PopUpModifyFOPVisible, false); //<--Deixa de mostrar o container de modificação de FOP
                        
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Text: ="Enviar"
                    Width: =FOP_PE_CancelButton_1.Width
                    X: =141
                    Y: =388
                    ZIndex: =1

                FOP_MFPU_NOButton_1 As button:
                    BorderColor: =RGBA(0, 0, 0, 1)
                    Fill: =RGBA(0, 0, 0, 1)
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Bold
                    HoverBorderColor: =RGBA(238, 235, 76, 1)
                    HoverColor: =RGBA(0, 0, 0, 1)
                    HoverFill: =RGBA(238, 235, 76, 1)
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    OnSelect: |-
                        =Set(PopUpVisible, false);
                        Set(PopUpModifyFOPVisible,false);
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Text: ="Cancelar"
                    Width: =FOP_PE_CancelButton_1.Width
                    X: =550
                    Y: =388
                    ZIndex: =2

    conNavigation_FOPType_4 As groupContainer.horizontalAutoLayoutContainer:
        Fill: =RGBA(0, 0, 0, 0.38)
        Height: =App.Height - 60
        LayoutAlignItems: =LayoutAlignItems.Center
        LayoutGap: =100
        LayoutJustifyContent: =LayoutJustifyContent.Center
        LayoutMode: =LayoutMode.Auto
        PaddingBottom: =60
        PaddingLeft: =60
        PaddingRight: =60
        PaddingTop: =60
        Visible: =FOPTypeNavigation
        Width: =App.Width
        Y: =60
        ZIndex: =6

        conBtn_FOPVidaSerie_4 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.ExtraBold
            Fill: =RGBA(242, 242, 242, 1)
            FillPortions: =0
            Height: =170
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            RadiusBottomLeft: =30
            RadiusBottomRight: =30
            RadiusTopLeft: =30
            RadiusTopRight: =30
            Width: =170
            ZIndex: =1

            lblBtnVidaSerie_5 As label:
                Align: =Align.Center
                Font: ="NouvelR, Arial"
                FontWeight: =FontWeight.Bold
                OnSelect: |-
                    =Navigate(CPE_FOPs, ScreenTransition.Fade);
                    Set(FOPTypeNavigation, false);
                Size: =15
                Text: ="Vida Série"
                Width: =Parent.Width
                Y: =Parent.Height - Self.Height
                ZIndex: =1

            ImgVidaSerie_10 As image:
                Height: =Parent.Height - lblBtnVidaSerie_5.Height
                Image: |
                    ="data:image/svg+xml;utf8, "&
                    EncodeUrl(
                    "
                    <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 60 60'><defs><style>.cls-1{fill:#1d1d1b;}</style></defs><g id='Picto'><path class='cls-1' d='M39.8,41.12h-18v2.36a1.64,1.64,0,0,1-1.63,1.58H15.36a1.55,1.55,0,0,1-1.53-1.58V32.77a6.21,6.21,0,0,1,2.45-4.85l-2.55-1.1V25.14h3.8c1.34-3.6,2.59-5.91,5.47-5.91H38.6c2.88,0,4.13,2.31,5.47,5.91h3.79v1.68l-2.54,1.1a6.24,6.24,0,0,1,2.45,4.85V43.48a1.56,1.56,0,0,1-1.54,1.58h-4.8a1.64,1.64,0,0,1-1.63-1.58Zm3.84-11.95H18a5.37,5.37,0,0,0-2.16,3.6V43.14h4V39.2H41.77v3.94h4V32.77A5.37,5.37,0,0,0,43.64,29.17Zm-21.79,7.3c-2.6-.72-4-1.25-4-3.22V31.14h5.91v1.73H19.49v.19c0,.62,0,.91,2.36,1.63ZM38.31,21.15h-15c-2.26,0-3.17,2-4.32,6.15H42.63C41.48,23.12,40.57,21.15,38.31,21.15Zm-6.82,10,1.11,2.11-1.11,1.92H30l-1.11-1.92L30,31.14ZM42.1,33.06v-.19H37.88V31.14h5.9v2.11c0,2-1.44,2.5-4,3.22V34.69C42.1,34,42.1,33.68,42.1,33.06Z'/></g></svg>
                    ")
                OnSelect: |-
                    =Navigate(CPE_FOPs, ScreenTransition.Fade);
                    Set(FOPTypeNavigation, false);
                Width: =Parent.Width
                ZIndex: =2

        conBtn_FOPMPR_4 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.ExtraBold
            Fill: =RGBA(242, 242, 242, 1)
            FillPortions: =0
            Height: =170
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            RadiusBottomLeft: =30
            RadiusBottomRight: =30
            RadiusTopLeft: =30
            RadiusTopRight: =30
            Width: =170
            ZIndex: =2

            lblBtnMPR_5 As label:
                Align: =Align.Center
                Font: ="NouvelR, Arial"
                FontWeight: =FontWeight.Bold
                OnSelect: =Set(FOPTypeNavigation, false);
                Size: =15
                Text: ="MPR"
                Width: =Parent.Width
                Y: =Parent.Height - Self.Height
                ZIndex: =1

            ImgMPR_5 As image:
                Height: =Parent.Height - lblBtnMPR_5.Height
                Image: |
                    ="data:image/svg+xml;utf8, "&
                    EncodeUrl(
                    "
                    <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 60 60'><defs><style>.cls-1{fill:#1d1d1b;}</style></defs><g id='Picto'><path class='cls-1' d='M9.8,13.23c3.56,0,4.85.63,6.29,2.64l.92,1.3-1.64,1.15-1-1.53c-.77-1.2-1.73-1.64-4.57-1.64Zm33.37,14.5-4-.86c-1.3-.29-3-2.31-6-3.46a24.45,24.45,0,0,0-7.92-1.06,57.69,57.69,0,0,0-6.81.48l-2.16-1.1-.05-.58a90.07,90.07,0,0,1,9.55-.76,24.52,24.52,0,0,1,8.26,1.24c2.69,1,4.8,3.12,5.52,3.27l4,.91c1.54.34,2.5.86,3,1.82a10.44,10.44,0,0,1,1.2,4.57c0,2.06-1.39,3-3.55,3h-2.4V33.49a2.16,2.16,0,1,0-4.32,0v1.73H22.09V33.49a2.16,2.16,0,1,0-4.32,0v1.68H16.48c-2.26-.24-4.61-1.53-4.61-4.37V28.12c0-1.3.53-2,3.31-4.81l1.73,1c-2.59,2.64-3.07,3.08-3.07,4.18V30.8a2.11,2.11,0,0,0,2,2.16,4.12,4.12,0,0,1,8.21.29H35.58a4.23,4.23,0,0,1,4.13-4,4.16,4.16,0,0,1,4.13,4h.34c1.44,0,1.68-.29,1.68-1.25a6.78,6.78,0,0,0-.92-3.31C44.61,28.21,44.27,28,43.17,27.73ZM24.06,41.46a4.13,4.13,0,1,1-8.25,0,4.13,4.13,0,1,1,8.25,0Zm-2,0a2.16,2.16,0,1,0-4.32,0,2.16,2.16,0,1,0,4.32,0Zm21.75,0a4.13,4.13,0,1,1-8.26,0,4.13,4.13,0,1,1,8.26,0Zm-2,0a2.16,2.16,0,1,0-4.32,0,2.16,2.16,0,1,0,4.32,0Zm1.59-25.78c1.39-1.68,2.83-2.45,4.22-2.45a4.65,4.65,0,0,1,2.26.53l-.72,1.78a4.25,4.25,0,0,0-1.4-.34c-1,0-1.68.29-3.21,2.11L41.1,21.54l-1.44-1.3Z'/></g></svg>
                    ")
                OnSelect: =Set(FOPTypeNavigation, false);
                Width: =Parent.Width
                ZIndex: =2

        conBtn_FOPPecaPadrao_4 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.ExtraBold
            Fill: =RGBA(242, 242, 242, 1)
            FillPortions: =0
            Height: =170
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            RadiusBottomLeft: =30
            RadiusBottomRight: =30
            RadiusTopLeft: =30
            RadiusTopRight: =30
            Width: =170
            ZIndex: =3

            lblBtnPecaPadrao_5 As label:
                Align: =Align.Center
                Font: ="NouvelR, Arial"
                FontWeight: =FontWeight.Bold
                OnSelect: |-
                    =Notify("EM DESENVOLVIMENTO", NotificationType.Information)
                    //Navigate(FOPs_PecaPadrao; ScreenTransition.Fade);;
                    //Set(FOPTypeNavigation; false);;
                Size: =15
                Text: ="Peça Padrão"
                Width: =Parent.Width
                Y: =Parent.Height - Self.Height
                ZIndex: =1

            ImgVidaSerie_11 As image:
                Height: =Parent.Height - lblBtnPecaPadrao_5.Height
                Image: |
                    ="data:image/svg+xml;utf8, "&
                    EncodeUrl(
                    "
                    <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 60 60'><defs><style>.cls-1{fill:#1d1d1b;}</style></defs><g id='Picto'><path class='cls-1' d='M17.05,33.16l-1.2-6V19.57c0-1.58.68-2.35,2.07-2.35H41.73c1.39,0,2.06.77,2.06,2.35v7.54l1.44,3.65A7.48,7.48,0,0,1,45.81,33a27.6,27.6,0,0,1-.72,4.12l-1.2,5.67c-.34,1.58-.67,2.35-2.07,2.35H17.92c-1.39,0-2.64-.82-2.07-2.35L17,39.64a9.86,9.86,0,0,0,.76-2.55A31.82,31.82,0,0,0,17.05,33.16Zm.77-14v6.05h24V19.14Zm24,24.1,2.12-10.08c-8.26,1.34-13.78,3-24.68,6.24l-1.44,3.84ZM20,37.29a156.75,156.75,0,0,1,23.28-5.91l-1.58-4.27H18Zm-.33-15.13a1.2,1.2,0,1,1,2.4,0,1.2,1.2,0,1,1-2.4,0Zm17.85,0a1.2,1.2,0,1,1,2.4,0,1.2,1.2,0,1,1-2.4,0Z'/></g></svg>
                    ")
                OnSelect: |-
                    =Notify("EM DESENVOLVIMENTO", NotificationType.Information)
                    //Navigate(FOPs_PecaPadrao; ScreenTransition.Fade);;
                    //Set(FOPTypeNavigation; false);;
                Width: =Parent.Width
                ZIndex: =2

    CPE_FAQCont_4 As groupContainer.horizontalAutoLayoutContainer:
        Fill: =RGBA(0, 0, 0, 0.38)
        Height: =App.Height - 60
        LayoutGap: =60
        LayoutMode: =LayoutMode.Auto
        PaddingBottom: =60
        PaddingLeft: =60
        PaddingRight: =60
        PaddingTop: =60
        Visible: =FAQVisible
        Width: =App.Width
        Y: =60
        ZIndex: =7

        CPE_FAQInfos_Cont_4 As groupContainer.verticalAutoLayoutContainer:
            DropShadow: =DropShadow.None
            Fill: =RGBA(217, 217, 214, 1)
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGap: =5
            LayoutMinHeight: =0
            LayoutMinWidth: =0
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =15
            PaddingRight: =15
            PaddingTop: =15
            ZIndex: =1

            CPE_UserManual_Lbl_4 As label:
                AlignInContainer: =AlignInContainer.Stretch
                Font: =Font.Arial
                FontWeight: =FontWeight.Bold
                Height: =30
                LayoutMinHeight: =30
                LayoutMinWidth: =0
                Size: =14
                Text: ="Manuais de Usuário"
                ZIndex: =1

            CPE_ENGUserCont_4 As groupContainer.horizontalAutoLayoutContainer:
                DropShadow: =DropShadow.None
                FillPortions: =0
                Height: =30
                LayoutMinHeight: =0
                LayoutMinWidth: =0
                LayoutMode: =LayoutMode.Auto
                ZIndex: =2

                CPE_ENGUser_Icn_4 As icon.Phonebook:
                    AlignInContainer: =AlignInContainer.Start
                    Color: =RGBA(0, 0, 0, 1)
                    Height: =30
                    Icon: =Icon.Journal
                    LayoutMinHeight: =0
                    LayoutMinWidth: =40
                    Width: =30
                    ZIndex: =1

                CPE_ENGManual_Link_4 As htmlViewer:
                    AlignInContainer: =AlignInContainer.Start
                    FillPortions: =1
                    Font: =Font.Arial
                    Height: =30
                    HtmlText: |-
                        ="<font color='" & "blue" &"'><a href='https://grouperenault.sharepoint.com/sites/ProjetosDigital/Shared%20Documents/01%20-%20Projetos/00%20-%20Simplifica%C3%A7%C3%A3o%20e%20Digitaliza%C3%A7%C3%A3o/07%20-%20FOP%C2%B4S%20digitais/03%20-%20Documentation/00%20-%20User/MANUAL%20FOPS%20DIGITAIS%20Engenharia.pdf'> MANUAL DE USUÁRIO ENGENHARIA </a></font>"
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    ZIndex: =2

            CPE_FABUserCont_4 As groupContainer.horizontalAutoLayoutContainer:
                DropShadow: =DropShadow.None
                FillPortions: =0
                Height: =30
                LayoutMinHeight: =0
                LayoutMinWidth: =0
                LayoutMode: =LayoutMode.Auto
                ZIndex: =3

                CPE_FABUser_Icn_4 As icon.Phonebook:
                    AlignInContainer: =AlignInContainer.Start
                    Color: =RGBA(0, 0, 0, 1)
                    Height: =30
                    Icon: =Icon.Journal
                    LayoutMinHeight: =0
                    LayoutMinWidth: =40
                    Width: =30
                    ZIndex: =1

                CPE_FABManual_Link_4 As htmlViewer:
                    AlignInContainer: =AlignInContainer.Start
                    FillPortions: =1
                    Font: =Font.Arial
                    Height: =30
                    HtmlText: |-
                        ="<font color='blue'><a href='" & "https://grouperenault.sharepoint.com/sites/ProjetosDigital/Shared%20Documents/01%20-%20Projetos/00%20-%20Simplifica%C3%A7%C3%A3o%20e%20Digitaliza%C3%A7%C3%A3o/07%20-%20FOP%C2%B4S%20digitais/03%20-%20Documentation/00%20-%20User/MANUAL%20FOPS%20DIGITAIS%20Fabrica%C3%A7%C3%A3o.pdf?CT=1699628841776&OR=ItemsView" & "'> MANUAL DE USUÁRIO FABRICAÇÃO </a></font>"
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    ZIndex: =2

            CPE_FAQ_Lbl_4 As label:
                AlignInContainer: =AlignInContainer.Stretch
                Font: =Font.Arial
                FontWeight: =FontWeight.Bold
                Height: =50
                LayoutMinHeight: =30
                LayoutMinWidth: =0
                Size: =14
                Text: ="Perguntas Frequentes"
                ZIndex: =4

            CPE_FAQInfos_HTML_4 As htmlViewer:
                AlignInContainer: =AlignInContainer.Stretch
                FillPortions: =10
                Font: =Font.Arial
                HtmlText: |-
                    ="<b>1. Ao confirmar o Indice APW atualiza o indice automaticamente no ProAPW? (SOMENTE ENGENHARIA)<br></b>
                    <br>
                    Não, o modo de atualização de índice de FOP dentro do ProAPW segue sendo o mesmo. Este botão é usado para informar ao fabricante que ele já pode criar a FOS com o novo índice da FOP.<br>
                    <br>
                    <br>
                    <b>2. Uma FOP precisa de algum tipo de alteração (Conteúdo, Índice, entre outros).<br></b>
                    <br>
                    Você deve entrar em contato com o responsável da engenharia pela área ou abrir uma solicitação no app <font color='blue'><b><a href='" & "https://apps.powerapps.com/play/e/default-d6b0bbee-7cd9-4d60-bce6-4a67b543e2ae/a/90e5bc0b-9a4c-497d-8dc6-8bf06cbdd9fb?tenantId=d6b0bbee-7cd9-4d60-bce6-4a67b543e2ae&source=portal&skipmetadata=true&hidenavbar=true" & "'> DEMANDAS DA ENGENHARIA</a></b></font>. O Time de Digital PE <b><font color='red'>NÃO</font></b> é responsável pelo conteúdo ou problemas relacionados à FOP em si, somente é responsável pelo correto funcionamento do aplicativo.<br>
                    <br>
                    <br>
                    <b>3. Existe um erro de funcionamento do aplicativo e quero reportá-lo.<br></b>
                    <br>
                    Você pode acessar a aba <b>SUPORTE</b>, e abrir uma nova solicitação para o App '<b>Central PE</b>'."
                LayoutMinHeight: =0
                LayoutMinWidth: =0
                Size: =10
                ZIndex: =5

        CPE_Versions_Cont_4 As groupContainer.verticalAutoLayoutContainer:
            DropShadow: =DropShadow.None
            Fill: =RGBA(217, 217, 214, 1)
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGap: =5
            LayoutMinHeight: =0
            LayoutMinWidth: =0
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =15
            PaddingRight: =15
            PaddingTop: =15
            ZIndex: =2

            CPE_VersionsLabel_4 As label:
                AlignInContainer: =AlignInContainer.Stretch
                Font: =Font.Arial
                FontWeight: =FontWeight.Bold
                Height: =30
                LayoutMinHeight: =30
                LayoutMinWidth: =0
                Size: =14
                Text: ="Histórico de Versões"
                ZIndex: =1

            CPE_VersionInfos_HTML_4 As htmlViewer:
                AlignInContainer: =AlignInContainer.Stretch
                FillPortions: =10
                Font: =Font.Arial
                HtmlText: |-
                    ="<font color='green'><b>1.3.00 - Inserção de Telas FOP MPR | 23 / fev /2024</b></font><br>
                    <br>
                    Foi inserida uma nova aba de <em><b>FOPs MPR</b></em> para o eliminar o papel destes documentos na Fábrica Carroceria.<br>
                    <br>
                    As funcionalidades presentes neste modulo são similares ao Modulo de <em>FOPs Vida Série</em>:<br>
                    <ul>
                    <li>Visualição de FOP MPR pela aba inicial MPR.</li>
                    <li>Substituição da Navette por uma Digital.</li>
                    <li>Controle por meio do Histórico</li>
                    </ul>
                    <br>
                    <font color='red'><b>OBS:</b></font> As FOPs serão carregadas conforme planejamento de migração.<br>
                    <br>
                    Para mais informações sobre as funcionalidades do aplicativo consultar o <b>MANUAL DE USUÁRIO</b>.<br>
                    <br>
                    <br>
                    <font color='green'><b>1.2.05 - Mudança de SharePoint | 02 / fev /2024</b></font><br>
                    <ul>
                    <li>Migração de bases de dados de <b><em>FOPs Digitais Carroceria</b></em> para <b><em>FOPs Vida Serie</em></b>.</li>
                    <li>Correção de bug visual na hora de abrir a <b><em>Tabela de Afetação</b></em>.</li>
                    </ul>
                    <br>
                    <font color='green'><b>1.2.04 - Diferenciação entre postos Manuais e Robotizados | 31 / jan /2024</b></font><br>
                    <ul>
                    <li>Modificado lista interna de postos para manuais e robotizados para evitar conflitos com FOS e confirmações.</li>
                    <li>Adição desta condição nos Fluxos de Notificações e Alertas.</li>
                    </ul>
                    <br>
                    <font color='green'><b>1.2.03 - Sequência de confirmações | 30 / jan /2024</b></font><br>
                    <ul>
                    <li>Agora as confirmações só poderão ser feitas seguindo a ordem respectiva <b>obrigatoriamente</b>, quer dizer, só pode ser confirmada a criação da FOS <font color='red'><b>APÓS</b></font> ter sido confirmada a atualização da FOP no ProAPW.<br> Também, só podera ser confirmada a validação da FOS, <font color='red'><b>APÓS</b></font> ter sido confirmada a criação da FOS.</li>
                    <br>
                    <li>Adicionados graficos de <em><b>FOPs POR UET</b></em> e <em><b>FOPs POR PROJETO</b></em> no Dashboard.<br>
                    Corrigido erro visual que mostrava pessoas que já validaram no grafico de <em><b>VALIDAÇÕES PENDENTES</b></em>.</li>
                    </ul>
                    <br>
                    <font color='green'><b>1.2.02 - Dashboard e Novos Alertas | 18 / jan /2024</b></font><br>
                    <br>
                    <b>Dashboard:</b><br>
                    <ul>
                    <li>Nova tela de acompanhamento de indicadores e status das FOPs Vida Serie.</li>
                    <li>Para mais informações consultar <b>Time Digital PE Carroceria.</b></li>
                    </ul>
                    <br>
                    <b>Alertas:</b><br>
                    <ul>
                    <li>Cada dia é enviado um lembrete para realizar a validação de uma FOP.</li>
                    <li>Após a FOS ter sido evoluida, é enviado um alerta diario para o Preparador da FOP vinculada a FOS para verificar conformidade entre FOS e FOP.</li>
                    </ul>
                    <br>
                    
                    <font color='green'><b>1.2.01 - Melhoria de Desempenho | 22 / dez /2023</b></font><br>
                    <ul>
                    <li>Carregamento de Tabela de afetação.</li>
                    <li>Lista interna para Navette.</li>
                    <li>Procura de Históricos.</li>
                    </ul>
                    <br>
                    <font color='green'><b>1.2.00 - Inserção de Tab. Afetação | 21 / dez /2023</b></font><br>
                    <br>
                    Foi inserida a possibilidade de adicionar a <b>Tabela de Afetação</b> junto com uma FOP para os Projetos nascidos no <b>ProAPW</b> (XJD, XJF e X1312). A visualização da mesma é feita pela consulta da visualização da FOP.<br>
                    <br>
                    <font color='red'><b>OBS:</b></font> As Tabelas de Afetação serão carregadas conforme solicitação de Fabrica por meio do app <font color='blue'><b><a href='" & "https://apps.powerapps.com/play/e/default-d6b0bbee-7cd9-4d60-bce6-4a67b543e2ae/a/90e5bc0b-9a4c-497d-8dc6-8bf06cbdd9fb?tenantId=d6b0bbee-7cd9-4d60-bce6-4a67b543e2ae&source=portal&skipmetadata=true&hidenavbar=true" & "'> DEMANDAS DA ENGENHARIA</a></b></font>.<br>
                    <br>
                    Também, foram corrigidos os seguintes erros:
                    <ul>
                    <li>Falha no carregamento de Históricos para Centros de Custo especifico.</li>
                    <li>Postos sem FOPs atribuídas foram deletados.</li>
                    <li>Indices de Navette organizados conforme Índice e Data de criação</li>
                    <li>Problemas de delegação com conexões resolvidos</li>
                    </ul>
                    <br>
                    <font color='green'><b>1.1.11 - Extração de FOP | 08 / dez /2023</b></font><br>
                    <ul>
                    <li>Modificado fluxo de extração de Navette, agora é possível extrair a FOP junto com a Navette. <b>(SOMENTE ENGANHARIA)</b></li>
                    <li>Correção no carregamento de FOP como NOUVELLE quando já existe dentro do perimetro do app. <b>(SOMENTE ENGANHARIA)</b></li>
                    <li>Criada coleção interna para suportar melhor carregamento de navegação de FOPs</li>
                    <li>Correção erro de visualização de Navette.</li>
                    </ul>
                    <br>
                    <font color='green'><b>1.1.10 - Aumentado limite de base de dados sem delegação | 06 / dez /2023</b></font><br>
                    <br>
                    Foi aumentado ao maximo (2000) de linhas que são contabilizadas em formulas que não tem suporte de delegação com conexões de servidor.<br>
                    <br>
                    <br>
                    <font color='green'><b>1.1.09 - Modificada a Navegação de FOPs | 04 / dez /2023</b></font><br>
                    <br>
                    Modificação de cascata de Procura de FOP para cumprir exeções para a UET PRP (CVP) e Usina CVU. As cascatas de procura são as seguintes:<br>
                    <ul>
                    <li><em><b>Cascata Padrão</em></b><br>
                    Usina ⇒ UET ⇒ Posto ⇒ Diversidade.<br></li>
                    <br>
                    <li><em><b>Para CVP - UET: PRP e PK2</em></b><br>
                    Usina ⇒ UET ⇒ <font color='red'><b>Diversidade</b></font> ⇒ Posto.<br></li>
                    <br>
                    <li><em><b>Para CVU</em></b><br>
                    Usina ⇒ <font color='red'><b>Diversidade</b></font> ⇒ <font color='red'><b>UET</b></font> ⇒ Posto.<br></li>
                    </ul>
                    <br>
                    <br>
                    <font color='green'><b>1.1.08 - Alteração de FOP | 21 / nov /2023</b></font><br>
                    <br>
                    Adicionada a possibilidade de trocar Arquivo PDF para o Preparador da FOP antes de ser aprovada.
                    Isto é feito pela aba <b>FERRAMENTAS</b> ⇒ <b>APROVAÇÕES</b> ⇒ <b>Detalhes da FOP</b> ⇒ Botão <em><b>Alterar FOP</b></em>.<br>
                    <br>
                    <br>
                    <font color='green'><b>1.1.07 - Controle de versão para Usuário | 15 / nov /2023</b></font><br>
                    <ul>
                    <li>Bloqueio de tela quando o usuário está com versão antiga do aplicativo.</li>
                    <li>Modificações visuais na barra de navegação principal.</li>
                    </ul>
                    <br>
                    <br>
                    <font color='green'><b>1.1.06 - Acessibilidade de Usuário | 10 / nov /2023</b></font><br>
                    <br>
                    <b>Novas funcionalidades:</b><br>
                    <ul>
                    <li>Novo Menu na aba <b>FERRAMENTAS</b> ⇒ CONFIRMAÇÕES. Aqui ficarão as FOPs pendentes para confirmação de ações após uma nova FOP ser carregada no aplicativo.</li><br>
                    <li>Os Botões <em>Indice APW</em>, <em>FOS Criada</em> e <em>FOS validada</em>, foram movidos para o menu CONFIRMAÇÕES. Eles não ficarão mais no menu <font color='red'><b>HISTÓRICOS.</b></font></li><br>
                    <li>Para o Aprovador de uma FOP, ela não é mais mostrada, no menu de APROVAÇÕES, após ser aprovada.</li><br>
                    <li>Adição de campo de busca na navegação de <b>Postos</b>.</li><br>
                    <li>Inclusão de histórico de versões e Perguntas Frequentes.</li>
                    </ul>
                    <br>
                    <br>
                    <font color='green'><b>1.1.0 - Extração de Navette e correção de erros |  23 / out / 2023</b></font><br>
                    <br>
                    <b>Novas funcionalidades para FABRICAÇÃO:</b><br>
                    <br>
                    <em>Pela Aba Ferramentas > Históricos > FOP Respectiva</em><br>
                    <ul>
                    <li>Botão 'FOS Criada' para informar à Engenharia da criação da FOS.</li>
                    </ul>
                    <br>
                    <b>Novas funcionalidades para ENGENHARIA:</b><br>
                    <br>
                    <em>Pela Aba de Visualização da FOP</em><br>
                    <ul>
                    <li>Extração de Navette pelo Ícone PDF.</li>
                    <li>Modificação de FOP direta pelo Ícone 'Modificar FOP'.</li>
                    </ul>
                    <em>Pela Aba Ferramentas > Históricos > FOP Respectiva</em><br>
                    <ul>
                    <li>Botão 'Indice APW' para informar ao Fabricante que a FOP foi atualizada no ProAPW.</li>
                    <li>Botão FOS Validada para confirmar que a FOS está em conformidade com a FOP.</li>
                    </ul>
                    <br>
                    <b>Erros Corrigidos:</b><br>
                    <ul>
                    <li>Falha no carregamento de assinatura quando aprovar uma nova FOP.</li>
                    <li>Carregamento de FOPs e aplicativo demorado.</li>
                    </ul>
                    <br>
                    <br>
                    <font color='green'><b>1.0 - Lançamento de aplicativo | 09 / out / 2023</b></font><br>
                    <br>
                    O objetivo deste aplicativo é eliminar o papel na Fábrica Carroceria, o aplicativo tem como intuito ser um complemento do ProAPW, dentre as funcionalidades estão: <br>
                    
                    <ul>
                    <li>Visualização de FOP pelo último índice.</li>
                    <li>Controle de histórico das ações aplicadas as FOPs.</li>
                    <li>Digitalização de Ficha Navette.</li>
                    </ul>
                    Para mais informações sobre as funcionalidades do aplicativo consultar o <b>MANUAL DE USUÁRIO</b>."
                LayoutMinHeight: =0
                LayoutMinWidth: =0
                Size: =10
                ZIndex: =4

    FOPs_PUVersaoDeastualizada_4 As groupContainer.verticalAutoLayoutContainer:
        DropShadow: =DropShadow.None
        Fill: =RGBA(0, 0, 0, 0.34)
        Height: =App.Height
        LayoutAlignItems: =LayoutAlignItems.Center
        LayoutDirection: =LayoutDirection.Vertical
        LayoutJustifyContent: =LayoutJustifyContent.Center
        LayoutMode: =LayoutMode.Auto
        Visible: |-
            =VersaoAtual
            //true
        Width: =App.Width
        ZIndex: =8

        FOPs_PVD_InfoCont_4 As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.ExtraBold
            Fill: =RGBA(217, 217, 214, 1)
            FillPortions: =0
            Height: =Parent.Height*0.6
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGap: =10
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =20
            PaddingRight: =20
            Width: =Parent.Width*0.3
            ZIndex: =1

            Image3_5 As image:
                AlignInContainer: =AlignInContainer.Center
                Height: =140
                Image: ='Design sem nome (15)'
                LayoutMinHeight: =0
                Width: =180
                ZIndex: =1

            HtmlText1_5 As htmlViewer:
                AlignInContainer: =AlignInContainer.Stretch
                FillPortions: =1
                Font: =Font.Arial
                HtmlText: |
                    ="<div style='text-align: center;'>
                    Existe uma nova versão disponível, por favor recarregue a página ou feche o aplicativo e abra novamente.<br>
                    <br>
                    Clique no botão <b>Atualizar</b> no <font color='red'><b>canto superior esquerdo</b></font>, abaixo segue um <b>exemplo</b> da mensagem e botão que você deve clicar.
                    </div>"
                LayoutMinWidth: =0
                Size: =14
                ZIndex: =3

            Image4_5 As image:
                AlignInContainer: =AlignInContainer.Stretch
                Height: =50
                Image: ='Design sem nome (17)'
                LayoutMinWidth: =0
                ZIndex: =4

