Fault_Report As screen:
    OnVisible: |-
        =Set(
            VisibleScreen,
            Text(App.ActiveScreen.Name)
        );
        If(
            !Btn_Report_Click,
            Set(
                UsinaGalleryVisible,
                true
            );
            Set(
                ProjectGalleryVisible,
                false
            );
            Set(
                UETGalleryVisible,
                false
            );
            Set(
                PostoGalleryVisible,
                false
            );
            Set(
                DiversityGalleryVisible,
                false
            );
            Set(
                SelectedUsina,
                Blank()
            );
            Set(
                SelectedProject,
                Blank()
            );
            Set(
                SelectedDiversity,
                Blank()
            );
            Set(
                SelectedUET,
                Blank()
            );
            Set(
                SelectedPosto,
                Blank()
            );
            Set(
                CodigoFOP,
                Blank()
            );
            Set(
                CodigoFOPAux,
                Blank()
            );
            Set(
                PDFViewVisible,
                false
            );
            Set(
                PDFTools,
                false
            );
            Set(
                FOP_PDF,
                Blank()
            );
            Set(
                PaginaAtual,
                false
            )
        );
        Set(
            FRP_MainContVisible,
            true
        );
        Set(
            FOP_NavigationVisible,
            true
        );
        Set(
            FOP_PEVisible_1,
            false
        );
        If(
            DetailedReportView,
            Set(
                DetailedReportView,
                false
            );
            Set(
                PDFViewVisible,
                false
            )
        );
        Set(Btn_Report_Click, false);
        Clear(lista_email)

    FRP_MainCont As groupContainer.verticalAutoLayoutContainer:
        ContentLanguage: =true
        DropShadow: =DropShadow.None
        Height: =App.Height
        LayoutAlignItems: =LayoutAlignItems.Stretch
        LayoutDirection: =LayoutDirection.Vertical
        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
        LayoutMode: =LayoutMode.Auto
        Width: =App.Width
        ZIndex: =1

        DPS_CabecalhoCont_2 As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.None
            Fill: =RGBA(0, 0, 0, 1)
            FillPortions: =0
            Height: =60
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutMinHeight: =100
            LayoutMinWidth: =0
            LayoutMode: =LayoutMode.Auto
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =App.Width
            ZIndex: =1

            C_LogoVersionCont_7 As groupContainer.verticalAutoLayoutContainer:
                FillPortions: =0
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =0
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                Width: =80
                ZIndex: =2

                C_LogoCPE_8 As image:
                    AlignInContainer: =AlignInContainer.Stretch
                    Height: =49
                    Image: ='CPE Logo Amarelo'
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    Width: =120
                    X: =17
                    Y: =6
                    ZIndex: =1

                C_AppVersion_6 As label:
                    Align: =Align.Center
                    Color: =RGBA(239, 223, 0, 1)
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Lighter
                    Height: =8
                    LayoutMinWidth: =0
                    Size: =6
                    Text: =VersaoUser
                    Width: =Parent.Width
                    X: =896
                    Y: =51
                    ZIndex: =2

            "DPS_ScreensNavigation_2 As gallery.'BrowseLayout_Horizontal_TwoTextOneImageVariant_ver5.0'":
                Default: |-
                    =Switch(VisibleScreen,
                    
                        "DigitalPE_Support", {Value:"SUPORTE"},
                        "Fault_Report", {Value:"SOLDA"},
                        "CPE_FOPs",{Value:"FOPs"}
                    )
                DelayItemLoading: =true
                FillPortions: =0
                Height: =100
                Items: =["FOPs","SUPORTE", "SOLDA"]
                LayoutMinHeight: =0
                LayoutMinWidth: =0
                LoadingSpinner: =LoadingSpinner.Data
                OnSelect: |-
                    =Switch(ThisItem.Value,
                    
                        "FOPs",Set(FOPTypeNavigation, true),
                        "SUPORTE", Navigate(DigitalPE_Support),
                        "SOLDA", Navigate(Fault_Report);
                        Reset(Parent)
                    )
                TemplatePadding: =0
                TemplateSize: =160
                Width: =480
                X: =120
                ZIndex: =3

                FOP_SelectedScreen_8 As rectangle:
                    Fill: =RGBA(239, 223, 0, 1)
                    Height: =5
                    OnSelect: =Select(Parent)
                    Visible: =ThisItem.IsSelected
                    Width: =Len(ThisItem.Value)*12
                    X: =(Parent.TemplateWidth - Len(ThisItem.Value)*12)/2
                    Y: =Parent.TemplateHeight*0.7
                    ZIndex: =3

                FOP_ScreenName_8 As button:
                    Fill: =RGBA(0, 0, 0, 0)
                    Font: =Font.Arial
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Bold, FontWeight.Semibold)
                    Height: =Parent.TemplateHeight/2
                    HoverFill: =ColorFade(RGBA(56, 96, 178, 0), -20%)
                    OnSelect: |-
                        =Select(Parent);
                        
                        Switch(ThisItem.Value,
                        
                            "FOPs",Set(FOPTypeNavigation, true),
                            "SUPORTE", Navigate(DigitalPE_Support, ScreenTransition.Fade),
                            "SOLDA", Navigate(Fault_Report, ScreenTransition.Fade)
                            ;Reset(Parent)
                        )
                    PressedBorderColor: =RGBA(166, 166, 166, 0)
                    PressedColor: =RGBA(255, 255, 255, 0)
                    PressedFill: =RGBA(0, 0, 0, 0)
                    Size: =18
                    Text: =ThisItem.Value
                    Width: =Parent.TemplateWidth
                    Y: =Parent.TemplateHeight/4
                    ZIndex: =4

            C_InfosImgsCont_2 As groupContainer.horizontalAutoLayoutContainer:
                FillPortions: =15
                LayoutGap: =5
                LayoutMinHeight: =0
                LayoutMinWidth: =0
                LayoutMode: =LayoutMode.Auto
                ZIndex: =4

                C_UserInfo_2 As groupContainer.verticalAutoLayoutContainer:
                    DropShadow: =DropShadow.None
                    FillPortions: =13
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutJustifyContent: =LayoutJustifyContent.Center
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    LayoutMode: =LayoutMode.Auto
                    ZIndex: =1

                    C_UserName_14 As label:
                        Align: =Align.Right
                        Color: =RGBA(255, 255, 255, 1)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Bold
                        Height: =20
                        LayoutMinWidth: =0
                        Size: =12
                        Text: =Upper(UsuáriosdoOffice365.UserProfileV2(User().Email).givenName & " " & UsuáriosdoOffice365.UserProfileV2(User().Email).surname)
                        Width: =Parent.Width
                        X: =896
                        Y: =35
                        ZIndex: =1

                    C_UserName_15 As label:
                        Align: =Align.Right
                        Color: =RGBA(255, 255, 255, 1)
                        Font: =Font.Arial
                        Height: =14
                        LayoutMinWidth: =0
                        Size: =10
                        Text: =UsuáriosdoOffice365.UserProfileV2(User().Email).department
                        Width: =Parent.Width
                        X: =896
                        Y: =35
                        ZIndex: =2

                C_UserImage_8 As image:
                    AlignInContainer: =AlignInContainer.Center
                    Height: =Parent.Height*0.7
                    Image: =UsuáriosdoOffice365.UserPhotoV2(User().Email)
                    ImagePosition: =ImagePosition.Fill
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    RadiusBottomLeft: =50
                    RadiusBottomRight: =50
                    RadiusTopLeft: =50
                    RadiusTopRight: =50
                    Width: =Parent.Height*0.7
                    X: =1219
                    Y: =8
                    ZIndex: =2

                C_LogoRenault_8 As image:
                    AlignInContainer: =AlignInContainer.Center
                    Height: =Parent.Height*0.75
                    Image: ='Logo Renault Branco'
                    LayoutMinWidth: =0
                    Width: =80
                    X: =76
                    Y: =12
                    ZIndex: =3

        FRP_SubMainCont As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.None
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutGap: =15
            LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
            LayoutMinHeight: =0
            LayoutMinWidth: =App.Width
            LayoutMode: =LayoutMode.Auto
            PaddingBottom: =15
            PaddingLeft: =15
            PaddingRight: =15
            PaddingTop: =15
            Visible: =FRP_MainContVisible
            ZIndex: =2

            FRP_ReportCont As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                DropShadow: =DropShadow.None
                Fill: =RGBA(217, 217, 214, 1)
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =0
                LayoutMode: =LayoutMode.Auto
                ZIndex: =1

                FRP_InfosCont As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =15
                    PaddingLeft: =15
                    PaddingRight: =15
                    Visible: |-
                        =If(
                            IsBlank(CodigoFOP),
                            false,
                            true)
                    Width: =Parent.Width
                    ZIndex: =1

                    FRP_PSRCont As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        FillPortions: =0.8
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutJustifyContent: =LayoutJustifyContent.Center
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        LayoutMode: =LayoutMode.Auto
                        Width: =Parent.Width
                        ZIndex: =1

                        PONTOS_DE_SOLDA As label:
                            FillPortions: =5
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Bold
                            Height: =38
                            Size: =18
                            Text: ="PONTOS DE SOLDA"
                            Width: =316
                            X: =31
                            Y: =48
                            ZIndex: =1

                        Rectangle6_2 As rectangle:
                            Fill: =RGBA(0, 0, 0, 0)
                            FillPortions: =4
                            ZIndex: =2

                        FRP_RefreshData As icon.Help:
                            Color: =RGBA(0, 0, 0, 1)
                            FillPortions: =1
                            Height: =Parent.Height*0.7
                            Icon: =Icon.Reload
                            OnSelect: =Refresh(Pontos_de_Solda)
                            Tooltip: ="Recarregar bases"
                            Width: =40
                            X: =608
                            Y: =48
                            ZIndex: =3

                    FRP_FilterCont As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutGap: =40
                        LayoutJustifyContent: =LayoutJustifyContent.Center
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        LayoutMode: =LayoutMode.Auto
                        Width: =Parent.Width
                        ZIndex: =2

                        Procurar_ponto As label:
                            Align: =Align.Right
                            Text: |-
                                ="Procurar ponto: "
                            ZIndex: =1

                        Input_ponto As text:
                            Align: =Align.Center
                            AlignInContainer: =AlignInContainer.Stretch
                            BorderColor: =RGBA(239, 223, 0, 1)
                            Default: =""
                            HintText: ="Digite o Ponto"
                            HoverBorderColor: =RGBA(240, 230, 93, 1)
                            HoverFill: =RGBA(239, 223, 0, 0.22)
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingRight: =0
                            PaddingTop: =0
                            Size: =15
                            Width: =300
                            ZIndex: =4

                        Exibir_lista As icon.Add:
                            AutoDisableOnSelect: =false
                            BorderColor: =RGBA(0, 0, 0, 1)
                            Color: =RGBA(0, 0, 0, 1)
                            DisabledBorderColor: =RGBA(141, 198, 63, 1)
                            DisplayMode: =
                            FocusedBorderThickness: =0
                            Height: =30
                            Icon: =Icon.View
                            OnSelect: =Set(view_Lista,true)
                            Tooltip: ="VER LISTA DE PONTOS SELECIONADOS"
                            Visible: =If(view_Lista, false,true)
                            Width: =30
                            Y: =40
                            ZIndex: =5

                    "Lista_de_pontos As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                        DelayItemLoading: =true
                        FillPortions: =10
                        Height: =400
                        Items: |-
                            =Filter(
                                Pontos_de_Solda,
                                StartsWith(
                                    PONTO,
                                    Input_ponto.Text
                                ) && POSTO = SelectedPosto && MODELO = SelectedDiversity && UET = SelectedUET
                            )
                        Layout: =Layout.Vertical
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        LoadingSpinner: =LoadingSpinner.Data
                        TemplatePadding: =0
                        TemplateSize: =Parent.Width/7
                        Visible: |-
                            =If(
                                IsBlank(CodigoFOP),
                                false,
                                true)
                        Width: =666
                        X: =25
                        Y: =138
                        ZIndex: =3

                        FRP_Separator_5 As rectangle:
                            Height: =2
                            OnSelect: =Select(Parent)
                            Width: =Parent.TemplateWidth
                            Y: =Parent.TemplateHeight
                            ZIndex: =5

                        Container64_4 As groupContainer.horizontalAutoLayoutContainer:
                            DropShadow: =DropShadow.None
                            Height: =Parent.TemplateHeight
                            LayoutMode: =LayoutMode.Auto
                            PaddingRight: =15
                            Width: =Parent.TemplateWidth
                            ZIndex: =10

                            PSR As groupContainer.verticalAutoLayoutContainer:
                                DropShadow: =DropShadow.None
                                FillPortions: =0.3
                                LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                                LayoutMinHeight: =0
                                LayoutMinWidth: =0
                                LayoutMode: =LayoutMode.Auto
                                PaddingBottom: =5
                                PaddingTop: =5
                                Width: =Parent.Width/3
                                ZIndex: =1

                                Souldure_Point_3 As label:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    FillPortions: =1
                                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                    Height: =Self.Size * 1.8
                                    LayoutMinHeight: =0
                                    LayoutMinWidth: =0
                                    OnSelect: =Select(Lista_de_pontos)
                                    PaddingBottom: =0
                                    PaddingLeft: =0
                                    PaddingRight: =0
                                    PaddingTop: =0
                                    Text: =ThisItem.PONTO
                                    Width: =130
                                    ZIndex: =2

                                IconSelectecPoint As icon.CheckBadge:
                                    AlignInContainer: =AlignInContainer.Center
                                    BorderColor: =RGBA(187, 221, 140, 1)
                                    Color: =RGBA(99, 139, 44, 1)
                                    DisplayMode: =DisplayMode.View
                                    Icon: =Icon.CheckBadge
                                    PaddingRight: =
                                    Visible: =!IsBlank(LookUp(lista_email, PSR=ThisItem.PONTO))
                                    Width: =30
                                    X: =
                                    ZIndex: =3

                                Rectangle6_3 As rectangle:
                                    Fill: =RGBA(0, 0, 0, 0)
                                    LayoutMinWidth: =10
                                    Width: =10
                                    ZIndex: =4

                            PSR_Erros As groupContainer.horizontalAutoLayoutContainer:
                                ContentLanguage: =
                                DropShadow: =DropShadow.None
                                LayoutAlignItems: =LayoutAlignItems.Center
                                LayoutGap: =40
                                LayoutJustifyContent: =LayoutJustifyContent.Center
                                LayoutMinHeight: =0
                                LayoutMinWidth: =0
                                LayoutMode: =LayoutMode.Auto
                                ZIndex: =3

                                Rectangle6_4 As rectangle:
                                    Fill: =RGBA(0, 0, 0, 0)
                                    LayoutMinWidth: =10
                                    Width: =2
                                    ZIndex: =1

                                FRP_Pag_FOP As text:
                                    BorderColor: =RGBA(239, 223, 0, 1)
                                    Default: =
                                    Format: =TextFormat.Number
                                    HintText: ="Pg"
                                    LayoutMinWidth: =30
                                    PaddingLeft: =8
                                    Width: =35
                                    X: =
                                    ZIndex: =3

                                FRP_Tools As combobox:
                                    BorderColor: =RGBA(136, 139, 141, 1)
                                    BorderThickness: =1
                                    ChevronBackground: =RGBA(239, 223, 0, 1)
                                    ChevronFill: =RGBA(0, 0, 0, 1)
                                    ChevronHoverBackground: =ColorFade(RGBA(136, 139, 141, 1), -20%)
                                    Default: =Blank()
                                    DefaultSelectedItems: =Blank()
                                    DisplayFields: =["Nome","Projeto"]
                                    Fill: =RGBA(217, 217, 214, 1)
                                    FillPortions: =1
                                    Font: =Font.Arial
                                    Height: =28
                                    HoverColor: =RGBA(255, 255, 255, 1)
                                    HoverFill: =RGBA(136, 139, 141, 1)
                                    InputTextPlaceholder: ="Ferramenta"
                                    IsSearchable: =false
                                    Items: |-
                                        =[
                                          {Nome: "Manual"},
                                          {Nome: "Robotizada"},
                                          {Nome: "Automática"}
                                        ]
                                    LayoutMinWidth: =50
                                    NoSelectionText: ="Ferramenta"
                                    OnChange: =
                                    PressedColor: =RGBA(0, 0, 0, 1)
                                    PressedFill: =RGBA(136, 139, 141, 1)
                                    SearchFields: =["Nome"]
                                    SearchItems: =[]
                                    SelectionColor: =RGBA(0, 0, 0, 1)
                                    SelectionFill: =RGBA(239, 223, 0, 1)
                                    SelectMultiple: =false
                                    Size: =10
                                    Template: =ListItemTemplate.Double
                                    Width: =221
                                    X: =Parent.X+10
                                    Y: =40
                                    ZIndex: =4

                                FRP_Errors As combobox:
                                    BorderColor: =RGBA(136, 139, 141, 1)
                                    BorderThickness: =1
                                    ChevronBackground: =RGBA(239, 223, 0, 1)
                                    ChevronFill: =RGBA(0, 0, 0, 1)
                                    ChevronHoverBackground: =ColorFade(RGBA(136, 139, 141, 1), -20%)
                                    Default: =Blank()
                                    DefaultSelectedItems: =Blank()
                                    DisplayFields: =["Nome"]
                                    Fill: =RGBA(217, 217, 214, 1)
                                    FillPortions: =1
                                    Font: =Font.Arial
                                    Height: =28
                                    HoverColor: =RGBA(255, 255, 255, 1)
                                    HoverFill: =RGBA(136, 139, 141, 1)
                                    InputTextPlaceholder: ="Código de Erro"
                                    IsSearchable: =false
                                    Items: |
                                        =[
                                          {Nome: "1 - Ponto ausente", Numero: "1"},
                                          {Nome: "2 - Ponto solto", Numero: "2"},
                                          {Nome: "3 - Diâmetro insuficiente", Numero: "3"},
                                          {Nome: "4 - Ponto furado trincado", Numero: "4"},
                                          {Nome: "5 - Ponto com rebarba", Numero: "5"},
                                          {Nome: "6 - Ponto deformado", Numero: "6"},
                                          {Nome: "7 - Ponto afundado Identado", Numero: "7"},
                                          {Nome: "8 - Passo/Posição Irregular", Numero: "8"},
                                          {Nome: "9 - Mal posicionado Início de linha", Numero: "9"},
                                          {Nome: "10 - Ponto na borda", Numero: "10"},
                                          {Nome: "11 - PSP posicionado incorretamente", Numero: "11"}
                                        ]
                                    LayoutMinWidth: =100
                                    NoSelectionText: ="Código de Erro"
                                    PressedColor: =RGBA(0, 0, 0, 1)
                                    PressedFill: =RGBA(136, 139, 141, 1)
                                    SearchFields: =["Nome"]
                                    SearchItems: =[]
                                    SelectionColor: =RGBA(0, 0, 0, 1)
                                    SelectionFill: =RGBA(239, 223, 0, 1)
                                    Size: =10
                                    Width: =221
                                    X: =398
                                    Y: =34
                                    ZIndex: =5

                            Container66_1 As groupContainer.verticalAutoLayoutContainer:
                                DropShadow: =DropShadow.None
                                FillPortions: =0
                                LayoutAlignItems: =LayoutAlignItems.Center
                                LayoutDirection: =LayoutDirection.Vertical
                                LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                                LayoutMinHeight: =0
                                LayoutMinWidth: =0
                                LayoutMode: =LayoutMode.Auto
                                PaddingRight: =10
                                PaddingTop: =5
                                Width: =30
                                ZIndex: =4

                                Add As icon.Add:
                                    AutoDisableOnSelect: =false
                                    BorderColor: =RGBA(0, 0, 0, 1)
                                    Color: =RGBA(0, 0, 0, 1)
                                    DisabledBorderColor: =RGBA(141, 198, 63, 1)
                                    DisplayMode: =
                                    FocusedBorderThickness: =0
                                    Height: =30
                                    Icon: =Icon.Add
                                    OnSelect: |-
                                        =If(
                                            Or(
                                                IsBlank(FRP_Tools.Selected.Nome),
                                                IsEmpty(FRP_Errors.SelectedItems),
                                                IsBlank(FRP_Pag_FOP.Text)
                                            ),
                                            Notify(
                                                "SELECIONE UM ITEM",
                                                NotificationType.Information
                                            ),
                                            Collect(
                                                lista_email,
                                                {
                                                    Usina: SelectedUsina,
                                                    UET: ThisItem.UET,
                                                    Posto: ThisItem.POSTO,
                                                    Diversidade: ThisItem.MODELO,
                                                    Codigo_FOP: CodigoFOP,
                                                    Indice_FOP: LookUp(Navettes, CodigoFOP = Codigo_FOP, Indice_FOP),
                                                    PSR: ThisItem.PONTO,
                                                    Pagina: FRP_Pag_FOP.Text,
                                                    Equip: FRP_Tools.Selected.Nome,
                                                    CodigoErro: Concat(
                                                        FRP_Errors.SelectedItems, 
                                                        Numero, 
                                                        ", "
                                                        )
                                                }
                                            );
                                        
                                            Reset(FRP_Tools);
                                            Reset(FRP_Errors);
                                            Notify(
                                                "ITEM ADICIONADO NA LISTA",
                                                NotificationType.Success
                                            )
                                        )
                                    Visible: =IsBlank(LookUp(lista_email, PSR=ThisItem.PONTO))
                                    Width: =30
                                    Y: =40
                                    ZIndex: =4

                                Remove As icon.Add:
                                    BorderColor: =RGBA(0, 0, 0, 1)
                                    Color: =RGBA(0, 0, 0, 1)
                                    FocusedBorderThickness: =0
                                    Height: =30
                                    Icon: =Icon.Trash
                                    OnSelect: |-
                                        =Remove(lista_email, LookUp(lista_email, PSR=ThisItem.PONTO));
                                        Notify("ITEM REMOVIDO DA LISTA", NotificationType.Success)
                                    Visible: |-
                                        =!IsBlank(LookUp(lista_email, PSR=ThisItem.PONTO))
                                        
                                        
                                        //BtnRemoveDisplay
                                    Width: =30
                                    Y: =Parent.Height
                                    ZIndex: =5

                            FRP_SelectedItem_2 As rectangle:
                                Fill: =RGBA(239, 223, 0, 1)
                                Height: =Parent.Height
                                OnSelect: =Select(Lista_de_pontos)
                                Visible: =ThisItem.IsSelected
                                Width: =20
                                ZIndex: =5

                    FRP_CommentCont As groupContainer.verticalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        FillPortions: =2
                        Height: =Parent.Height
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutJustifyContent: =LayoutJustifyContent.Center
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        PaddingBottom: =10
                        PaddingLeft: =30
                        PaddingRight: =30
                        PaddingTop: =5
                        Width: =Parent.Width
                        ZIndex: =5

                        FRP_Comment_Label As label:
                            AlignInContainer: =AlignInContainer.Stretch
                            Color: =RGBA(0, 0, 0, 1)
                            FillPortions: =1
                            Font: =Font.Arial
                            Height: =20
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            Size: =12
                            Text: ="Descrição da Reatividade"
                            Width: =119
                            Wrap: =false
                            X: =30
                            Y: =10
                            ZIndex: =1

                        FRP_Comments As text:
                            BorderColor: =
                            BorderThickness: =1
                            Default: =
                            DelayOutput: =true
                            DisplayMode: =Parent.DisplayMode
                            Fill: =RGBA(0, 0, 0, 0)
                            FillPortions: =1.7
                            Font: =Font.Arial
                            Height: =176
                            HoverBorderColor: =RGBA(136, 139, 141, 1)
                            HoverFill: =RGBA(187, 188, 188, 1)
                            LayoutMinWidth: =0
                            Mode: =TextMode.MultiLine
                            PaddingLeft: =5
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =11
                            Tooltip: =
                            Width: =Parent.Width*0.9
                            X: =5
                            Y: =FRP_Comment_Label.Y + FRP_Comment_Label.Height + 5
                            ZIndex: =2

                    FRP_Botao_Enviar As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        LayoutGap: =15
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        LayoutMode: =LayoutMode.Auto
                        PaddingLeft: =30
                        PaddingRight: =30
                        Width: =Parent.Width
                        ZIndex: =6

                        FRP_Enviar As button:
                            BorderColor: =RGBA(239, 223, 0, 1)
                            Color: =RGBA(0, 0, 0, 1)
                            DisplayMode: |-
                                =If(IsBlank(FRP_Comments.Text),
                                /*Condição para verficiar que os campos minimos estejam preenchidos*/
                                DisplayMode.Disabled, /*Se não estão, o botão fica deshabilitado*/    
                                DisplayMode.Edit /*Caso não, o botão pode ser usado*/
                                )
                            Fill: =RGBA(239, 223, 0, 1)
                            FillPortions: =2
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Bold
                            Height: =Parent.Height*0.7
                            HoverBorderColor: =RGBA(238, 235, 76, 1)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =RGBA(238, 235, 76, 1)
                            LayoutMinWidth: =0
                            OnSelect: |-
                                =Set(
                                    lastID,
                                    Max(
                                        FRP_Reatividades,
                                        FRP_Reatividades[@Título]
                                    ) + 1
                                );
                                // Coletar emails para envio
                                Set(
                                    email1,
                                    LookUp(
                                        Supervisores,
                                        SelectedUET = UET,
                                        email_lider_1t
                                    )
                                );
                                Set(
                                    email2,
                                    LookUp(
                                        Supervisores,
                                        SelectedUET = UET,
                                        email_lider_2t
                                    )
                                );
                                If(
                                    IsEmpty(lista_email),
                                    Notify(
                                        "Não há nenhum ponto selecionado",
                                        NotificationType.Information
                                    ),
                                    Notify(
                                        "Enviando reatividade por e-mail",
                                        NotificationType.Information
                                    );
                                    // Se a lista de e-mails não estiver vazia, proceda com o envio de e-mail e adição de pendências
                                    // Montar o PDF
                                Set(
                                        FRP_PDF_Visible,
                                        true
                                    );
                                    Set(
                                        FOP_NavigationVisible,
                                        false
                                    );
                                    Set(
                                        PDF_Reatividade,
                                        PDF(FRP_PDF)
                                    );
                                    Set(
                                        Name_Reatividade,
                                        Concatenate(
                                            "Reatividade US ",
                                            lastID,
                                            "_Preliminar ",
                                            SelectedUsina,
                                            "-",
                                            SelectedUET,
                                            "-",
                                            SelectedDiversity,
                                            ".pdf"
                                        )
                                    );
                                    Salvar_Reatividade.Run(
                                        Name_Reatividade,
                                        SelectedUET,
                                        SelectedDiversity,
                                        "2024",
                                        {
                                            file: {
                                                name: "REATIVIDADE",
                                                contentBytes: PDF_Reatividade
                                            }
                                        }
                                    );
                                    // Enviar e-mail
                                Office365Outlook.SendEmailV2(
                                        "matheus.bernardim-extern@renault.com",
                                        "EMAIL DE TESTE FAVOR IGNORAR: Reatividade de solda " & SelectedUsina & "-" & SelectedUET & "-" & SelectedDiversity,
                                        "<html><body>" & "<p>Olá Supervisor (a),</p>" & "<p>O Colaborador (a) " & Upper(UsuáriosdoOffice365.UserProfileV2(User().Email).givenName) & " " & UsuáriosdoOffice365.UserProfileV2(User().Email).surname & " reportou uma falha.</p>" & "<p>******************* INFORMAÇÕES *******************</p>" & Concat(
                                            lista_email,
                                            "<p>- Codigo_FOP: " & Codigo_FOP & "-" & Indice_FOP & "</p>" & "<p>- PSR: " & PSR & "</p>" & "<p>- Equipamento: " & Equip & "</p>" & "<p>- Código do erro: " & CodigoErro & "</p>" & "<br>"
                                        ) & "<p>************************************************************</p>" & "<p>- Observação/Justificativa: " & FRP_Comments.Text & "</p>" & "</body></html>",
                                        {
                                            Attachments: Table(
                                                {
                                                    Name: Name_Reatividade,
                                                    ContentBytes: PDF_Reatividade
                                                }
                                            ),
                                            Cc: "matheus.bernardim-extern@renault.com"
                                        }
                                    );
                                    // Limpar e resetar
                                Set(
                                        FRP_PDF_Visible,
                                        false
                                    );
                                    Set(
                                        FOP_NavigationVisible,
                                        true
                                    );
                                    Patch(
                                        FRP_Reatividades,
                                        Defaults(FRP_Reatividades),
                                        {
                                            Responsavel: If(
                                                Hour(Now()) < 12 && Hour(Now()) > 5,
                                                email1,
                                                email2
                                            ),
                                            Título: lastID,
                                            Data_Criacao: Now(),
                                            // Adicionar a data e hora atuais   
                                Status: "Aberto",
                                            Usina: SelectedUsina,
                                            Diversidade: SelectedDiversity,
                                            UET: SelectedUET,
                                            Observacao: FRP_Comments.Text
                                        }
                                    );
                                    ForAll(
                                        lista_email,
                                            // Adicionar uma linha para cada PSR na lista de e-mails
                                        Patch(
                                            FRP_PSR_Reatividade,
                                            Defaults(FRP_PSR_Reatividade),
                                            {
                                                Título: lastID,
                                                // Usar o ID incrementado
                                PSR: lista_email[@PSR],
                                                Codigo_Erro: lista_email[@CodigoErro],
                                                Codigo_FOP: CodigoFOP,
                                                Indice_FOP: lista_email[@Indice_FOP],
                                                Pagina_Ponto: lista_email[@Pagina]
                                            }
                                        )
                                    );
                                    // Limpar lista_email após adicionar as pendências
                                Clear(lista_email);
                                    // Printar notificação
                                Notify(
                                        "Reatividade enviada!",
                                        NotificationType.Success
                                    );
                                    Reset(FRP_Comments)
                                )
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Text: ="Enviar"
                            Width: =Parent.Width
                            X: =438
                            Y: =569
                            ZIndex: =3

                    FRP_Buttons As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutGap: =15
                        LayoutJustifyContent: =LayoutJustifyContent.Center
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        LayoutMode: =LayoutMode.Auto
                        PaddingLeft: =15
                        PaddingRight: =15
                        Width: =Parent.Width
                        ZIndex: =7

                        Rectangle2_13 As rectangle:
                            Fill: =RGBA(0, 0, 0, 0)
                            FillPortions: =5
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            Visible: =!LastFOPsGalleryVisible
                            ZIndex: =1

                        FRP_ReturnButton_4 As button:
                            BorderColor: =RGBA(0, 0, 0, 1)
                            DisplayMode: |-
                                =DisplayMode.Edit
                                        
                            Fill: =RGBA(0, 0, 0, 1)
                            FillPortions: =4
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Bold
                            Height: =Parent.Height*0.7
                            HoverBorderColor: =RGBA(238, 235, 76, 1)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =RGBA(238, 235, 76, 1)
                            LayoutMinWidth: =0
                            OnSelect: |
                                =Set(CodigoFOP,Blank()); //Reseta a variável de Codigo FOP
                                Set(FOP_PDF, Blank());  //Reseta a variável com o arquivo blob da FOP
                                Set(Table_PDF, Blank());
                                
                                Set(FOPNavigationVisible,true);   //Mostra a navegação de FOPs
                                Set(PDFViewVisible,false);         //Deixa de mostrar a preview da FOP
                                Set(TableVisible, false);
                                
                                Set(LastFOPsGalleryVisible, true); //Mostra as ultimas FOPs modificadas
                                Set(FOPDetailsVisible, false);     //Deixa de mostrar os detalhes da FOP escolhida
                                Reset(FRP_Comments);
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Text: ="Voltar"
                            Visible: =!LastFOPsGalleryVisible
                            Width: =113
                            X: =43
                            Y: =586
                            ZIndex: =2

                        FRP_MaximazeFOPBtn As button:
                            BorderColor: =RGBA(239, 223, 0, 1)
                            Color: =RGBA(0, 0, 0, 1)
                            Fill: =RGBA(239, 223, 0, 1)
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Bold
                            Height: =Parent.Height*0.7
                            HoverBorderColor: =RGBA(238, 235, 76, 1)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =RGBA(238, 235, 76, 1)
                            LayoutMinWidth: =0
                            OnSelect: |
                                =Set(PDFTools, true);
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Text: ="Maximizar"
                            Tooltip: ="AUMENTAR TAMANHO DE FOP"
                            Visible: =!LastFOPsGalleryVisible
                            Width: =150
                            X: =134
                            Y: =586
                            ZIndex: =3

                        Rectangle2_15 As rectangle:
                            Fill: =RGBA(0, 0, 0, 0)
                            FillPortions: =5
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            Visible: =!LastFOPsGalleryVisible
                            ZIndex: =4

                        Rectangle2_14 As rectangle:
                            Fill: =RGBA(0, 0, 0, 0)
                            FillPortions: =10
                            LayoutMinHeight: =0
                            Visible: =LastFOPsGalleryVisible
                            ZIndex: =5

                FRP_Button_Supervisor As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    ContentLanguage: =
                    DropShadow: =DropShadow.None
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutGap: =15
                    LayoutJustifyContent: =LayoutJustifyContent.Center
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =15
                    PaddingRight: =15
                    Visible: |-
                        =If(
                            IsBlank(CodigoFOP),
                            true,
                            false
                        )
                    Width: =Parent.Width
                    ZIndex: =4

                    Rectangle2_16 As rectangle:
                        Fill: =RGBA(0, 0, 0, 0)
                        FillPortions: =10
                        LayoutMinHeight: =0
                        Visible: =LastFOPsGalleryVisible
                        ZIndex: =1

                    FRP_BtnSupervisor As button:
                        AlignInContainer: =AlignInContainer.Center
                        BorderColor: =RGBA(239, 223, 0, 1)
                        Color: =RGBA(0, 0, 0, 1)
                        Fill: =RGBA(239, 223, 0, 1)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Bold
                        Height: =50
                        HoverBorderColor: =RGBA(238, 235, 76, 1)
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =RGBA(238, 235, 76, 1)
                        LayoutMinHeight: =30
                        OnSelect: |-
                            =Set(FOP_PEVisible_1, true); //Mostra o bloco de informações da nova subtela
                            Set(FRP_Pendencias_Visible, true);
                            Set(FRP_MainContVisible, false); //Deixa de mostrar o bloco de informações da tela inicial
                            
                            Refresh(FRP_PSR_Reatividade);
                            Refresh(FRP_Reatividades);
                            
                            
                            Set(CodigoFOP, Blank());
                            
                            /*Resta o menu de navegação de FOPs*/
                            Set(UsinaGalleryVisible, true);       //Mostrar a galeria de usinas
                            Set(ProjectGalleryVisible, false);    //   ''         ''     projetos
                            Set(DiversityGalleryVisible, false);  //   ''         ''     diversidade
                            Set(UETGalleryVisible, false);        //   ''         ''     UETs
                            Set(PostoGalleryVisible, false);      //   ''         ''     Postos
                            
                            Set(SelectedUsina,Blank());    //Valor para a USINA selecionado na galeria respetiva
                            Set(SelectedProject,Blank());  //    ''     o PROJETO         ''            ''      
                            Set(SelectedDiversity,Blank());//    ''     a DIVERSIDADE     ''            ''
                            Set(SelectedUET,Blank());      //    ''     a UET             ''            ''      
                            Set(SelectedPosto,Blank());    //    ''     o POSTO           ''            ''    
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Text: ="Pendências"
                        Visible: |-
                            =If(
                                Or(
                                    IsBlank(SelectedPosto),
                                    IsBlank(SelectedUET),
                                    IsBlank(SelectedDiversity)
                                ),
                                true,
                                false
                            )
                        Width: =300
                        X: =43
                        Y: =580
                        ZIndex: =2

                    Rectangle2_17 As rectangle:
                        Fill: =RGBA(0, 0, 0, 0)
                        FillPortions: =10
                        LayoutMinHeight: =0
                        Visible: =LastFOPsGalleryVisible
                        ZIndex: =3

            FRP_FOP_NavigationCont As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                DropShadow: =DropShadow.None
                Fill: =RGBA(217, 217, 214, 1)
                FillPortions: |-
                    =1
                    //If(!LastFOPsGalleryVisible; 2; 1)
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =0
                LayoutMode: =LayoutMode.Auto
                Visible: =FOP_NavigationVisible
                ZIndex: =2

                FNC_Labels_2 As groupContainer.horizontalAutoLayoutContainer:
                    DropShadow: =DropShadow.None
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutGap: =10
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =10
                    PaddingRight: =10
                    PaddingTop: =10
                    ZIndex: =1

                    FOP_NavigationLabel_2 As label:
                        AlignInContainer: =AlignInContainer.Center
                        AutoHeight: =true
                        FillPortions: =9
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Bold
                        Height: =30
                        PaddingLeft: =20
                        Size: =12
                        Text: |-
                            =If(IsBlank(SelectedUsina),
                            
                                /*Caso usuário não tenha escolhido nenhuma usina*/
                                "Procurar FOP", 
                            
                                /*Quando visualiza os diferentes projetos*/
                                "Usina: " & SelectedUsina
                            
                             & 
                            
                            If(SelectedUsina="CVU",
                            
                                " - Diversidade" & If(IsBlank(SelectedDiversity),
                            
                                                        /*Quando não foi selecionada Diversidade, não mostra o resto de infos*/ 
                                                        "",
                            
                                                        /*Ao escolher diversidade mostra a escolha*/
                                                        ": " & SelectedDiversity & " - UET" & If(IsBlank(SelectedUET),
                            
                                                                /*Quando não foi selecionada UET, não mostra o resto de infos*/ 
                                                                "" ,
                            
                                                                /*Ao escolher UET mostra a escolha*/
                                                                ": " & SelectedUET & " - Posto"
                                                        )
                                                    ),
                            
                                " - UET" & If(IsBlank(SelectedUET),
                            
                                                                /*Quando não foi selecionada UET, não mostra o resto de infos*/ 
                                                                "" ,
                            
                                                                /*Ao escolher UET mostra a escolha*/
                                                                ": " & SelectedUET & Switch(SelectedUET,
                            
                                                                                            "PRP", " - Diversidade" & If(IsBlank(SelectedDiversity),
                            
                                                                                                                            /*Quando não foi selecionada Diversidade, não mostra o resto de infos*/ 
                                                                                                                            "",
                            
                                                                                                                            /*Ao escolher diversidade mostra a escolha*/
                                                                                                                            ": " & SelectedDiversity
                                                                                                                        ),
                            
                                                                                            "PK2", " - Diversidade" & If(IsBlank(SelectedDiversity),
                            
                                                                                                                            /*Quando não foi selecionada Diversidade, não mostra o resto de infos*/ 
                                                                                                                            "",
                            
                                                                                                                            /*Ao escolher diversidade mostra a escolha*/
                                                                                                                            ": " & SelectedDiversity
                                                                                                                        ),
                                                               
                                                                                            " - Diversidade" & If(IsBlank(SelectedDiversity),
                            
                                                                                                            /*Quando não foi selecionado posto, não mostra o resto de infos*/ 
                                                                                                            "",
                            
                                                                                                            /*Ao escolher posto mostra a escolha*/
                                                                                                             ": " & SelectedDiversity
                                                                                                        )
                                                                                    )
                                                            )
                            )
                            )
                        Width: =Parent.Width
                        X: =16
                        Y: =36
                        ZIndex: =1

                    FOP_N_UETReturnIcon_2 As icon.Add:
                        AlignInContainer: =AlignInContainer.Center
                        Color: =RGBA(0, 0, 0, 1)
                        FillPortions: =1
                        Height: =35
                        Icon: =Icon.BackArrow
                        LayoutMinWidth: =0
                        OnSelect: |-
                            =If(SelectedUsina="CVU", 
                            
                                Set(SelectedDiversity, Blank());
                                Set(UETGalleryVisible,false);
                                Set(DiversityGalleryVisible, true),
                            
                                // ----------------- \\
                                
                                Set(SelectedUsina, Blank());
                                Set(SelectedUET, Blank());
                            
                                Set(UETGalleryVisible, false);
                                Set(UsinaGalleryVisible, true);
                            );
                        Visible: =UETGalleryVisible
                        Width: =30
                        X: =532
                        Y: =36
                        ZIndex: =2

                    TextInput1_2 As text:
                        Align: =Align.Justify
                        AlignInContainer: =AlignInContainer.Stretch
                        BorderColor: =RGBA(136, 139, 141, 1)
                        BorderThickness: =1
                        Default: =""
                        DelayOutput: =true
                        Fill: =RGBA(0, 0, 0, 0)
                        Font: =Font.Arial
                        Height: =35
                        HintText: ="Procure o posto"
                        HoverBorderColor: =RGBA(136, 139, 141, 1)
                        HoverFill: =RGBA(187, 188, 188, 1)
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        MaxLength: =500
                        PaddingLeft: =5
                        RadiusBottomLeft: =15
                        RadiusBottomRight: =15
                        RadiusTopLeft: =15
                        RadiusTopRight: =15
                        Size: =12
                        Tooltip: ="Procurar posto"
                        Visible: =PostoGalleryVisible
                        Width: =300
                        X: =71
                        Y: =66
                        ZIndex: =3

                    FOP_N_PostoReturnIcon_2 As icon.Add:
                        AlignInContainer: =AlignInContainer.Center
                        Color: =RGBA(0, 0, 0, 1)
                        FillPortions: =1
                        Height: =35
                        Icon: =Icon.BackArrow
                        LayoutMinWidth: =0
                        OnSelect: |-
                            =If(SelectedUET="PRP" || SelectedUET="PK2", 
                            
                                Set(SelectedDiversity, Blank());
                                Set(DiversityGalleryVisible,true),
                                
                            // ----- PADRÃO ----- \\  
                            Set(SelectedPosto, Blank());  
                            Set(DiversityGalleryVisible, true);
                            );
                            
                            Set(PostoGalleryVisible, false);
                            Set(SelectedPosto, Blank());
                            Reset(TextInput1_2);
                            Clear(lista_email)
                        Visible: =PostoGalleryVisible
                        Width: =30
                        X: =532
                        Y: =36
                        ZIndex: =4

                    FOP_N_DiversityReturnIcon_2 As icon.Add:
                        AlignInContainer: =AlignInContainer.Center
                        Color: =RGBA(0, 0, 0, 1)
                        FillPortions: =1
                        Height: =35
                        Icon: =Icon.BackArrow
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        OnSelect: |+
                            =If(SelectedUET="PRP" || SelectedUET="PK2", 
                            
                                Set(SelectedUET, Blank());
                                Set(DiversityGalleryVisible, false);
                                Set(UETGalleryVisible,true),
                            
                            SelectedUsina="CVU",
                            
                                 Set(SelectedUsina, Blank());
                                Set(DiversityGalleryVisible, false);
                                Set(UsinaGalleryVisible,true),
                            
                            // -------- PADRÃO ------ \\    
                            Set(SelectedDiversity, Blank());
                            Set(UETGalleryVisible, true);
                            Set(DiversityGalleryVisible, false);
                            );
                            
                        Visible: =DiversityGalleryVisible
                        Width: =30
                        X: =532
                        Y: =36
                        ZIndex: =5

                "FOP_N_UsinaGallery_2 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    Default: =Blank()
                    DelayItemLoading: =true
                    FillPortions: =9
                    Height: =537
                    Items: |-
                        =Distinct(PastasFOPs, // Coluna unica com diferentes valores
                                 Usina)             // Valores unicos que quero que devolva
                        
                        
                        //Distinc(Fonte_Dados; Resultado "O que devolve"))
                    Layout: =Layout.Vertical
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    LoadingSpinner: =LoadingSpinner.Data
                    TemplatePadding: =0
                    TemplateSize: =Parent.Width/5
                    Visible: =UsinaGalleryVisible
                    Width: =Parent.Width
                    WrapCount: =2
                    X: =16
                    Y: =82
                    ZIndex: =2

                    FOP_N_Usina_3 As button:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        DisplayMode: |-
                            =DisplayMode.Edit
                                    
                        Fill: =RGBA(0, 0, 0, 1)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Bold
                        HoverBorderColor: =RGBA(238, 235, 76, 1)
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =RGBA(238, 235, 76, 1)
                        OnSelect: |+
                            =Set(SelectedUsina, ThisItem.Value);
                            Set(UsinaGalleryVisible, false);
                            
                            // Verifica-se qual é a opção escolhida 
                            Switch(ThisItem.Value,
                            
                                //Para mostrar a galeria de Diversidades
                                "CVU", Set(DiversityGalleryVisible,true),
                                
                                //Para mostrar a galeria de UETs
                                "CVP", Set(UETGalleryVisible, true);
                            );
                            
                            
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =30
                        RadiusTopLeft: =30
                        RadiusTopRight: =0
                        Text: =ThisItem.Value
                        Width: =Parent.TemplateWidth/2
                        X: =Parent.TemplateWidth/4
                        Y: =25
                        ZIndex: =1

                "FOP_N_UETGallery_2 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    Default: =Blank()
                    DelayItemLoading: =true
                    FillPortions: =9
                    Height: =567
                    Items: |-
                        =Sort(    
                            Distinct(   //Função para só devolver um item, indiferente da quantidade de vezes que ele aparece
                        
                                Filter(PastasFOPs,               //Filtragem da base
                                        Usina=SelectedUsina,
                                        If(SelectedUsina="CVU",Diversidade=SelectedDiversity, true)
                        
                                    ), //Com os itens da diversidade selecionada anteriormente
                                        
                                UET),//E devolva só as UETs
                        
                            Value,
                            SortOrder.Ascending
                        )
                    Layout: =Layout.Vertical
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    LoadingSpinner: =LoadingSpinner.Data
                    TemplatePadding: =0
                    TemplateSize: =Parent.Width/9
                    Visible: =UETGalleryVisible
                    Width: =585
                    WrapCount: =2
                    Y: =80
                    ZIndex: =3

                    FOP_N_UET_2 As button:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Fill: =RGBA(0, 0, 0, 1)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Bold
                        Height: =Parent.TemplateHeight*0.6
                        HoverBorderColor: =RGBA(238, 235, 76, 1)
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =RGBA(238, 235, 76, 1)
                        OnSelect: |-
                            =If(ThisItem.Value="PRP" || ThisItem.Value="PK2", 
                            
                                Set(DiversityGalleryVisible, true);
                                Set(PostoGalleryVisible, true)
                            );
                            
                            Set(UETGalleryVisible, false);
                            Set(DiversityGalleryVisible, true);
                            Set(SelectedUET, ThisItem.Value)
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =30
                        Text: =ThisItem.Value
                        Width: =Parent.TemplateWidth*0.3
                        X: =Parent.TemplateWidth*0.35
                        Y: =Parent.TemplateHeight*0.2
                        ZIndex: =1

                "FOP_N_DiversityGallery_2 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    Default: =Blank()
                    DelayItemLoading: =true
                    FillPortions: =9
                    Height: =565
                    Items: |-
                        =Sort(
                            Distinct(   //Função para só devolver um item, indiferente da quantidade de vezes que ele aparece
                        
                                Filter(PastasFOPs,             //Filtragem da base
                                        Usina=SelectedUsina,
                                        UET=SelectedUET || IsBlank(SelectedUET)       
                                ),   //Com os itens da usina selecionada anteriormente
                        
                                Diversidade),//E que só devolva os nomes nos projetos
                        
                            Value,
                            SortOrder.Ascending
                        )
                    Layout: =Layout.Vertical
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    LoadingSpinner: =LoadingSpinner.Data
                    TemplatePadding: =0
                    TemplateSize: =Parent.Width/5
                    Visible: =DiversityGalleryVisible
                    Width: =585
                    WrapCount: =2
                    Y: =82
                    ZIndex: =4

                    FOP_N_Diversity_2 As button:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        DisplayMode: |-
                            =DisplayMode.Edit
                                    
                        Fill: =RGBA(0, 0, 0, 1)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Bold
                        Height: =Parent.TemplateHeight/2
                        HoverBorderColor: =RGBA(238, 235, 76, 1)
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =RGBA(238, 235, 76, 1)
                        OnSelect: |+
                            =Set(SelectedDiversity, ThisItem.Value);
                            
                            // ----- PADRÃO ----- \\  
                            Set(PostoGalleryVisible, true);
                            Set(DiversityGalleryVisible, false);
                            
                            
                            
                        RadiusBottomLeft: =0
                        RadiusBottomRight: |
                            =25
                        RadiusTopLeft: =50
                        RadiusTopRight: =25
                        Text: =ThisItem.Value
                        Width: =Parent.TemplateWidth*0.5
                        X: =Self.Width*0.65
                        Y: =Parent.TemplateHeight/4
                        ZIndex: =1

                    FOP_N_DiversityImage_2 As image:
                        Height: =Parent.TemplateHeight*0.8
                        Image: |-
                            =LookUp( 
                                PastasFOPs,                  //Procurar na base de Pastas
                                Diversidade=ThisItem.Value,  //O projeto igual ao mencionado no botão
                                Foto_Diversidade             //Devolve a imagem da coluna desse projeto
                            )          
                        OnSelect: =Select(Parent)
                        Width: =160
                        X: =Parent.TemplateHeight*0.1
                        Y: =Parent.TemplateHeight*0.1
                        ZIndex: =2

                "FOP_N_PostoGallery_2 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    Default: =Blank()
                    DelayItemLoading: =true
                    FillPortions: =9
                    Height: =565
                    Items: |-
                        =Search(
                            Sort(
                                Distinct(  //Função para só devolver um item, indiferente da quantidade de vezes que ele aparece
                        
                                        Filter(PastasFOPs,       //Filtragem da base
                                                Usina=SelectedUsina,
                                                UET=SelectedUET, //Com os itens da UET selecionada anteriormente
                                                Diversidade = SelectedDiversity,
                                                If(SelectedUET="PRP" || SelectedUET="PK2" || SelectedUsina="CVU", Diversidade=SelectedDiversity, true)), 
                                                
                                        Posto), //E devolva só os nomes dos postos   
                                Value,
                                SortOrder.Ascending
                            ), 
                            
                            TextInput1_2.Text,
                            "Value"
                        )
                    Layout: =Layout.Vertical
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    LoadingSpinner: =LoadingSpinner.Data
                    TemplatePadding: =0
                    TemplateSize: =62
                    Visible: =PostoGalleryVisible
                    Width: =585
                    WrapCount: =2
                    Y: =82
                    ZIndex: =5

                    FOP_N_Posto_2 As button:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        Fill: =RGBA(0, 0, 0, 1)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Bold
                        Height: =Parent.TemplateHeight*0.7
                        HoverBorderColor: =RGBA(238, 235, 76, 1)
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =RGBA(238, 235, 76, 1)
                        OnSelect: |+
                            =Set(SelectedPosto, ThisItem.Value); //Define a variável com o posto selecionado
                            
                            If(SelectedUET="PRP" || SelectedUET="PK2" || SelectedUsina="CVU",
                                /*Formação do Codigo FOP com as variáveis definidas anteriormente*/
                                Set(CodigoFOP, Concatenate(SelectedUsina,"-",SelectedUET,"-",SelectedPosto,"-",SelectedDiversity));
                            
                                //Obtem-se informações da FOP da lista respectiva
                                Set(Anexos_Lista, LookUp(FOPs_SommaireContents, Codigo_FOP=CodigoFOP));
                            
                                //Define-se a variavel com o arquivo blob do PDF
                                Set(FOP_PDF, LookUp(Anexos_Lista.Anexos, EndsWith(DisplayName, ".pdf"), Value));
                            
                                Set(TabelaAfetacaoAnexos, LookUp(FOPs_TabelaAfetacao, Codigo_FOP=CodigoFOP && Validado=true));
                                Set(Table_PDF, LookUp(TabelaAfetacaoAnexos.Anexos, EndsWith(DisplayName, ".pdf"), Value));
                            
                                ClearCollect(Navettes,
                                ForAll(
                                    Filter(FOPs_Navette, Usina=SelectedUsina, UET=SelectedUET, Posto=SelectedPosto, Diversidade=SelectedDiversity),
                                        {Codigo_FOP: Codigo_FOP,
                                        Usina: Usina,
                                        UET: UET,                       
                                        Posto: Posto,
                                        Projeto: Projeto,
                                        Diversidade: Diversidade,
                                        Tipo_Navette: Tipo_Navette,
                                        Indice_FOP: Indice_FOP,
                                        Motivo_Modifficacao: Motivo_Modifficacao,
                                        Preparador: Preparador,
                                        Aprovador: Aprovador,
                                        Data_Envio: Data_Envio,
                                        Fabricacao: Fabricacao,
                                        Codigo_FOS: Codigo_FOS,
                                        FOS_Criada: FOS_Criada,
                                        Data_Modificacao_FOS: Data_Modificacao_FOS,
                                        AssinaturaPreparador: AssinaturaPreparador,
                                        AssinaturaAprovador: AssinaturaAprovador,
                                        AssinaturaFabricacao: AssinaturaFabricacao,
                                        Data_AssAprovador: Data_AssAprovador,
                                        Data_AssFabricacao: Data_AssFabricacao,
                                        Data_AssPreparador: Data_AssPreparador,
                                        Criado: Criado}
                                    )
                                );
                            
                                Set(LastFOPsGalleryVisible, false); //Deixar de mostrar as ultimas FOPs modificadas
                                Set(PDFViewVisible, true), //Mostra o visualizador de PDF
                                
                            
                            
                            // --------------------- CONDIÇÃO PADRÃO ------------------------- \\ 
                            /*Formação do Codigo FOP com as variáveis definidas anteriormente*/
                            Set(CodigoFOP, Concatenate(SelectedUsina,"-",SelectedUET,"-",SelectedPosto,"-",SelectedDiversity));
                            Set(Anexos_Lista, LookUp(FOPs_SommaireContents, Codigo_FOP=CodigoFOP));
                            Set(FOP_PDF, LookUp(Anexos_Lista.Anexos, EndsWith(DisplayName, ".pdf"), Value));
                            Set(TabelaAfetacaoAnexos, LookUp(FOPs_TabelaAfetacao, Codigo_FOP=CodigoFOP && Validado=true));
                            Set(Table_PDF, LookUp(TabelaAfetacaoAnexos.Anexos, EndsWith(DisplayName, ".pdf"), Value));
                            ClearCollect(Navettes,
                                ForAll(
                                    Filter(FOPs_Navette, Usina=SelectedUsina, UET=SelectedUET, Posto=SelectedPosto, Diversidade=SelectedDiversity),
                                        {Codigo_FOP: Codigo_FOP,
                                        Usina: Usina,
                                        UET: UET,                       
                                        Posto: Posto,
                                        Projeto: Projeto,
                                        Diversidade: Diversidade,
                                        Tipo_Navette: Tipo_Navette,
                                        Indice_FOP: Indice_FOP,
                                        Motivo_Modifficacao: Motivo_Modifficacao,
                                        Preparador: Preparador,
                                        Aprovador: Aprovador,
                                        Data_Envio: Data_Envio,
                                        Fabricacao: Fabricacao,
                                        Codigo_FOS: Codigo_FOS,
                                        FOS_Criada: FOS_Criada,
                                        Data_Modificacao_FOS: Data_Modificacao_FOS,
                                        AssinaturaPreparador: AssinaturaPreparador,
                                        AssinaturaAprovador: AssinaturaAprovador,
                                        AssinaturaFabricacao: AssinaturaFabricacao,
                                        Data_AssAprovador: Data_AssAprovador,
                                        Data_AssFabricacao: Data_AssFabricacao,
                                        Data_AssPreparador: Data_AssPreparador,
                                        Criado: Criado}
                                    )
                                );
                            Set(LastFOPsGalleryVisible, false); //Deixar de mostrar as ultimas FOPs modificadas
                            Set(PDFViewVisible, true); //Mostra o visualizador de PDF
                            );
                            UpdateContext({BtnAddDisplay: true});
                            UpdateContext({BtnRemoveDisplay: false});
                            UpdateContext({IconSelectecPointVisible: false});
                            
                            
                            
                            
                            
                            
                            
                            
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopRight: =30
                        Size: |-
                            =If(SelectedUET="PK2",
                            12,
                            15
                            )
                        Text: =ThisItem.Value
                        Width: =Parent.TemplateWidth/2
                        X: =Parent.TemplateWidth/4
                        Y: =Parent.TemplateHeight*0.15
                        ZIndex: =1

            FRP_PDF As groupContainer.verticalAutoLayoutContainer:
                BorderColor: =RGBA(0, 0, 0, 0)
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                Visible: =FRP_PDF_Visible
                Width: =Parent.Width
                X: =
                Y: =40
                ZIndex: =3

                Container92_1 As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =100
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    Width: =Parent.Width
                    ZIndex: =1

                    Logo_Renault As image:
                        Image: ='Logo Renault Branco'
                        ZIndex: =1

                    Label4 As label:
                        Align: =Align.Center
                        AlignInContainer: =AlignInContainer.Center
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderThickness: =4
                        FillPortions: =0.1
                        FontWeight: =FontWeight.Bold
                        LayoutMinWidth: =30
                        Text: =Max(FRP_Reatividades, FRP_Reatividades[@Título]) + 1
                        ZIndex: =2

                    Label2_2 As label:
                        Align: =Align.Center
                        FontWeight: =FontWeight.Bold
                        Height: =100
                        Size: =26
                        Text: ="Plano de Controle - Folha de Registro"
                        Width: =Parent.Width-Logo_Renault.Width - Modelos_1.Width
                        ZIndex: =3

                    Modelos_1 As image:
                        DisplayMode: =DisplayMode.View
                        Image: =modelos
                        Width: =200
                        ZIndex: =4

                Container93_1 As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    BorderColor: =RGBA(0, 0, 0, 0)
                    FillPortions: =0
                    Height: =100
                    LayoutMinHeight: =80
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    Width: =Parent.Width
                    ZIndex: =2

                    Container94_11 As groupContainer.verticalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        Height: =80
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =80
                        LayoutMinWidth: =90
                        LayoutMode: =LayoutMode.Auto
                        Width: =90
                        ZIndex: =2

                        Label3_11 As label:
                            Fill: =RGBA(202, 202, 202, 1)
                            FontWeight: =FontWeight.Bold
                            Text: |-
                                ="Semana:"
                            Width: =Parent.Width
                            ZIndex: =1

                        TextInput4_11 As text:
                            Align: =Align.Center
                            BorderColor: =RGBA(0, 0, 0, 0)
                            Default: =Text(WeekNum(Today()), "0")
                            FontWeight: =FontWeight.Bold
                            Width: =Parent.Width
                            ZIndex: =2

                    Container94_10 As groupContainer.verticalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        Height: =80
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =80
                        LayoutMinWidth: =90
                        LayoutMode: =LayoutMode.Auto
                        Width: =150
                        ZIndex: =3

                        Label3_10 As label:
                            Fill: =RGBA(202, 202, 202, 1)
                            FontWeight: =FontWeight.Bold
                            Text: |-
                                ="Modelo:"
                            Width: =Parent.Width
                            ZIndex: =1

                        TextInput4_10 As text:
                            Align: =Align.Center
                            BorderColor: =RGBA(0, 0, 0, 0)
                            Default: =SelectedDiversity
                            FontWeight: =FontWeight.Bold
                            Width: =90
                            ZIndex: =2

                    Container94_9 As groupContainer.verticalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        Height: =80
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =100
                        LayoutMinWidth: =60
                        LayoutMode: =LayoutMode.Auto
                        Width: =80
                        ZIndex: =4

                        Label3_9 As label:
                            Fill: =RGBA(202, 202, 202, 1)
                            FontWeight: =FontWeight.Bold
                            Text: |-
                                ="Data: " 
                            Width: =Parent.Width
                            ZIndex: =1

                        Label3_8 As label:
                            Fill: =RGBA(202, 202, 202, 1)
                            FontWeight: =FontWeight.Bold
                            Text: |-
                                ="Hora:"
                            Width: =Parent.Width
                            ZIndex: =3

                    Container94_8 As groupContainer.verticalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        Height: =80
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =100
                        LayoutMinWidth: =110
                        LayoutMode: =LayoutMode.Auto
                        Width: =130
                        ZIndex: =5

                        TextInput4_9 As text:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            Default: =Text(Today(), "[$-pt-BR]dd/mm/yyyy")
                            FontWeight: =FontWeight.Bold
                            Width: =130
                            ZIndex: =2

                        TextInput4_8 As text:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            Default: |-
                                =Text(Now(), "[$-pt-BR]hh:mm:ss")
                            FontWeight: =FontWeight.Bold
                            Width: |
                                =130
                            ZIndex: =3

                    Container94_7 As groupContainer.verticalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        Height: =80
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =100
                        LayoutMinWidth: =170
                        LayoutMode: =LayoutMode.Auto
                        Width: =230
                        ZIndex: =6

                        Label3_7 As label:
                            Fill: =RGBA(202, 202, 202, 1)
                            FontWeight: =FontWeight.Bold
                            Text: |-
                                ="Controlador:"
                            Width: =Parent.Width
                            ZIndex: =1

                        TextInput4_7 As text:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            Default: =Upper(UsuáriosdoOffice365.UserProfileV2(User().Email).givenName & " " & UsuáriosdoOffice365.UserProfileV2(User().Email).surname)
                            Fill: =RGBA(0, 0, 0, 0)
                            FontWeight: =FontWeight.Bold
                            HoverBorderColor: =RGBA(0, 0, 0, 0)
                            PressedBorderColor: =
                            Size: =10
                            Width: =Parent.Width
                            ZIndex: =2

                    Container94_6 As groupContainer.verticalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        FillPortions: =0
                        Height: =80
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =100
                        LayoutMinWidth: =50
                        LayoutMode: =LayoutMode.Auto
                        Width: =90
                        ZIndex: =7

                        Label3_6 As label:
                            Fill: =RGBA(202, 202, 202, 1)
                            FontWeight: =FontWeight.Bold
                            Text: |-
                                ="Peça/PJI:"
                            Width: =Parent.Width
                            ZIndex: =1

                        TextInput4_6 As text:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            Default: =SelectedUET
                            FontWeight: =FontWeight.Bold
                            Width: =Parent.Width
                            ZIndex: =2

                Container27 As groupContainer.horizontalAutoLayoutContainer:
                    FillPortions: =0
                    Height: =50
                    LayoutMinHeight: =50
                    LayoutMinWidth: =50
                    LayoutMode: =LayoutMode.Auto
                    ZIndex: =5

                    Label5 As label:
                        AlignInContainer: =AlignInContainer.Stretch
                        Fill: =RGBA(149, 149, 149, 1)
                        FillPortions: =1
                        FontWeight: =FontWeight.Bold
                        Text: ="Defeitos relacionados a pontos de solda detectados no controle por US"
                        ZIndex: =1

                    Label5_1 As label:
                        Align: =Align.Center
                        AlignInContainer: =AlignInContainer.Stretch
                        Fill: =RGBA(149, 149, 149, 1)
                        FillPortions: =1
                        FontWeight: =FontWeight.Bold
                        Text: ="Registro dos Defeitos"
                        ZIndex: =2

                Container91 As groupContainer.horizontalAutoLayoutContainer:
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    Width: =Parent.Width
                    ZIndex: =6

                    Codigos_erro_PDF As dataTable.datatable:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =2
                        DisplayMode: =DisplayMode.Edit
                        Fill: =RGBA(0, 0, 0, 0)
                        FillPortions: =0.5
                        FontWeight: =FontWeight.Bold
                        HeadingColor: =RGBA(0, 0, 0, 1)
                        HeadingFill: =RGBA(202, 202, 202, 1)
                        HeadingFontWeight: =FontWeight.Bold
                        Height: =450
                        HoverFill: =
                        Items: =Codigos_de_erro
                        LayoutMinHeight: =250
                        LayoutMinWidth: =400
                        SelectedFill: =RGBA(255, 255, 255, 1)
                        Size: =10
                        Width: =800
                        X: =0
                        Y: =0
                        ZIndex: =2

                        Cód_Column3 As dataTableColumn.textualColumn:
                            AutoWidth: =false
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="Cód"
                            FieldName: ="Title"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =1
                            Text: =ThisItem.ID
                            Width: =60
                            X: =0
                            Y: =0
                            ZIndex: =20

                        Descricao_Column3 As dataTableColumn.textualColumn:
                            AutoWidth: =false
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="Descricao"
                            FieldName: ="field_1"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =2
                            Text: =ThisItem.Descricao
                            Width: =234
                            X: =0
                            Y: =0
                            ZIndex: =21

                        Classe_Column3 As dataTableColumn.textualColumn:
                            AutoWidth: =false
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="Classe"
                            FieldName: ="field_2"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =3
                            Text: =ThisItem.Classe
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =22

                    lista_email_pdf As dataTable.datatable:
                        BorderColor: =RGBA(0, 0, 0, 1)
                        BorderStyle: =BorderStyle.Solid
                        BorderThickness: =2
                        DisplayMode: =DisplayMode.Edit
                        Fill: =RGBA(0, 0, 0, 0)
                        FillPortions: =0
                        FontWeight: =FontWeight.Bold
                        HeadingColor: =RGBA(0, 0, 0, 1)
                        HeadingFill: =RGBA(202, 202, 202, 1)
                        HeadingFontWeight: =FontWeight.Bold
                        Height: =500
                        HoverFill: =
                        Items: =lista_email
                        LayoutMinHeight: =250
                        LayoutMinWidth: =400
                        SelectedFill: =RGBA(255, 255, 255, 1)
                        Width: =Parent.Width-Codigos_erro_PDF.Width
                        X: =0
                        Y: =0
                        ZIndex: =3

                        PSR_Column2 As dataTableColumn.textualColumn:
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="PSR"
                            FieldName: ="PSR"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =2
                            Text: =ThisItem.PSR
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =23

                        CodigoErro_Column1 As dataTableColumn.textualColumn:
                            DisplayMode: =DisplayMode.Edit
                            FieldDisplayName: ="Erro"
                            FieldName: ="CodigoErro"
                            FieldVariantName: ="textualColumn"
                            Height: =Parent.Height
                            LayoutHeight: =Parent.Height
                            Order: =1
                            Text: =ThisItem.CodigoErro
                            Width: =100
                            X: =0
                            Y: =0
                            ZIndex: =24

                    Container91_1 As groupContainer.horizontalAutoLayoutContainer:
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        Width: =Parent.Width
                        ZIndex: =4

        FRP_Pendencias As groupContainer.horizontalAutoLayoutContainer:
            DropShadow: =DropShadow.None
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutGap: =15
            LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingBottom: =15
            PaddingLeft: =15
            PaddingRight: =15
            PaddingTop: =5
            Visible: =FOP_PEVisible_1
            Y: =12
            ZIndex: =3

            SubMainFOP_PECont_1 As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                DropShadow: =DropShadow.None
                FillPortions: =5
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =0
                LayoutMode: =LayoutMode.Auto
                ZIndex: =1

                "FOP_PE_ScreensNavigation_1 As gallery.'BrowseLayout_Horizontal_TwoTextOneImageVariant_ver5.0'":
                    Default: |-
                        =Switch(CostCenter, 
                                "GI31200", {Value: "PENDÊNCIAS"} , 
                            "GI31480", {Value: "PENDÊNCIAS"}, 
                                "GI010028", {Value: "PENDÊNCIAS"} , 
                            "GI12277", {Value: "VALIDAÇÕES"}, 
                            {Value: "HISTÓRICO"} //Usuário padrão
                        )
                    DelayItemLoading: =true
                    Height: =44
                    Items: |
                        =Switch(CostCenter, //Definições de centros de Custo passadas por ISRAEL SANTOS
                        
                            "GI31200" , ["PENDÊNCIAS","HISTÓRICOS"], //PE VE Processo
                            "GI010028" , ["PENDÊNCIAS","HISTÓRICOS"], 
                            "GI31480" , ["PENDÊNCIAS","HISTÓRICOS", "VALIDAÇÕES"], //MATHEUS
                            "GI12277" , ["PENDÊNCIAS","HISTÓRICOS", "VALIDAÇÕES"], // ADRIANO ARAUJO
                            "GI12201" , ["PENDÊNCIAS","HISTÓRICOS", "VALIDAÇÕES"], // guilherme carroceria inteira
                        
                            ["HISTÓRICOS"]
                        )
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    LoadingSpinner: =LoadingSpinner.Data
                    TemplatePadding: =0
                    TemplateSize: =Parent.Width/CountRows(Self.AllItems)-1
                    Width: =739
                    X: =10
                    Y: =4
                    ZIndex: =1

                    FOP_PE_SelectedScreen_2 As rectangle:
                        Fill: =RGBA(239, 223, 0, 1)
                        Height: =Parent.TemplateHeight*0.08
                        OnSelect: =Select(Parent)
                        Visible: =ThisItem.IsSelected
                        Width: =Len(ThisItem.Value)*10
                        X: =(Parent.TemplateWidth - Len(ThisItem.Value)*10)/2
                        Y: =Parent.TemplateHeight*0.77
                        ZIndex: =1

                    FOP_PE_ScreenName_2 As button:
                        Color: =RGBA(0, 0, 0, 1)
                        Fill: =RGBA(0, 0, 0, 0)
                        Font: =Font.Arial
                        FontWeight: =If(ThisItem.IsSelected, FontWeight.Bold, FontWeight.Semibold)
                        Height: =Parent.TemplateHeight-5
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =ColorFade(RGBA(56, 96, 178, 0), -20%)
                        OnSelect: |+
                            =Select(Parent);
                            Reset(Input_num_reatividade);
                            Reset(StartDate);
                            Reset(EndDate);
                            
                            Switch(ThisItem.Value,
                            
                                "PENDÊNCIAS", Refresh(FRP_Reatividades);Refresh(FRP_PSR_Reatividade);Set(DetailedReportView, false); Set(PDFViewVisible, false);Set(FRP_Pendencias_Visible, true),
                                "HISTÓRICOS", Refresh(FRP_PSR_Reatividade);Set(DetailedReportView, false); Set(PDFViewVisible, false); Set(FRP_Historicos_Visible, true),
                                "VALIDAÇÕES", Refresh(FRP_Reatividades);Set(DetailedReportView, false); Set(PDFViewVisible, false); Set(FRP_Validacoes_Visible, true)
                            );
                            
                        PressedBorderColor: =RGBA(166, 166, 166, 0)
                        PressedColor: =RGBA(0, 0, 0, 1)
                        PressedFill: =RGBA(0, 0, 0, 0)
                        Size: =12
                        Text: =ThisItem.Value
                        Width: =Parent.TemplateWidth
                        X: =Parent.TemplateWidth*0
                        ZIndex: =2

                FOP_GalleryCont_1 As groupContainer.verticalAutoLayoutContainer:
                    DropShadow: =DropShadow.None
                    Fill: =RGBA(217, 217, 214, 1)
                    FillPortions: =15
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutGap: =15
                    LayoutJustifyContent: =LayoutJustifyContent.Center
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =10
                    PaddingLeft: =10
                    PaddingRight: =10
                    PaddingTop: =5
                    ZIndex: =3

                    "FRP_Reatividades_Pendencias As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                        Default: =Blank()
                        DelayItemLoading: =true
                        FillPortions: =13
                        Height: =480
                        Items: |+
                            =Sort(
                                Filter(FRP_Reatividades, Status = "Aberto" && Responsavel = User().Email),
                                Data_Criacao,
                                SortOrder.Descending
                            )
                            
                            
                        Layout: =Layout.Vertical
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        LoadingSpinner: =LoadingSpinner.Data
                        Selectable: =true 
                        TemplatePadding: =0
                        TemplateSize: =Parent.Height/5
                        Visible: |-
                            =FOP_PE_ScreensNavigation_1.Selected.Value="PENDÊNCIAS" &&
                            FRP_Pendencias_Visible
                        Width: =655
                        X: =53
                        Y: =71
                        ZIndex: =1

                        FOP_APE_Separator_5 As rectangle:
                            Height: =2
                            OnSelect: =Parent.TemplateHeight
                            Width: =Parent.TemplateWidth
                            Y: =Parent.TemplateHeight
                            ZIndex: =5

                        Container7_4 As groupContainer.horizontalAutoLayoutContainer:
                            DropShadow: =DropShadow.None
                            Height: =Parent.TemplateHeight
                            LayoutMode: =LayoutMode.Auto
                            Width: =Parent.TemplateWidth
                            ZIndex: =11

                            Container22_2 As groupContainer.verticalAutoLayoutContainer:
                                DropShadow: =DropShadow.None
                                FillPortions: =2
                                LayoutDirection: =LayoutDirection.Vertical
                                LayoutMinHeight: =0
                                LayoutMinWidth: =0
                                LayoutMode: =LayoutMode.Auto
                                ZIndex: =1

                                FRP_Hist_Status_1 As label:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    FillPortions: =1
                                    Font: =Font.Arial
                                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                    Height: =25
                                    LayoutMinHeight: =0
                                    LayoutMinWidth: =0
                                    OnSelect: |
                                        =
                                    PaddingBottom: =0
                                    PaddingLeft: =0
                                    PaddingRight: =0
                                    PaddingTop: =0
                                    Text: |-
                                        ="Status: " & ThisItem.Status
                                    VerticalAlign: =VerticalAlign.Top
                                    Width: =430
                                    ZIndex: =1

                                FRP_Hist_Local_1 As label:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    FillPortions: =1
                                    Font: =Font.Arial
                                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                    Height: =Self.Size
                                    LayoutMinHeight: =0
                                    LayoutMinWidth: =0
                                    OnSelect: =
                                    PaddingBottom: =0
                                    PaddingLeft: =0
                                    PaddingRight: =0
                                    PaddingTop: =0
                                    Size: =10
                                    Text: |-
                                        ="Localidade: " & ThisItem.Usina & "-" & ThisItem.UET & "-" & ThisItem.Diversidade
                                    VerticalAlign: =VerticalAlign.Top
                                    Width: =Parent.Width
                                    X: =1
                                    Y: =25
                                    ZIndex: =2

                                FRP_Hist_ID As label:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    FillPortions: =1
                                    Font: =Font.Arial
                                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                    Height: =45
                                    LayoutMinHeight: =0
                                    LayoutMinWidth: =0
                                    OnSelect: =
                                    PaddingBottom: =0
                                    PaddingLeft: =0
                                    PaddingRight: =0
                                    PaddingTop: =0
                                    Size: =10
                                    Text: |
                                        =
                                        "Nº Reatividade: " & ThisItem.Título
                                    VerticalAlign: =VerticalAlign.Top
                                    Width: =360
                                    Y: =45
                                    ZIndex: =3

                                FRP_Hist_Data As label:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    FillPortions: =1
                                    Font: =Font.Arial
                                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                    Height: =45
                                    LayoutMinHeight: =0
                                    LayoutMinWidth: =0
                                    OnSelect: =
                                    PaddingBottom: =0
                                    PaddingLeft: =0
                                    PaddingRight: =0
                                    PaddingTop: =0
                                    Size: =10
                                    Text: |
                                        =
                                        "Data da criação: " & ThisItem.Data_Criacao
                                    VerticalAlign: =VerticalAlign.Top
                                    Width: =360
                                    Y: =45
                                    ZIndex: =4

                            Container9_4 As groupContainer.verticalAutoLayoutContainer:
                                DropShadow: =DropShadow.None
                                FillPortions: =2
                                LayoutDirection: =LayoutDirection.Vertical
                                LayoutMinHeight: =0
                                LayoutMinWidth: =0
                                LayoutMode: =LayoutMode.Auto
                                PaddingRight: =10
                                ZIndex: =3

                                Rectangle19_1 As rectangle:
                                    AlignInContainer: =AlignInContainer.End
                                    Fill: =RGBA(0, 0, 0, 0)
                                    FillPortions: =0.8
                                    LayoutMinHeight: =10
                                    ZIndex: =1

                                FRP_btn_Detail_Pendencia As icon.ChevronRight:
                                    AccessibleLabel: =Self.Tooltip
                                    AlignInContainer: =AlignInContainer.End
                                    FillPortions: =1
                                    Height: =30
                                    Icon: =Icon.View
                                    LayoutMinHeight: =0
                                    LayoutMinWidth: =0
                                    OnSelect: |-
                                        =Set(FRP_Pendencias_Visible, false);
                                        Set(DetailedReportView, true);
                                        Set(varFRP, ThisItem.Título);
                                        Set(LastFOPsGalleryVisible, false); //Deixar de mostrar as ultimas FOPs modificadas
                                        Set(PDFViewVisible, true); //Mostra o visualizador de PDF
                                    PaddingBottom: =16
                                    PaddingLeft: =16
                                    PaddingRight: =16
                                    PaddingTop: =16
                                    Tooltip: ="DETALHAR REATIVIDADE"
                                    Width: =Parent.Width/5
                                    X: =196
                                    Y: =
                                    ZIndex: =2

                                Rectangle19 As rectangle:
                                    AlignInContainer: =AlignInContainer.End
                                    Fill: =RGBA(0, 0, 0, 0)
                                    FillPortions: =0.8
                                    LayoutMinHeight: =10
                                    ZIndex: =3

                            FOP_APE_SelectedItem_5 As rectangle:
                                Fill: =RGBA(239, 223, 0, 1)
                                Height: =Parent.Height
                                OnSelect: =
                                Visible: =ThisItem.IsSelected
                                Width: =20
                                X: =620
                                ZIndex: =4

                    FRP_ViewDetailed_Report As groupContainer.verticalAutoLayoutContainer:
                        FillPortions: =13
                        Height: =Parent.Height
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Visible: =DetailedReportView
                        Width: =Parent.Width
                        ZIndex: =2

                        "Gallery6 As gallery.'BrowseLayout_Vertical_TwoTextVariant_ver5.0'":
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            DelayItemLoading: =true
                            Items: =Filter(FRP_PSR_Reatividade, varFRP = FRP_PSR_Reatividade[@Título])
                            Layout: =Layout.Vertical
                            LayoutMinHeight: =287
                            LayoutMinWidth: =320
                            LoadingSpinner: =LoadingSpinner.Data
                            TemplatePadding: =0
                            TemplateSize: =90
                            Width: =Parent.Width
                            ZIndex: =1

                            Title13 As label:
                                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                Height: =Self.Size * 1.8
                                OnSelect: =Select(Parent)
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Text: =ThisItem.PSR
                                VerticalAlign: =VerticalAlign.Top
                                Width: =Parent.TemplateWidth - 86
                                X: =16
                                Y: =(Parent.TemplateHeight - (Self.Size * 1.8 + Subtitle9.Size * 4)) / 2
                                ZIndex: =1

                            Subtitle9 As label:
                                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                Height: =Self.Size * 1.8
                                OnSelect: =Select(Parent)
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Text: |-
                                    ="Nº FOP: " & ThisItem.Codigo_FOP & "-" & ThisItem.Indice_FOP
                                VerticalAlign: =VerticalAlign.Top
                                Width: =Title13.Width
                                X: =Title13.X
                                Y: =Title13.Y + Title13.Height
                                ZIndex: =2

                            NextArrow11 As icon.ChevronRight:
                                AccessibleLabel: =Self.Tooltip
                                Color: =RGBA(0, 0, 0, 1)
                                Height: =50
                                Icon: =Icon.ChevronRight
                                OnSelect: |
                                    =Set(FOP_PDF, Blank());
                                    Select(Parent);
                                    Set(view_error_detail, true);
                                    Set(enable_validation_send, true);
                                    ClearCollect(CodigosErroSeparados, Split(ThisItem.Codigo_Erro, ", "));
                                    
                                    // --------------------- CONDIÇÃO PADRÃO ------------------------- \\ 
                                    /*Formação do Codigo FOP com as variáveis definidas anteriormente*/
                                    Set(CodigoFOP, ThisItem.Codigo_FOP);
                                    Set(Anexos_Lista, LookUp(FOPs_SommaireContents, Codigo_FOP=CodigoFOP));
                                    Set(FOP_PDF, LookUp(Anexos_Lista.Anexos, EndsWith(DisplayName, ".pdf"), Value));
                                    ClearCollect(Navettes,
                                        ForAll(
                                            Filter(FOPs_Navette, Usina=SelectedUsina, UET=SelectedUET, Posto=SelectedPosto, Diversidade=SelectedDiversity),
                                                {Codigo_FOP: Codigo_FOP,
                                                Usina: Usina,
                                                UET: UET,                       
                                                Posto: Posto,
                                                Projeto: Projeto,
                                                Diversidade: Diversidade,
                                                Indice_FOP: Indice_FOP,
                                                Criado: Criado}
                                            )
                                        );
                                    Set(LastFOPsGalleryVisible, false); //Deixar de mostrar as ultimas FOPs modificadas
                                    Set(PDFViewVisible, true); //Mostra o visualizador de PDF
                                PaddingBottom: =16
                                PaddingLeft: =16
                                PaddingRight: =16
                                PaddingTop: =16
                                Tooltip: ="Exibir detalhes do item"
                                Width: =50
                                X: =Parent.TemplateWidth - Self.Width - 12
                                Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
                                ZIndex: =3

                            Separator12 As rectangle:
                                Height: =8
                                OnSelect: =Select(Parent)
                                Width: =Parent.TemplateWidth
                                Y: =Parent.TemplateHeight - Self.Height
                                ZIndex: =4

                            Rectangle27 As rectangle:
                                Fill: =RGBA(239, 223, 0, 1)
                                Height: =Parent.TemplateHeight - Separator12.Height
                                OnSelect: =Select(Parent)
                                Visible: =ThisItem.IsSelected
                                Width: =4
                                ZIndex: =5

                            Subtitle9_1 As label:
                                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                Height: =Self.Size * 1.8
                                OnSelect: =Select(Parent)
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Text: |-
                                    ="Página do Ponto: " & ThisItem.Pagina_Ponto
                                VerticalAlign: =VerticalAlign.Top
                                Width: =Title13.Width
                                X: =Title13.X
                                Y: =Subtitle9.Y + Subtitle9.Height
                                ZIndex: =6

                            Label3 As label:
                                Align: =Align.Center
                                Font: =Font.Arial
                                FontWeight: =FontWeight.Semibold
                                Height: =NextArrow11.Height*1.1
                                OnSelect: =Select(Parent)
                                Text: =If(FOP_PE_ScreensNavigation_1.Selected.Value="VALIDAÇÕES","VER REATIVIDADE E PRÉ ANALISE","VER FOP E DEFEITOS")
                                X: =NextArrow11.X*0.8
                                Y: =NextArrow11.Y
                                ZIndex: =7

                        Container29 As groupContainer.horizontalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            DropShadow: =DropShadow.None
                            FillPortions: =0
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            LayoutMode: =LayoutMode.Auto
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Visible: |-
                                =FOP_PE_ScreensNavigation_1.Selected.Value <> "HISTÓRICOS" &&
                                DetailedReportView
                            Width: =Parent.Width
                            ZIndex: =5

                            FRP_CommentCont_1 As groupContainer.verticalAutoLayoutContainer:
                                DropShadow: =DropShadow.None
                                FillPortions: =2
                                Height: =Parent.Height
                                LayoutAlignItems: =LayoutAlignItems.Center
                                LayoutDirection: =LayoutDirection.Vertical
                                LayoutJustifyContent: =LayoutJustifyContent.Center
                                LayoutMinHeight: =100
                                LayoutMinWidth: =250
                                LayoutMode: =LayoutMode.Auto
                                PaddingBottom: =10
                                PaddingLeft: =30
                                PaddingRight: =30
                                PaddingTop: =5
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Visible: |-
                                    =FOP_PE_ScreensNavigation_1.Selected.Value <> "HISTÓRICOS" &&
                                    DetailedReportView
                                Width: =Parent.Width
                                ZIndex: =1

                                FRP_Comment_Label_1 As label:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    Color: =RGBA(0, 0, 0, 1)
                                    FillPortions: =1
                                    Font: =Font.Arial
                                    Height: =20
                                    LayoutMinHeight: =0
                                    LayoutMinWidth: =0
                                    Size: =12
                                    Text: ="Descrição da Reatividade"
                                    Width: =119
                                    Wrap: =false
                                    X: =30
                                    Y: =10
                                    ZIndex: =1

                                FRP_Comments_1 As text:
                                    BorderColor: =
                                    BorderThickness: =1
                                    Default: =
                                    DelayOutput: =true
                                    DisplayMode: =Parent.DisplayMode
                                    Fill: =RGBA(0, 0, 0, 0)
                                    FillPortions: =1.7
                                    Font: =Font.Arial
                                    Height: =176
                                    HoverBorderColor: =RGBA(136, 139, 141, 1)
                                    HoverFill: =RGBA(187, 188, 188, 1)
                                    LayoutMinWidth: =0
                                    Mode: =TextMode.MultiLine
                                    PaddingLeft: =5
                                    RadiusBottomLeft: =0
                                    RadiusBottomRight: =0
                                    RadiusTopLeft: =0
                                    RadiusTopRight: =0
                                    Size: =11
                                    Tooltip: =
                                    Width: =Parent.Width*0.9
                                    X: =5
                                    Y: =FRP_Comment_Label_1.Y + FRP_Comment_Label_1.Height + 5
                                    ZIndex: =2

                            Container30 As groupContainer.verticalAutoLayoutContainer:
                                DropShadow: =DropShadow.None
                                LayoutDirection: =LayoutDirection.Vertical
                                LayoutMinHeight: =100
                                LayoutMinWidth: =0
                                LayoutMode: =LayoutMode.Auto
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                ZIndex: =4

                                FRP_Comment_Label_2 As label:
                                    AlignInContainer: =AlignInContainer.Stretch
                                    Color: =RGBA(0, 0, 0, 1)
                                    FillPortions: =0.5
                                    Font: =Font.Arial
                                    Height: =20
                                    LayoutMinHeight: =0
                                    LayoutMinWidth: =0
                                    Size: =12
                                    Text: ="Anexos"
                                    Width: =119
                                    Wrap: =false
                                    X: =30
                                    Y: =10
                                    ZIndex: =1

                                Form1 As form:
                                    DataSource: =FRP_Reatividades
                                    Height: =Parent.Height
                                    Item: =Defaults(FRP_Reatividades)
                                    LayoutMinHeight: =2
                                    LayoutMinWidth: =0
                                    Visible: =DetailedReportView
                                    Width: =Parent.Width
                                    ZIndex: =2

                                    Anexos_DataCard1 As typedDataCard.attachmentsEditCard:
                                        BorderColor: =RGBA(0, 0, 0, 1)
                                        BorderStyle: =BorderStyle.Solid
                                        DataField: ="{Attachments}"
                                        Default: =ThisItem.Anexos
                                        DisplayMode: =Parent.DisplayMode
                                        DisplayName: =DataSourceInfo([@FRP_Reatividades],DataSourceInfo.DisplayName,"{Attachments}")
                                        Fill: =RGBA(0, 0, 0, 0)
                                        Height: =Parent.Height*0.95
                                        Required: =false
                                        Update: =DataCardValue10.Attachments
                                        Width: =399
                                        WidthFit: =true
                                        X: =0
                                        Y: =0
                                        ZIndex: =3

                                        DataCardValue10 As attachments:
                                            BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                                            BorderThickness: =1
                                            DisplayMode: =Parent.DisplayMode
                                            Fill: =RGBA(0, 0, 0, 0)
                                            Font: =Font.Arial
                                            Height: =Parent.Height*0.95
                                            IsInDataCard: =true
                                            Items: =Parent.Default
                                            PaddingBottom: =5
                                            PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                                            PaddingRight: =5
                                            PaddingTop: =5
                                            Tooltip: =Parent.DisplayName
                                            Width: =Parent.Width - 60
                                            X: =30
                                            ZIndex: =2

                    FRP_Historico_Cont As groupContainer.verticalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        FillPortions: =13
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        LayoutMode: =LayoutMode.Auto
                        Visible: =FOP_PE_ScreensNavigation_1.Selected.Value="HISTÓRICOS" && !DetailedReportView
                        ZIndex: =3

                        FRP_Historico_Filtro As groupContainer.horizontalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            DropShadow: =DropShadow.None
                            LayoutAlignItems: =LayoutAlignItems.Center
                            LayoutMinHeight: =0
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            Visible: =FRP_Historicos_Visible
                            Width: =Parent.Width
                            ZIndex: =1

                            FOP_HistoricalLabel_2 As label:
                                FillPortions: =1.2
                                Font: =Font.Arial
                                FontWeight: =FontWeight.Bold
                                Height: =38
                                LayoutMinHeight: =0
                                LayoutMinWidth: =0
                                Size: =18
                                Text: ="Histórico"
                                Visible: =FOP_PE_ScreensNavigation_1.Selected.Value="HISTÓRICOS"
                                Width: =200
                                X: =44
                                Y: =55
                                ZIndex: =1

                            Icon2 As icon.FilterFlat:
                                Color: =RGBA(0, 0, 0, 1)
                                Height: =Parent.Height
                                Icon: =Icon.FilterFlat
                                OnSelect: =Set(view_calendar_filter,true)
                                Tooltip: ="FILTRAR DADOS"
                                ZIndex: =2

                            FOP_HistoricalFOPLabel_2 As label:
                                Align: =Align.Right
                                FillPortions: =5
                                Font: =Font.Arial
                                FontWeight: =FontWeight.Semibold
                                Height: =38
                                LayoutMinHeight: =0
                                LayoutMinWidth: =0
                                Size: =16
                                Text: |-
                                    ="FOP Nº: " & CodigoFOP
                                Visible: =FOP_PE_ScreensNavigation_1.Selected.Value="HISTÓRICOS"
                                Width: =500
                                X: =158
                                Y: =55
                                ZIndex: =3

                        "FRP_Historico_Reatividades As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                            AlignInContainer: =AlignInContainer.SetByContainer
                            DelayItemLoading: =true
                            FillPortions: =17
                            Height: =Parent.Height
                            Items: |
                                =Sort(
                                    Filter(
                                        FRP_Reatividades,
                                        (IsBlank(SelectedUET) || Usina = SelectedUsina) && 
                                        (IsBlank(SelectedDiversity) || Diversidade = SelectedDiversity) && 
                                        (IsBlank(StartDate) || IsBlank(EndDate) || 
                                            (Data_Criacao >= StartDate.SelectedDate && 
                                            Data_Criacao <= DateAdd(EndDate.SelectedDate, 1))) && 
                                        (IsBlank(Input_num_reatividade.Text) || Título = Input_num_reatividade.Text)
                                    ),
                                    Data_Criacao,
                                    SortOrder.Descending
                                )
                            Layout: =Layout.Vertical
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            LoadingSpinner: =LoadingSpinner.Data
                            TemplatePadding: =0
                            TemplateSize: =104
                            Visible: =FOP_PE_ScreensNavigation_1.Selected.Value="HISTÓRICOS" && FRP_Historicos_Visible
                            Width: =Parent.Width
                            X: =
                            Y: =93
                            ZIndex: =3

                            FOP_PH_Separator_3 As rectangle:
                                Height: =2
                                OnSelect: =Select(Parent)
                                Width: =Parent.TemplateWidth
                                Y: =102
                                ZIndex: =5

                            Container21_2 As groupContainer.horizontalAutoLayoutContainer:
                                DropShadow: =DropShadow.None
                                Height: =Parent.TemplateHeight
                                LayoutMode: =LayoutMode.Auto
                                PaddingBottom: =5
                                PaddingRight: =15
                                PaddingTop: =5
                                Width: =Parent.TemplateWidth
                                ZIndex: =12

                                Container22_3 As groupContainer.verticalAutoLayoutContainer:
                                    DropShadow: =DropShadow.None
                                    FillPortions: =2
                                    LayoutDirection: =LayoutDirection.Vertical
                                    LayoutMinHeight: =0
                                    LayoutMinWidth: =0
                                    LayoutMode: =LayoutMode.Auto
                                    ZIndex: =1

                                    FRP_Hist_Status_2 As label:
                                        AlignInContainer: =AlignInContainer.Stretch
                                        FillPortions: =1
                                        Font: =Font.Arial
                                        FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                        Height: =25
                                        LayoutMinHeight: =0
                                        LayoutMinWidth: =0
                                        OnSelect: |
                                            =
                                        PaddingBottom: =0
                                        PaddingLeft: =0
                                        PaddingRight: =0
                                        PaddingTop: =0
                                        Text: |-
                                            ="Status: " & ThisItem.Status
                                            
                                            //LookUp(relacao_ids_reatividades; ThisItem.Título in relacao_ids_reatividades[@Título]; relacao_ids_reatividades[@Status])
                                        VerticalAlign: =VerticalAlign.Top
                                        Width: =430
                                        ZIndex: =1

                                    FRP_Hist_Local_2 As label:
                                        AlignInContainer: =AlignInContainer.Stretch
                                        FillPortions: =1
                                        Font: =Font.Arial
                                        FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                        Height: =Self.Size * 1.8
                                        LayoutMinHeight: =0
                                        LayoutMinWidth: =0
                                        OnSelect: =
                                        PaddingBottom: =0
                                        PaddingLeft: =0
                                        PaddingRight: =0
                                        PaddingTop: =0
                                        Size: =10
                                        Text: |-
                                            ="Nº FOP: " & ThisItem.UET & "-" & ThisItem.Usina & "-" & ThisItem.Diversidade
                                        VerticalAlign: =VerticalAlign.Top
                                        Width: =Parent.Width
                                        X: =1
                                        Y: =25
                                        ZIndex: =2

                                    FRP_Hist_PSR_1 As label:
                                        AlignInContainer: =AlignInContainer.Stretch
                                        FillPortions: =1
                                        Font: =Font.Arial
                                        FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                        Height: =45
                                        LayoutMinHeight: =0
                                        LayoutMinWidth: =0
                                        OnSelect: =
                                        PaddingBottom: =0
                                        PaddingLeft: =0
                                        PaddingRight: =0
                                        PaddingTop: =0
                                        Size: =10
                                        Text: |-
                                            ="Nº Pontos reportados: " & CountIf(FRP_PSR_Reatividade, ThisItem.Título = FRP_PSR_Reatividade[@Título])
                                        VerticalAlign: =VerticalAlign.Top
                                        Width: =360
                                        Y: =45
                                        ZIndex: =3

                                    FOP_PH_Date_3 As label:
                                        AlignInContainer: =AlignInContainer.Stretch
                                        FillPortions: =1
                                        Font: =Font.Arial
                                        Height: =25
                                        LayoutMinHeight: =0
                                        LayoutMinWidth: =0
                                        OnSelect: =
                                        PaddingBottom: =0
                                        PaddingLeft: =0
                                        PaddingRight: =0
                                        PaddingTop: =0
                                        Size: =10
                                        Text: |-
                                            ="Número da Reatividade: " & ThisItem.Título
                                        Width: =175
                                        ZIndex: =4

                                Container33_2 As groupContainer.verticalAutoLayoutContainer:
                                    DropShadow: =DropShadow.None
                                    FillPortions: =1.3
                                    LayoutDirection: =LayoutDirection.Vertical
                                    LayoutMinHeight: =0
                                    LayoutMinWidth: =0
                                    LayoutMode: =LayoutMode.Auto
                                    PaddingRight: =10
                                    ZIndex: =2

                                    Icon3 As icon.View:
                                        AlignInContainer: =AlignInContainer.End
                                        Color: =RGBA(0, 0, 0, 1)
                                        FillPortions: =0.2
                                        Icon: =Icon.View
                                        LayoutMinHeight: =30
                                        OnSelect: |-
                                            =Set(FRP_Historicos_Visible, false);
                                            Set(DetailedReportView, true);
                                            Set(varFRP, ThisItem.Título);
                                            Set(LastFOPsGalleryVisible, false); //Deixar de mostrar as ultimas FOPs modificadas
                                            Set(PDFViewVisible, true); //Mostra o visualizador de PDF
                                        Width: =30
                                        ZIndex: =1

                                    FRP_Hist_Data_Criacao_1 As label:
                                        Align: =Align.Right
                                        AlignInContainer: =AlignInContainer.Stretch
                                        FillPortions: =1
                                        Font: =Font.Arial
                                        FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                        Height: =25
                                        LayoutMinHeight: =0
                                        OnSelect: =
                                        PaddingBottom: =0
                                        PaddingLeft: =0
                                        PaddingRight: =0
                                        PaddingTop: =0
                                        Text: |-
                                            ="Data Criação: " & ThisItem.Data_Criacao
                                        VerticalAlign: =VerticalAlign.Top
                                        Width: =175
                                        Y: =18
                                        ZIndex: =3

                                    FRP_Hist_Data_Fechamento_1 As label:
                                        Align: =Align.Right
                                        AlignInContainer: =AlignInContainer.Stretch
                                        FillPortions: =
                                        Font: =Font.Arial
                                        FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                        Height: =25
                                        LayoutMinHeight: =0
                                        OnSelect: =
                                        PaddingBottom: =0
                                        PaddingLeft: =0
                                        PaddingRight: =0
                                        PaddingTop: =0
                                        Text: |-
                                            =// Se a reatividade tiver valor Fechado mostra a data de fechamento
                                            If(
                                                ThisItem.Status = "Fechado",
                                                "Data Fechamento: " & ThisItem.Data_Fechamento
                                            )
                                        VerticalAlign: =VerticalAlign.Top
                                        Width: =175
                                        Y: =18
                                        ZIndex: =4

                                FOP_PH_ActualStatus_3 As rectangle:
                                    Fill: =RGBA(239, 223, 0, 1)
                                    Height: =Parent.Height
                                    OnSelect: =
                                    Visible: =ThisItem.IsSelected
                                    Width: =20
                                    ZIndex: =4

                    FRP_Validacoes_cont As groupContainer.verticalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        FillPortions: =13
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        LayoutMode: =LayoutMode.Auto
                        Visible: =FOP_PE_ScreensNavigation_1.Selected.Value="VALIDAÇÕES" && !DetailedReportView
                        ZIndex: =4

                        FOP_MHC_Labels_3 As groupContainer.horizontalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            DropShadow: =DropShadow.None
                            LayoutAlignItems: =LayoutAlignItems.Center
                            LayoutMinHeight: =0
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            Visible: =FRP_Validacoes_Visible
                            Width: =Parent.Width
                            ZIndex: =1

                            FOP_HistoricalLabel_4 As label:
                                AlignInContainer: =AlignInContainer.Stretch
                                FillPortions: =1.2
                                Font: =Font.Arial
                                FontWeight: =FontWeight.Bold
                                Height: =38
                                LayoutMinHeight: =0
                                LayoutMinWidth: =0
                                Size: =18
                                Text: ="Validações"
                                Visible: =FOP_PE_ScreensNavigation_1.Selected.Value="VALIDAÇÕES"
                                Width: =200
                                X: =44
                                Y: =55
                                ZIndex: =1

                            Icon2_1 As icon.FilterFlat:
                                Color: =RGBA(0, 0, 0, 1)
                                Height: =Parent.Height
                                Icon: =Icon.FilterFlat
                                OnSelect: =Set(view_calendar_filter,true)
                                Tooltip: ="FILTRAR DADOS"
                                ZIndex: =2

                        "FRP_Validacoes_Reatividades As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                            AlignInContainer: =AlignInContainer.SetByContainer
                            DelayItemLoading: =true
                            FillPortions: =17
                            Height: =Parent.Width
                            Items: |
                                =Sort(
                                    Filter(
                                        FRP_Reatividades,
                                        (IsBlank(SelectedUET) || Usina = SelectedUsina) && 
                                        (IsBlank(SelectedDiversity) || Diversidade = SelectedDiversity) && 
                                        (IsBlank(StartDate) || IsBlank(EndDate) || 
                                            (Data_Criacao >= StartDate.SelectedDate && 
                                            Data_Criacao <= DateAdd(EndDate.SelectedDate, 1))) && 
                                        (IsBlank(Input_num_reatividade.Text) || Título = Input_num_reatividade.Text)
                                    ),
                                    Data_Criacao,
                                    SortOrder.Descending
                                )
                            Layout: =Layout.Vertical
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            LoadingSpinner: =LoadingSpinner.Data
                            TemplatePadding: =0
                            TemplateSize: =104
                            Visible: =FOP_PE_ScreensNavigation_1.Selected.Value="VALIDAÇÕES" && FRP_Validacoes_Visible
                            Width: =Parent.Width
                            X: =776
                            Y: =93
                            ZIndex: =2

                            FOP_PH_Separator_4 As rectangle:
                                Height: =2
                                OnSelect: =Select(Parent)
                                Width: =Parent.TemplateWidth
                                Y: =102
                                ZIndex: =5

                            Container21_3 As groupContainer.horizontalAutoLayoutContainer:
                                DropShadow: =DropShadow.None
                                Height: =Parent.TemplateHeight
                                LayoutMode: =LayoutMode.Auto
                                PaddingBottom: =5
                                PaddingRight: =15
                                PaddingTop: =5
                                Width: =Parent.TemplateWidth
                                ZIndex: =12

                                Container22_4 As groupContainer.verticalAutoLayoutContainer:
                                    DropShadow: =DropShadow.None
                                    FillPortions: =2
                                    LayoutDirection: =LayoutDirection.Vertical
                                    LayoutMinHeight: =0
                                    LayoutMinWidth: =0
                                    LayoutMode: =LayoutMode.Auto
                                    ZIndex: =1

                                    FRP_Hist_Status_3 As label:
                                        AlignInContainer: =AlignInContainer.Stretch
                                        FillPortions: =1
                                        Font: =Font.Arial
                                        FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                        Height: =25
                                        LayoutMinHeight: =0
                                        LayoutMinWidth: =0
                                        OnSelect: |
                                            =
                                        PaddingBottom: =0
                                        PaddingLeft: =0
                                        PaddingRight: =0
                                        PaddingTop: =0
                                        Text: |-
                                            ="Status: " & ThisItem.Status
                                            
                                            //LookUp(relacao_ids_reatividades; ThisItem.Título in relacao_ids_reatividades[@Título]; relacao_ids_reatividades[@Status])
                                        VerticalAlign: =VerticalAlign.Top
                                        Width: =430
                                        ZIndex: =1

                                    FRP_Hist_Local_3 As label:
                                        AlignInContainer: =AlignInContainer.Stretch
                                        FillPortions: =1
                                        Font: =Font.Arial
                                        FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                        Height: =Self.Size * 1.8
                                        LayoutMinHeight: =0
                                        LayoutMinWidth: =0
                                        OnSelect: =
                                        PaddingBottom: =0
                                        PaddingLeft: =0
                                        PaddingRight: =0
                                        PaddingTop: =0
                                        Size: =10
                                        Text: |-
                                            ="Nº FOP: " & ThisItem.UET & "-" & ThisItem.Usina & "-" & ThisItem.Diversidade
                                        VerticalAlign: =VerticalAlign.Top
                                        Width: =Parent.Width
                                        X: =1
                                        Y: =25
                                        ZIndex: =2

                                    FRP_Hist_PSR_2 As label:
                                        AlignInContainer: =AlignInContainer.Stretch
                                        FillPortions: =1
                                        Font: =Font.Arial
                                        FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                        Height: =45
                                        LayoutMinHeight: =0
                                        LayoutMinWidth: =0
                                        OnSelect: =
                                        PaddingBottom: =0
                                        PaddingLeft: =0
                                        PaddingRight: =0
                                        PaddingTop: =0
                                        Size: =10
                                        Text: |-
                                            ="Nº Pontos reportados: " & CountIf(FRP_PSR_Reatividade, ThisItem.Título = FRP_PSR_Reatividade[@Título])
                                        VerticalAlign: =VerticalAlign.Top
                                        Width: =360
                                        Y: =45
                                        ZIndex: =3

                                    FOP_PH_Date_4 As label:
                                        AlignInContainer: =AlignInContainer.Stretch
                                        FillPortions: =1
                                        Font: =Font.Arial
                                        FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                        Height: =25
                                        LayoutMinHeight: =0
                                        LayoutMinWidth: =0
                                        OnSelect: =
                                        PaddingBottom: =0
                                        PaddingLeft: =0
                                        PaddingRight: =0
                                        PaddingTop: =0
                                        Size: =10
                                        Text: |-
                                            ="Número da Reatividade: " & ThisItem.Título
                                        Width: =175
                                        ZIndex: =4

                                Container33_3 As groupContainer.verticalAutoLayoutContainer:
                                    DropShadow: =DropShadow.None
                                    FillPortions: =1.3
                                    LayoutDirection: =LayoutDirection.Vertical
                                    LayoutMinHeight: =0
                                    LayoutMinWidth: =0
                                    LayoutMode: =LayoutMode.Auto
                                    PaddingRight: =10
                                    ZIndex: =2

                                    Icon3_1 As icon.View:
                                        AlignInContainer: =AlignInContainer.End
                                        Color: =RGBA(0, 0, 0, 1)
                                        FillPortions: =0.2
                                        Icon: =Icon.View
                                        LayoutMinHeight: =30
                                        OnSelect: |-
                                            =Set(FRP_Validacoes_Visible, false);
                                            Set(DetailedReportView, true);
                                            Set(varFRP, ThisItem.Título);
                                            Set(LastFOPsGalleryVisible, false); //Deixar de mostrar as ultimas FOPs modificadas
                                            Set(PDFViewVisible, true); //Mostra o visualizador de PDF
                                        Width: =30
                                        ZIndex: =1

                                    FRP_Hist_Data_Criacao_2 As label:
                                        Align: =Align.Right
                                        AlignInContainer: =AlignInContainer.Stretch
                                        FillPortions: =1
                                        Font: =Font.Arial
                                        FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                        Height: =25
                                        LayoutMinHeight: =0
                                        OnSelect: =
                                        PaddingBottom: =0
                                        PaddingLeft: =0
                                        PaddingRight: =0
                                        PaddingTop: =0
                                        Size: =12
                                        Text: |-
                                            ="Data Criação: " & ThisItem.Data_Criacao
                                        VerticalAlign: =VerticalAlign.Top
                                        Width: =175
                                        Y: =18
                                        ZIndex: =3

                                    FRP_Hist_Data_Fechamento_2 As label:
                                        Align: =Align.Right
                                        AlignInContainer: =AlignInContainer.Stretch
                                        FillPortions: =
                                        Font: =Font.Arial
                                        FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                        Height: =25
                                        LayoutMinHeight: =0
                                        OnSelect: =
                                        PaddingBottom: =0
                                        PaddingLeft: =0
                                        PaddingRight: =0
                                        PaddingTop: =0
                                        Size: =12
                                        Text: |-
                                            =// Se a reatividade tiver valor Fechado mostra a data de fechamento
                                            If(
                                                ThisItem.Status = "Fechado",
                                                "Data Fechamento: " & ThisItem.Data_Fechamento
                                            )
                                        VerticalAlign: =VerticalAlign.Top
                                        Width: =175
                                        Y: =18
                                        ZIndex: =4

                                FOP_PH_ActualStatus_4 As rectangle:
                                    Fill: =RGBA(239, 223, 0, 1)
                                    Height: =Parent.Height
                                    OnSelect: =
                                    Visible: =ThisItem.IsSelected
                                    Width: =20
                                    ZIndex: =4

                    FOP_GlrContBtn_1 As groupContainer.horizontalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        LayoutGap: =15
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        LayoutMode: =LayoutMode.Auto
                        PaddingRight: =2.5
                        ZIndex: =5

                        FRP_ReturnBtn As button:
                            AlignInContainer: =AlignInContainer.Stretch
                            BorderColor: =RGBA(0, 0, 0, 1)
                            DisplayMode: |-
                                =DisplayMode.Edit
                                        
                            Fill: =RGBA(0, 0, 0, 1)
                            FillPortions: =2
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Bold
                            HoverBorderColor: =RGBA(238, 235, 76, 1)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =RGBA(238, 235, 76, 1)
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            OnSelect: |
                                =
                                Refresh(FOPs_SommaireContents);
                                Refresh(FOPs_Navette);
                                ResetForm(FOP_P_Forms_1);
                                Reset(FOPF_Action_2);
                                Reset(FOPF_Codigo2_1);
                                Reset(FOP_PE_ScreensNavigation_1);
                                Set(SignatureImage, Blank());
                                
                                
                                If(DetailedReportView, 
                                    If(FOP_PE_ScreensNavigation_1.Selected.Value="PENDÊNCIAS",
                                        Set(FRP_Pendencias_Visible, true),
                                        If(FOP_PE_ScreensNavigation_1.Selected.Value="VALIDAÇÕES",
                                        Set(FRP_Validacoes_Visible, true),
                                        Set(FRP_Historicos_Visible, true)
                                        )
                                    );
                                
                                    Set(DetailedReportView, false);
                                    Set(PDFViewVisible, false),
                                
                                    Set(FOP_PEVisible_1, false);
                                    Set(FRP_MainContVisible, true);
                                    Set(LastFOPsGalleryVisible, false); 
                                
                                    Set(CodigoFOP, Blank());
                                    Set(CodigoFOPAux, Blank());
                                
                                    Set(UsinaGalleryVisible, true);       //Mostrar a galeria de usinas
                                    Set(ProjectGalleryVisible, false);    //   ''         ''     projetos
                                    Set(DiversityGalleryVisible, false);  //   ''         ''     diversidade
                                    Set(UETGalleryVisible, false);        //   ''         ''     UETs
                                    Set(PostoGalleryVisible, false);      //   ''         ''     Postos
                                
                                    Set(SelectedUsina,Blank());    //Valor para a USINA selecionado na galeria respetiva
                                    Set(SelectedProject,Blank());  //    ''     o PROJETO         ''            ''      
                                    Set(SelectedDiversity,Blank());//    ''     a DIVERSIDADE     ''            ''
                                    Set(SelectedUET,Blank());      //    ''     a UET             ''            ''      
                                    Set(SelectedPosto,Blank());    //    ''     o POSTO           ''            ''    
                                );
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Text: ="Voltar"
                            Visible: =FOP_AppovalsFOPSVisible
                            Width: =113
                            X: =43
                            Y: =586
                            ZIndex: =1

                        FRP_Validar As button:
                            AlignInContainer: =AlignInContainer.Stretch
                            BorderColor: =RGBA(0, 0, 0, 1)
                            BorderThickness: =0
                            Color: =RGBA(0, 0, 0, 1)
                            DisplayMode: |-
                                =If(
                                    enable_validation_send,
                                    DisplayMode.Edit,
                                    DisplayMode.Disabled
                                )
                            Fill: =RGBA(120, 181, 34, 1)
                            FillPortions: =2
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Bold
                            HoverBorderColor: =RGBA(238, 235, 76, 1)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =RGBA(238, 235, 76, 1)
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            OnSelect: |
                                =Patch(
                                    FRP_Reatividades,
                                    LookUp(FRP_Reatividades, Título = varFRP),
                                    {Status: "Validado",
                                    Data_Validacao: Now()
                                    }
                                );
                                
                                Office365Outlook.SendEmailV2(
                                        "matheus.bernardim-extern@renault.com",
                                        "Reatividade de solda CVP-" & LookUp(FRP_Reatividades, Título = varFRP).UET & "-" & LookUp(FRP_Reatividades, Título = varFRP).Usina & "-" & LookUp(FRP_Reatividades, Título = varFRP).Diversidade,
                                        "<br>" & "A Reatividade nº " &  varFRP & " foi fechada em: " & Now() &
                                        "<br>" & "Por: " & Upper(UsuáriosdoOffice365.UserProfileV2(User().Email).givenName & " " & UsuáriosdoOffice365.UserProfileV2(User().Email).surname) & "<br>" & "<br>" & "******************* PROCESSO EM DESENVOLVIMENTO *******************" & "<br>" & "Segue em anexo a reatividade para: CVP - UET: " & LookUp(FRP_Reatividades, Título = varFRP).UET & "<br>" & "- POSTO: " & LookUp(FRP_Reatividades, Título = varFRP).Usina & "<br>" & "- Diversidade: " & LookUp(FRP_Reatividades, Título = varFRP).Diversidade & "<br>",
                                        {
                                            Attachments: Table(
                                                {
                                                    Name: "Pré Analise - REATIVIDADE.png",
                                                    ContentBytes: PreAnalise
                                                }
                                            ),
                                            Cc: "matheus.bernardim-extern@renault.com"
                                        }
                                    );
                                
                                
                                Refresh(FRP_Reatividades);
                                
                                
                                Notify("REATIVIDADE FECHADA COM SUCESSO",NotificationType.Success)
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Text: ="Validar"
                            Visible: =FOP_PE_ScreensNavigation_1.Selected.Value="VALIDAÇÕES" && DetailedReportView
                            Width: =113
                            X: =43
                            Y: =586
                            ZIndex: =2

                        FRP_Reprovar As button:
                            AlignInContainer: =AlignInContainer.Stretch
                            BorderColor: =RGBA(0, 0, 0, 1)
                            BorderThickness: =0
                            Color: =RGBA(0, 0, 0, 1)
                            DisplayMode: |-
                                =If(
                                    enable_validation_send,
                                    DisplayMode.Edit,
                                    DisplayMode.Disabled
                                )
                            Fill: =RGBA(191, 40, 40, 1)
                            FillPortions: =2.3
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Bold
                            HoverBorderColor: =RGBA(238, 235, 76, 1)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =RGBA(238, 235, 76, 1)
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            OnSelect: |
                                =If(!IsBlank(FRP_Comments_1.Text),
                                    Patch(
                                    FRP_Reatividades,
                                    LookUp(FRP_Reatividades, Título = varFRP),
                                    {Status: "Validado",
                                    Data_Validacao: Now()
                                    }
                                );
                                
                                Reprovar_Reatividade.Run(
                                        "matheus.bernardim-extern@renault.com",
                                        LookUp(FRP_Reatividades, Título = varFRP).Usina,
                                        LookUp(FRP_Reatividades, Título = varFRP).UET,
                                        LookUp(FRP_Reatividades, Título = varFRP).Diversidade,
                                        varFRP, 
                                        Now(),
                                        FRP_Comments_1.Text
                                    );
                                
                                
                                Refresh(FRP_Reatividades);
                                
                                
                                Notify("REPROVAÇÃO ENVIADA AO LÍDER COM SUCESSO",NotificationType.Success),
                                Notify("VOCÊ DEVE PREENCHER UMA DESCRIÇÃO SOBRE A REPROVAÇÃO!",NotificationType.Error);
                                )
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Text: ="Reprovar"
                            Visible: =FOP_PE_ScreensNavigation_1.Selected.Value="VALIDAÇÕES" && DetailedReportView
                            Width: =113
                            X: =43
                            Y: =586
                            ZIndex: =3

                        FRP_Close_Fault As button:
                            AlignInContainer: =AlignInContainer.Stretch
                            BorderColor: =RGBA(0, 0, 0, 1)
                            BorderThickness: =0
                            Color: =RGBA(0, 0, 0, 1)
                            Fill: =RGBA(239, 223, 0, 1)
                            FillPortions: =2
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Bold
                            HoverBorderColor: =RGBA(238, 235, 76, 1)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =RGBA(238, 235, 76, 1)
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            OnSelect: |
                                =Patch(
                                    FRP_Reatividades,
                                    LookUp(FRP_Reatividades, Título = varFRP),
                                    {Status: "Fechado",
                                    Data_Fechamento: Now()
                                    },
                                    Form1.Updates
                                );
                                
                                Office365Outlook.SendEmailV2(
                                        "matheus.bernardim-extern@renault.com",
                                        "Reatividade de solda CVP-" & LookUp(FRP_Reatividades, Título = varFRP).UET & "-" & LookUp(FRP_Reatividades, Título = varFRP).Usina & "-" & LookUp(FRP_Reatividades, Título = varFRP).Diversidade,
                                        "<br>" & "A Reatividade nº " &  varFRP & " foi fechada em: " & Now() &
                                        "<br>" & "Por: " & Upper(UsuáriosdoOffice365.UserProfileV2(User().Email).givenName & " " & UsuáriosdoOffice365.UserProfileV2(User().Email).surname) & "<br>" & "<br>" & "******************* PROCESSO EM DESENVOLVIMENTO *******************" & "<br>" & "Segue em anexo a reatividade para: CVP - UET: " & LookUp(FRP_Reatividades, Título = varFRP).UET & "<br>" & "- POSTO: " & LookUp(FRP_Reatividades, Título = varFRP).Usina & "<br>" & "- Diversidade: " & LookUp(FRP_Reatividades, Título = varFRP).Diversidade & "<br>",
                                        {
                                            Attachments: Table(
                                                {
                                                    Name: "Pré Analise - REATIVIDADE.png",
                                                    ContentBytes: PreAnalise
                                                }
                                            ),
                                            Cc: "matheus.bernardim-extern@renault.com"
                                        }
                                    );
                                
                                
                                Refresh(FRP_Reatividades);
                                
                                
                                Notify("REATIVIDADE FECHADA COM SUCESSO",NotificationType.Success)
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Text: ="Enviar"
                            Visible: =FOP_PE_ScreensNavigation_1.Selected.Value="PENDÊNCIAS" && DetailedReportView
                            Width: =113
                            X: =43
                            Y: =586
                            ZIndex: =4

                        Rectangle3_1 As rectangle:
                            AlignInContainer: =AlignInContainer.Stretch
                            Fill: =RGBA(0, 0, 0, 0)
                            FillPortions: =6
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            ZIndex: =5

                        FOP_PE_RefreshIco_1 As icon.Help:
                            AccessibleLabel: ="RECARREGAR"
                            AlignInContainer: =AlignInContainer.Stretch
                            Color: =RGBA(0, 0, 0, 1)
                            FillPortions: =1
                            Height: =40
                            Icon: =Icon.Reload
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            OnSelect: |-
                                =Switch(FOP_PE_ScreensNavigation_1.Selected.Value,
                                
                                    "PENDÊNCIAS", Refresh(FRP_Reatividades);Refresh(FRP_PSR_Reatividade),
                                    "HISTÓRICOS", Refresh(FOPs_Historico_Validacoes);Refresh(Pastas_FOPs),
                                    "ASSINATURA", Refresh(Assinaturas_Usuarios)
                                    );
                                
                                Notify("RECARREGANDO...", NotificationType.Information)
                            Tooltip: ="RECARREGAR"
                            Width: =40
                            X: =773
                            Y: =593
                            ZIndex: =6

            FOP_HistoricalCont_1 As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                DropShadow: =DropShadow.None
                Fill: =RGBA(217, 217, 214, 1)
                FillPortions: =5
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =100
                LayoutMinWidth: =0
                LayoutMode: =LayoutMode.Auto
                PaddingBottom: =10
                PaddingLeft: =10
                PaddingRight: =10
                PaddingTop: =10
                ZIndex: =3

                FOP_HistoricalLbls_1 As groupContainer.horizontalAutoLayoutContainer:
                    DropShadow: =DropShadow.None
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =5
                    PaddingTop: =5
                    Visible: =FOP_PE_ScreensNavigation_1.Selected.Value="HISTÓRICOS" || FOP_PE_ScreensNavigation_1.Selected.Value="PENDÊNCIAS"
                    ZIndex: =2

                    FOP_PE_HistoryFOPLabel_1 As label:
                        AlignInContainer: =AlignInContainer.Stretch
                        FillPortions: =9
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Bold
                        Height: =35
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        Size: =14
                        Text: |-
                            =If(FOP_PE_ScreensNavigation_1.Selected.Value="PENDÊNCIAS","Histórico",
                                
                                If(IsBlank(SelectedUsina),
                            
                                /*Caso usuário não tenha escolhido nenhuma usina*/
                                "Procurar FOP", 
                            
                                /*Quando visualiza os diferentes projetos*/
                                "Usina: " & SelectedUsina
                            
                             & 
                            
                            If(SelectedUsina="CVU",
                            
                                " - Diversidade" & If(IsBlank(SelectedDiversity),
                            
                                                        /*Quando não foi selecionada Diversidade, não mostra o resto de infos*/ 
                                                        "",
                            
                                                        /*Ao escolher diversidade mostra a escolha*/
                                                        ": " & SelectedDiversity & " - UET" & If(IsBlank(SelectedUET),
                            
                                                                /*Quando não foi selecionada UET, não mostra o resto de infos*/ 
                                                                "" ,
                            
                                                                /*Ao escolher UET mostra a escolha*/
                                                                ": " & SelectedUET & " - Posto"
                                                        )
                                                    ),
                            
                                " - UET" & If(IsBlank(SelectedUET),
                            
                                                                /*Quando não foi selecionada UET, não mostra o resto de infos*/ 
                                                                "" ,
                            
                                                                /*Ao escolher UET mostra a escolha*/
                                                                ": " & SelectedUET & Switch(SelectedUET,
                            
                                                                                            "PRP", " - Diversidade" & If(IsBlank(SelectedDiversity),
                            
                                                                                                                            /*Quando não foi selecionada Diversidade, não mostra o resto de infos*/ 
                                                                                                                            "",
                            
                                                                                                                            /*Ao escolher diversidade mostra a escolha*/
                                                                                                                            ": " & SelectedDiversity
                                                                                                                        ),
                            
                                                                                            "PK2", " - Diversidade" & If(IsBlank(SelectedDiversity),
                            
                                                                                                                            /*Quando não foi selecionada Diversidade, não mostra o resto de infos*/ 
                                                                                                                            "",
                            
                                                                                                                            /*Ao escolher diversidade mostra a escolha*/
                                                                                                                            ": " & SelectedDiversity
                                                                                                                        ),
                                                               
                                                                                            " - Posto" & If(IsBlank(SelectedPosto),
                            
                                                                                                            /*Quando não foi selecionado posto, não mostra o resto de infos*/ 
                                                                                                            "",
                            
                                                                                                            /*Ao escolher posto mostra a escolha*/
                                                                                                             ": " & SelectedPosto
                                                                                                        )
                                                                                    )
                                                            )
                            )
                            )
                            )
                        Width: =316
                        X: =776
                        Y: =34
                        ZIndex: =1

                    FOP_NH_UETReturn_Icn_1 As icon.Add:
                        AlignInContainer: =AlignInContainer.Center
                        Color: =RGBA(0, 0, 0, 1)
                        Height: =25
                        Icon: =Icon.BackArrow
                        OnSelect: |-
                            =If(SelectedUsina="CVU", 
                            
                                Set(SelectedDiversity, Blank());
                                Set(UETGalleryVisible,false);
                                Set(DiversityGalleryVisible, true),
                            
                                // ----------------- \\
                                
                                Set(SelectedUsina, Blank());
                                Set(SelectedUET, Blank());
                            
                                Set(UETGalleryVisible, false);
                                Set(UsinaGalleryVisible, true);
                            );
                        Visible: =UETGalleryVisible && FOP_PE_ScreensNavigation_1.Selected.Value="HISTÓRICOS"
                        Width: =30
                        X: =532
                        Y: =36
                        ZIndex: =2

                    TextInput2_1 As text:
                        Align: =Align.Justify
                        AlignInContainer: =AlignInContainer.Center
                        BorderColor: =RGBA(136, 139, 141, 1)
                        BorderThickness: =1
                        Default: =""
                        DelayOutput: =true
                        Fill: =RGBA(0, 0, 0, 0)
                        Font: =Font.Arial
                        Height: =35
                        HintText: ="Procure o posto"
                        HoverBorderColor: =RGBA(136, 139, 141, 1)
                        HoverFill: =RGBA(187, 188, 188, 1)
                        MaxLength: =500
                        PaddingLeft: =5
                        RadiusBottomLeft: =15
                        RadiusBottomRight: =15
                        RadiusTopLeft: =15
                        RadiusTopRight: =15
                        Size: =12
                        Tooltip: ="Procurar posto"
                        Visible: =PostoGalleryVisible
                        Width: =150
                        X: =71
                        Y: =66
                        ZIndex: =3

                    FOP_NH_PostoReturn_Icn_1 As icon.Add:
                        AlignInContainer: =AlignInContainer.Center
                        Color: =RGBA(0, 0, 0, 1)
                        Height: =25
                        Icon: =Icon.BackArrow
                        OnSelect: |-
                            =If(SelectedUET="PRP" || SelectedUET="PK2", 
                            
                                Set(SelectedDiversity, Blank());
                                Set(DiversityGalleryVisible,true),
                                
                            // ----- PADRÃO ----- \\  
                            Set(SelectedUET, Blank());  
                            Set(UETGalleryVisible, true);
                            );
                            
                            Set(PostoGalleryVisible, false);
                            Set(SelectedPosto, Blank());
                            Reset(TextInput2_1)
                        Visible: =PostoGalleryVisible && FOP_PE_ScreensNavigation_1.Selected.Value="HISTÓRICOS"
                        Width: =30
                        X: =532
                        Y: =36
                        ZIndex: =4

                    FOP_NH_DiversityReturn_Icn_1 As icon.Add:
                        AlignInContainer: =AlignInContainer.Center
                        Color: =RGBA(0, 0, 0, 1)
                        Height: =25
                        Icon: =Icon.BackArrow
                        OnSelect: |+
                            =If(SelectedUET="PRP" || SelectedUET="PK2", 
                            
                                Set(SelectedUET, Blank());
                                Set(DiversityGalleryVisible, false);
                                Set(UETGalleryVisible,true),
                            
                            SelectedUsina="CVU",
                            
                                 Set(SelectedUsina, Blank());
                                Set(DiversityGalleryVisible, false);
                                Set(UsinaGalleryVisible,true),
                            
                            // -------- PADRÃO ------ \\    
                            Set(SelectedPosto, Blank());
                            Set(SelectedDiversity, Blank());
                            Set(PostoGalleryVisible, true);
                            Set(DiversityGalleryVisible, false);
                            );
                            
                        Visible: =DiversityGalleryVisible && FOP_PE_ScreensNavigation_1.Selected.Value="HISTÓRICOS"
                        Width: =30
                        X: =532
                        Y: =36
                        ZIndex: =5

                FOP_NavigationHistory_Cont_1 As groupContainer.verticalAutoLayoutContainer:
                    DropShadow: =DropShadow.None
                    Fill: =RGBA(217, 217, 214, 1)
                    FillPortions: =13
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    LayoutMode: =LayoutMode.Auto
                    Visible: =FOP_PE_ScreensNavigation_1.Selected.Value="HISTÓRICOS"
                    ZIndex: =3

                    "FOP_NH_UsinaGallery_1 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                        AlignInContainer: =AlignInContainer.SetByContainer
                        Default: =Blank()
                        DelayItemLoading: =true
                        FillPortions: =9
                        Height: =537
                        Items: |-
                            =Distinct(PastasFOPs, // Coluna unica com diferentes valores
                                     Usina)             // Valores unicos que quero que devolva
                            
                            
                            //Distinc(Fonte_Dados; Resultado "O que devolve"))
                        Layout: =Layout.Vertical
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        LoadingSpinner: =LoadingSpinner.Data
                        TemplatePadding: =0
                        TemplateSize: =Parent.Width/5
                        Visible: =UsinaGalleryVisible
                        Width: =Parent.Width
                        WrapCount: =2
                        X: =16
                        Y: =82
                        ZIndex: =1

                        FOP_NH_Usina_1 As button:
                            BorderColor: =RGBA(0, 0, 0, 1)
                            DisplayMode: |-
                                =DisplayMode.Edit
                                        
                            Fill: =RGBA(0, 0, 0, 1)
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Bold
                            HoverBorderColor: =RGBA(238, 235, 76, 1)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =RGBA(238, 235, 76, 1)
                            OnSelect: |+
                                =Set(SelectedUsina, ThisItem.Value);
                                Set(UsinaGalleryVisible, false);
                                
                                // Verifica-se qual é a opção escolhida 
                                Switch(ThisItem.Value,
                                
                                    //Para mostrar a galeria de Diversidades
                                    "CVU", Set(DiversityGalleryVisible,true),
                                    
                                    //Para mostrar a galeria de UETs
                                    "CVP", Set(UETGalleryVisible, true);
                                );
                                
                                
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =30
                            RadiusTopLeft: =30
                            RadiusTopRight: =0
                            Text: =ThisItem.Value
                            Width: =Parent.TemplateWidth/2
                            X: =Parent.TemplateWidth/4
                            Y: =25
                            ZIndex: =1

                    "FOP_NH_UETGallery_1 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                        Default: =Blank()
                        DelayItemLoading: =true
                        FillPortions: =9
                        Height: =567
                        Items: |-
                            =Sort(    
                                Distinct(   //Função para só devolver um item, indiferente da quantidade de vezes que ele aparece
                            
                                    Filter(PastasFOPs,               //Filtragem da base
                                            Usina=SelectedUsina,
                                            If(SelectedUsina="CVU",Diversidade=SelectedDiversity, true)
                            
                                        ), //Com os itens da diversidade selecionada anteriormente
                                            
                                    UET),//E devolva só as UETs
                            
                                Value,
                                SortOrder.Ascending
                            )
                        Layout: =Layout.Vertical
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        LoadingSpinner: =LoadingSpinner.Data
                        TemplatePadding: =0
                        TemplateSize: =Parent.Width/6
                        Visible: =UETGalleryVisible
                        Width: =585
                        WrapCount: =2
                        Y: =80
                        ZIndex: =2

                        FOP_NH_UET_1 As button:
                            BorderColor: =RGBA(0, 0, 0, 1)
                            Fill: =RGBA(0, 0, 0, 1)
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Bold
                            Height: =Parent.TemplateHeight/2
                            HoverBorderColor: =RGBA(238, 235, 76, 1)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =RGBA(238, 235, 76, 1)
                            OnSelect: |-
                                =If(ThisItem.Value="PRP" || ThisItem.Value="PK2", 
                                
                                    Set(DiversityGalleryVisible,true),
                                    
                                    Set(PostoGalleryVisible, true)
                                );
                                
                                Set(UETGalleryVisible, false);
                                Set(SelectedUET, ThisItem.Value)
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =30
                            Text: =ThisItem.Value
                            Width: =Parent.TemplateWidth/2
                            X: =Parent.TemplateWidth/4
                            Y: =Parent.TemplateHeight/4
                            ZIndex: =1

                    "FOP_NH_PostoGallery_1 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                        Default: =Blank()
                        DelayItemLoading: =true
                        FillPortions: =9
                        Height: =565
                        Items: |-
                            =Search(
                                Sort(
                                    Distinct(  //Função para só devolver um item, indiferente da quantidade de vezes que ele aparece
                            
                                            Filter(PastasFOPs,       //Filtragem da base
                                                    Usina=SelectedUsina,
                                                    UET=SelectedUET, //Com os itens da UET selecionada anteriormente
                                                    If(SelectedUET="PRP" || SelectedUET="PK2" || SelectedUsina="CVU", Diversidade=SelectedDiversity, true)), 
                                                    
                                            Posto), //E devolva só os nomes dos postos   
                                    Value,
                                    SortOrder.Ascending
                                ), 
                                
                                TextInput2_1.Text,
                                "Value"
                            )
                        Layout: =Layout.Vertical
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        LoadingSpinner: =LoadingSpinner.Data
                        TemplatePadding: =0
                        TemplateSize: =Parent.Width/8
                        Visible: =PostoGalleryVisible
                        Width: =585
                        WrapCount: =2
                        Y: =82
                        ZIndex: =3

                        FOP_NH_Posto_1 As button:
                            BorderColor: =Self.Fill
                            Fill: =RGBA(0, 0, 0, 1)
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Bold
                            Height: =Parent.TemplateHeight*0.7
                            HoverBorderColor: =RGBA(238, 235, 76, 1)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =RGBA(238, 235, 76, 1)
                            OnSelect: |+
                                =Set(SelectedPosto, ThisItem.Value); //Define a variável com o posto selecionado
                                
                                If(SelectedUET="PRP" || SelectedUET="PK2" || SelectedUsina="CVU",
                                    /*Formação do Codigo FOP com as variáveis definidas anteriormente*/
                                    Set(CodigoFOP, Concatenate(SelectedUsina,"-",SelectedUET,"-",SelectedPosto,"-",SelectedDiversity));
                                    ClearCollect(HistoricoFOP, 
                                        ForAll(
                                                Filter(FOPs_Historico_Validacoes, Codigo_FOP=CodigoFOP),
                                
                                                {Tipo_Registro: Tipo_Registro,
                                                Codigo_FOP: Codigo_FOP,
                                                Indice: Indice,
                                                Responsavel: Responsavel,
                                                Registro: Registro,
                                                Data: Data,
                                                Anexos: Anexos}
                                        )
                                    ),
                                    
                                // ----- PADRÃO ----- \\  
                                Set(PostoGalleryVisible, false);
                                Set(DiversityGalleryVisible, true);
                                );
                                
                                
                                
                                
                                
                                
                                
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopRight: =30
                            Text: =ThisItem.Value
                            Width: =Parent.TemplateWidth/2
                            X: =Parent.TemplateWidth/4
                            Y: =Parent.TemplateHeight*0.15
                            ZIndex: =1

                    "FOP_NH_DiversityGallery_1 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                        Default: =Blank()
                        DelayItemLoading: =true
                        FillPortions: =9
                        Height: =565
                        Items: |-
                            =Sort(
                                Distinct(   //Função para só devolver um item, indiferente da quantidade de vezes que ele aparece
                            
                                    Filter(PastasFOPs,             //Filtragem da base
                                            Usina=SelectedUsina,
                                            UET=SelectedUET || IsBlank(SelectedUET),
                                            If(SelectedUET="PRP",true,Posto=SelectedPosto || IsBlank(SelectedPosto))          
                                    ),   //Com os itens da usina selecionada anteriormente
                            
                                    Diversidade),//E que só devolva os nomes nos projetos
                            
                                Value,
                                SortOrder.Ascending
                            )
                        Layout: =Layout.Vertical
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        LoadingSpinner: =LoadingSpinner.Data
                        TemplatePadding: =0
                        TemplateSize: =Parent.Width/5
                        Visible: =DiversityGalleryVisible
                        Width: =585
                        WrapCount: =2
                        Y: =82
                        ZIndex: =4

                        FOP_NH_Diversity_1 As button:
                            BorderColor: =Self.Fill
                            Color: =If(ThisItem.IsSelected, RGBA(0, 0, 0, 1) , RGBA(255, 255, 255, 1))
                            DisplayMode: |-
                                =DisplayMode.Edit
                                        
                            Fill: =If(ThisItem.IsSelected, RGBA(238, 235, 76, 1), RGBA(0, 0, 0, 1))
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Bold
                            Height: =Parent.TemplateHeight/2
                            HoverBorderColor: =RGBA(238, 235, 76, 1)
                            HoverColor: =RGBA(0, 0, 0, 1)
                            HoverFill: =RGBA(238, 235, 76, 1)
                            OnSelect: |+
                                =Set(SelectedDiversity, ThisItem.Value);
                                
                                
                                If(SelectedUET="PRP" || SelectedUET="PK2", 
                                
                                    Set(DiversityGalleryVisible, false);
                                    Set(PostoGalleryVisible, true),
                                
                                SelectedUsina="CVU",
                                
                                     Set(DiversityGalleryVisible, false);
                                    Set(UETGalleryVisible, true), 
                                    
                                // --------------------- CONDIÇÃO PADRÃO ------------------------- \\ 
                                /*Formação do Codigo FOP com as variáveis definidas anteriormente*/
                                Set(CodigoFOP, Concatenate(SelectedUsina,"-",SelectedUET,"-",SelectedPosto,"-",SelectedDiversity));
                                ClearCollect(HistoricoFOP, 
                                        ForAll(
                                                Filter(FOPs_Historico_Validacoes, Codigo_FOP=CodigoFOP),
                                
                                                {Tipo_Registro: Tipo_Registro,
                                                Codigo_FOP: Codigo_FOP,
                                                Indice: Indice,
                                                Responsavel: Responsavel,
                                                Registro: Registro,
                                                Data: Data,
                                                Anexos: Anexos}
                                        )
                                    )
                                );
                                
                                
                                
                                
                                
                                
                                
                            RadiusBottomLeft: =0
                            RadiusBottomRight: |
                                =25
                            RadiusTopLeft: =50
                            RadiusTopRight: =25
                            Text: =ThisItem.Value
                            Width: =Parent.TemplateWidth*0.5
                            X: =Parent.TemplateWidth*0.25
                            Y: =Parent.TemplateHeight/4
                            ZIndex: =1

                        FOP_NH_DiversityImage_1 As image:
                            Height: =Parent.TemplateHeight*0.8
                            Image: |-
                                =LookUp(Pastas_FOPs,             //Procurar na base de Pastas
                                        Diversidade=ThisItem.Value, //O projeto igual ao mencionado no botão
                                        Foto_Diversidade)           //Devolve a imagem da coluna desse projeto
                            OnSelect: =Select(Parent)
                            Width: =1
                            Y: =Parent.TemplateHeight*0.1
                            ZIndex: =2

                "FOP_PE_HistoryFOP_2 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    DelayItemLoading: =true
                    FillPortions: =17
                    Height: =485
                    Items: |-
                        =Sort(
                            FRP_Reatividades,
                            Data_Criacao,
                            SortOrder.Descending
                        )
                    Layout: =Layout.Vertical
                    LayoutMinHeight: =0
                    LayoutMinWidth: =0
                    LoadingSpinner: =LoadingSpinner.Data
                    TemplatePadding: =0
                    TemplateSize: =104
                    Visible: =FOP_PE_ScreensNavigation_1.Selected.Value="PENDÊNCIAS"
                    Width: =555
                    X: =776
                    Y: =93
                    ZIndex: =4

                    FOP_PH_Separator_2 As rectangle:
                        Height: =2
                        OnSelect: =Select(Parent)
                        Width: =Parent.TemplateWidth
                        Y: =102
                        ZIndex: =5

                    Container21_1 As groupContainer.horizontalAutoLayoutContainer:
                        DropShadow: =DropShadow.None
                        Height: =Parent.TemplateHeight
                        LayoutMode: =LayoutMode.Auto
                        PaddingBottom: =5
                        PaddingRight: =15
                        PaddingTop: =5
                        Width: =Parent.TemplateWidth
                        ZIndex: =12

                        Container22_1 As groupContainer.verticalAutoLayoutContainer:
                            DropShadow: =DropShadow.None
                            FillPortions: =2
                            LayoutDirection: =LayoutDirection.Vertical
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            LayoutMode: =LayoutMode.Auto
                            ZIndex: =1

                            FRP_Hist_Status As label:
                                AlignInContainer: =AlignInContainer.Stretch
                                FillPortions: =1
                                Font: =Font.Arial
                                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                Height: =25
                                LayoutMinHeight: =0
                                LayoutMinWidth: =0
                                OnSelect: |
                                    =
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Text: |-
                                    ="Status: " & ThisItem.Status
                                    
                                    //LookUp(relacao_ids_reatividades; ThisItem.Título in relacao_ids_reatividades[@Título]; relacao_ids_reatividades[@Status])
                                VerticalAlign: =VerticalAlign.Top
                                Width: =430
                                ZIndex: =1

                            FRP_Hist_Local As label:
                                AlignInContainer: =AlignInContainer.Stretch
                                FillPortions: =1
                                Font: =Font.Arial
                                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                Height: =Self.Size * 1.8
                                LayoutMinHeight: =0
                                LayoutMinWidth: =0
                                OnSelect: =
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Size: =10
                                Text: |-
                                    ="Localidade: " & ThisItem.Usina & "-" & ThisItem.UET & "-" & ThisItem.Diversidade
                                VerticalAlign: =VerticalAlign.Top
                                Width: =Parent.Width
                                X: =1
                                Y: =25
                                ZIndex: =2

                            FRP_Hist_PSR As label:
                                AlignInContainer: =AlignInContainer.Stretch
                                FillPortions: =1
                                Font: =Font.Arial
                                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                Height: =45
                                LayoutMinHeight: =0
                                LayoutMinWidth: =0
                                OnSelect: =
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Size: =10
                                Text: |-
                                    ="Nº Pontos reportados: " & CountIf(FRP_PSR_Reatividade, ThisItem.Título = FRP_PSR_Reatividade[@Título])
                                VerticalAlign: =VerticalAlign.Top
                                Width: =360
                                Y: =45
                                ZIndex: =3

                        Container33_1 As groupContainer.verticalAutoLayoutContainer:
                            DropShadow: =DropShadow.None
                            FillPortions: =1.3
                            LayoutDirection: =LayoutDirection.Vertical
                            LayoutMinHeight: =0
                            LayoutMinWidth: =0
                            LayoutMode: =LayoutMode.Auto
                            PaddingRight: =10
                            ZIndex: =2

                            FOP_PH_Date_2 As label:
                                Align: =Align.Right
                                AlignInContainer: =AlignInContainer.Stretch
                                FillPortions: =1
                                Font: =Font.Arial
                                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                Height: =25
                                LayoutMinHeight: =0
                                LayoutMinWidth: =0
                                OnSelect: =
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Text: |-
                                    ="ID: " & ThisItem.Título
                                Width: =175
                                ZIndex: =1

                            FRP_Hist_Data_Criacao As label:
                                Align: =Align.Right
                                AlignInContainer: =AlignInContainer.Stretch
                                FillPortions: =1
                                Font: =Font.Arial
                                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                Height: =25
                                LayoutMinHeight: =0
                                OnSelect: =
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Size: =12
                                Text: |-
                                    ="Data Criação: " & ThisItem.Data_Criacao
                                VerticalAlign: =VerticalAlign.Top
                                Width: =175
                                Y: =18
                                ZIndex: =2

                            FRP_Hist_Data_Fechamento As label:
                                Align: =Align.Right
                                AlignInContainer: =AlignInContainer.Stretch
                                FillPortions: =
                                Font: =Font.Arial
                                FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                                Height: =25
                                LayoutMinHeight: =0
                                OnSelect: =
                                PaddingBottom: =0
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =0
                                Size: =12
                                Text: |-
                                    =// Se a reatividade tiver valor Fechado mostra a data de fechamento
                                    If(
                                        ThisItem.Status = "Fechado",
                                        "Data Fechamento: " & ThisItem.Data_Fechamento
                                    )
                                VerticalAlign: =VerticalAlign.Top
                                Width: =175
                                Y: =18
                                ZIndex: =4

                        FOP_PH_ActualStatus_2 As rectangle:
                            Fill: =RGBA(239, 223, 0, 1)
                            Height: =Parent.Height
                            OnSelect: =
                            Visible: =ThisItem.IsSelected
                            Width: =20
                            ZIndex: =3

                Label6 As label:
                    Align: =Align.Center
                    Color: =RGBA(255, 0, 0, 1)
                    FontWeight: =FontWeight.Bold
                    Size: =18
                    Text: ="aqui estará um dashboard quando finalizado"
                    Visible: =false//FOP_PE_ScreensNavigation_1.Selected.Value="VALIDAÇÕES"
                    Width: =Parent.Width
                    ZIndex: =5

    FOP_PDF_ReturnIcon_2 As icon.Add:
        Color: =RGBA(255, 255, 255, 1)
        Height: =30
        Icon: =Icon.BackArrow
        OnSelect: |-
            =Set(FOP_PDF, Blank());
            Set(PDFViewApprovalsVisible, false);
        Visible: =PDFViewApprovalsVisible
        Width: =30
        X: =App.Width-150
        Y: =55
        ZIndex: =3

    FOP_TableView_2 As pdfViewer:
        BorderColor: =RGBA(0, 0, 0, 1)
        Document: |-
            =If(!IsBlank(Table_PDF), //Verifica se ele está sendo visualizado
            
                Table_PDF,
            
                //Quando não, carrega um arquivo padrão para mostrar a logo do app
                PDF_Padrao
            )
        Fill: =RGBA(0, 0, 0, 0.5)
        Height: =If(PDFTools, App.Height, FPC_Labels.Height + FOP_NavetteGallery_2.Height)
        OnStateChange: =
        ShowControls: =PDFTools
        Visible: =TableVisible && !FOP_PEVisible
        Width: =If(PDFTools, App.Width, FOP_PreviewCont.Width)
        X: =If( PDFTools, 0, FOP_PreviewCont.X)
        Y: =If(PDFTools, 0 , FOP_NavigationCont.Y + FOP_CabecalhoCont.Height)
        ZIndex: =4

    FOP_PU_Fade_2 As rectangle:
        Fill: =RGBA(0, 0, 0, 0.4)
        Height: =App.Height - 80
        Visible: =PopUpVisible
        Width: =App.Width
        Y: =80
        ZIndex: =6

    FOP_PDFV_ReturnIcon_Confirmations_2 As icon.Add:
        Color: =RGBA(255, 255, 255, 1)
        Height: =30
        Icon: =Icon.BackArrow
        OnSelect: |-
            =Set(PDFViewVisible, false);
            Set(FOP_PDF, Blank())
        Visible: =PDFViewVisible && FOP_PEVisible
        Width: =30
        X: =App.Width-150
        Y: =(DPS_CabecalhoCont_2.Height/2) - (FOP_PDFV_ReturnIcon_1.Height/2)
        ZIndex: =8

    FOP_PDFView_2 As pdfViewer:
        BorderColor: =RGBA(0, 0, 0, 1)
        Document: |-
            =If(!IsBlank(FOP_PDF), //Verifica se ele está sendo visualizado
            
                FOP_PDF,
            
                //Quando não, carrega um arquivo padrão para mostrar a logo do app
                PDF_Padrao
            )
        Fill: =RGBA(0, 0, 0, 0.5)
        Height: =If(PDFTools, App.Height, FRP_FOP_NavigationCont.Height)
        OnStateChange: =
        ShowControls: =PDFTools
        Visible: =PDFViewVisible && !FOP_PEVisible && Checkbox1.Value=false
        Width: =If(PDFTools, App.Width ,FRP_FOP_NavigationCont.Width)
        X: =If(PDFTools, 0, FRP_FOP_NavigationCont.X)
        Y: =If(PDFTools, 0, FRP_FOP_NavigationCont.Y + FOP_CabecalhoCont.Height)
        ZIndex: =9

    FOP_PDFV_ReturnIcon_1 As icon.Add:
        Color: =RGBA(255, 255, 255, 1)
        Height: =30
        Icon: =Icon.BackArrow
        OnSelect: |-
            =Set(PDFTools, false);
            Set(PDFX,757);
            Set(PDFY,100);
            Set(PDFWidth,609);
            Set(PDFHeight,668);
            Reset(Checkbox1);
        Visible: =FOP_PDFView.ShowControls
        Width: =30
        X: =App.Width-150
        Y: =(DPS_CabecalhoCont_2.Height/2)-(FOP_PDFV_ReturnIcon_1.Height/2)
        ZIndex: =10

    FRP_conNavigation_FOPType As groupContainer.horizontalAutoLayoutContainer:
        Fill: =RGBA(0, 0, 0, 0.38)
        Height: =App.Height - 60
        LayoutAlignItems: =LayoutAlignItems.Center
        LayoutGap: =100
        LayoutJustifyContent: =LayoutJustifyContent.Center
        LayoutMode: =LayoutMode.Auto
        PaddingBottom: =60
        PaddingLeft: =60
        PaddingRight: =60
        PaddingTop: =60
        Visible: =FOPTypeNavigation
        Width: =App.Width
        Y: =60
        ZIndex: =11

        FRP_conBtn_FOPVidaSerie As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.ExtraBold
            Fill: =RGBA(242, 242, 242, 1)
            FillPortions: =0
            Height: =170
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            RadiusBottomLeft: =30
            RadiusBottomRight: =30
            RadiusTopLeft: =30
            RadiusTopRight: =30
            Width: =170
            ZIndex: =1

            lblBtnVidaSerie_6 As label:
                Align: =Align.Center
                Font: ="NouvelR, Arial"
                FontWeight: =FontWeight.Bold
                OnSelect: |-
                    =Navigate(CPE_FOPs, ScreenTransition.Fade);
                    Set(FOPTypeNavigation, false);
                Size: =15
                Text: ="Vida Série"
                Width: =Parent.Width
                Y: =Parent.Height - Self.Height
                ZIndex: =1

            ImgVidaSerie_12 As image:
                Height: =Parent.Height - lblBtnVidaSerie_6.Height
                Image: |
                    ="data:image/svg+xml;utf8, "&
                    EncodeUrl(
                    "
                    <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 60 60'><defs><style>.cls-1{fill:#1d1d1b;}</style></defs><g id='Picto'><path class='cls-1' d='M39.8,41.12h-18v2.36a1.64,1.64,0,0,1-1.63,1.58H15.36a1.55,1.55,0,0,1-1.53-1.58V32.77a6.21,6.21,0,0,1,2.45-4.85l-2.55-1.1V25.14h3.8c1.34-3.6,2.59-5.91,5.47-5.91H38.6c2.88,0,4.13,2.31,5.47,5.91h3.79v1.68l-2.54,1.1a6.24,6.24,0,0,1,2.45,4.85V43.48a1.56,1.56,0,0,1-1.54,1.58h-4.8a1.64,1.64,0,0,1-1.63-1.58Zm3.84-11.95H18a5.37,5.37,0,0,0-2.16,3.6V43.14h4V39.2H41.77v3.94h4V32.77A5.37,5.37,0,0,0,43.64,29.17Zm-21.79,7.3c-2.6-.72-4-1.25-4-3.22V31.14h5.91v1.73H19.49v.19c0,.62,0,.91,2.36,1.63ZM38.31,21.15h-15c-2.26,0-3.17,2-4.32,6.15H42.63C41.48,23.12,40.57,21.15,38.31,21.15Zm-6.82,10,1.11,2.11-1.11,1.92H30l-1.11-1.92L30,31.14ZM42.1,33.06v-.19H37.88V31.14h5.9v2.11c0,2-1.44,2.5-4,3.22V34.69C42.1,34,42.1,33.68,42.1,33.06Z'/></g></svg>
                    ")
                OnSelect: |-
                    =Navigate(CPE_FOPs, ScreenTransition.Fade);
                    Set(FOPTypeNavigation, false);
                Width: =Parent.Width
                ZIndex: =2

        FRP_conBtn_FOPMPR As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.ExtraBold
            Fill: =RGBA(242, 242, 242, 1)
            FillPortions: =0
            Height: =170
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            RadiusBottomLeft: =30
            RadiusBottomRight: =30
            RadiusTopLeft: =30
            RadiusTopRight: =30
            Width: =170
            ZIndex: =2

            lblBtnMPR_6 As label:
                Align: =Align.Center
                Font: ="NouvelR, Arial"
                FontWeight: =FontWeight.Bold
                OnSelect: |-
                    =Navigate(FOPs_MPR_Main, ScreenTransition.Fade);
                    Set(FOPTypeNavigation, false);
                Size: =15
                Text: ="MPR"
                Width: =Parent.Width
                Y: =Parent.Height - Self.Height
                ZIndex: =1

            ImgMPR_6 As image:
                Height: =Parent.Height - lblBtnMPR_6.Height
                Image: |
                    ="data:image/svg+xml;utf8, "&
                    EncodeUrl(
                    "
                    <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 60 60'><defs><style>.cls-1{fill:#1d1d1b;}</style></defs><g id='Picto'><path class='cls-1' d='M9.8,13.23c3.56,0,4.85.63,6.29,2.64l.92,1.3-1.64,1.15-1-1.53c-.77-1.2-1.73-1.64-4.57-1.64Zm33.37,14.5-4-.86c-1.3-.29-3-2.31-6-3.46a24.45,24.45,0,0,0-7.92-1.06,57.69,57.69,0,0,0-6.81.48l-2.16-1.1-.05-.58a90.07,90.07,0,0,1,9.55-.76,24.52,24.52,0,0,1,8.26,1.24c2.69,1,4.8,3.12,5.52,3.27l4,.91c1.54.34,2.5.86,3,1.82a10.44,10.44,0,0,1,1.2,4.57c0,2.06-1.39,3-3.55,3h-2.4V33.49a2.16,2.16,0,1,0-4.32,0v1.73H22.09V33.49a2.16,2.16,0,1,0-4.32,0v1.68H16.48c-2.26-.24-4.61-1.53-4.61-4.37V28.12c0-1.3.53-2,3.31-4.81l1.73,1c-2.59,2.64-3.07,3.08-3.07,4.18V30.8a2.11,2.11,0,0,0,2,2.16,4.12,4.12,0,0,1,8.21.29H35.58a4.23,4.23,0,0,1,4.13-4,4.16,4.16,0,0,1,4.13,4h.34c1.44,0,1.68-.29,1.68-1.25a6.78,6.78,0,0,0-.92-3.31C44.61,28.21,44.27,28,43.17,27.73ZM24.06,41.46a4.13,4.13,0,1,1-8.25,0,4.13,4.13,0,1,1,8.25,0Zm-2,0a2.16,2.16,0,1,0-4.32,0,2.16,2.16,0,1,0,4.32,0Zm21.75,0a4.13,4.13,0,1,1-8.26,0,4.13,4.13,0,1,1,8.26,0Zm-2,0a2.16,2.16,0,1,0-4.32,0,2.16,2.16,0,1,0,4.32,0Zm1.59-25.78c1.39-1.68,2.83-2.45,4.22-2.45a4.65,4.65,0,0,1,2.26.53l-.72,1.78a4.25,4.25,0,0,0-1.4-.34c-1,0-1.68.29-3.21,2.11L41.1,21.54l-1.44-1.3Z'/></g></svg>
                    ")
                OnSelect: |-
                    =Navigate(FOPs_MPR_Main, ScreenTransition.Fade);
                    Set(FOPTypeNavigation, false);
                Width: =Parent.Width
                ZIndex: =2

        FRP_conBtn_FOPPecaPadrao As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.ExtraBold
            Fill: =RGBA(242, 242, 242, 1)
            FillPortions: =0
            Height: =170
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            RadiusBottomLeft: =30
            RadiusBottomRight: =30
            RadiusTopLeft: =30
            RadiusTopRight: =30
            Width: =170
            ZIndex: =3

            lblBtnPecaPadrao_6 As label:
                Align: =Align.Center
                Font: ="NouvelR, Arial"
                FontWeight: =FontWeight.Bold
                OnSelect: |-
                    =Notify("EM DESENVOLVIMENTO", NotificationType.Information)
                    //Navigate(FOPs_PecaPadrao; ScreenTransition.Fade);;
                    //Set(FOPTypeNavigation; false);;
                Size: =15
                Text: ="Peça Padrão"
                Width: =Parent.Width
                Y: =Parent.Height - Self.Height
                ZIndex: =1

            ImgVidaSerie_13 As image:
                Height: =Parent.Height - lblBtnPecaPadrao_6.Height
                Image: |
                    ="data:image/svg+xml;utf8, "&
                    EncodeUrl(
                    "
                    <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 60 60'><defs><style>.cls-1{fill:#1d1d1b;}</style></defs><g id='Picto'><path class='cls-1' d='M17.05,33.16l-1.2-6V19.57c0-1.58.68-2.35,2.07-2.35H41.73c1.39,0,2.06.77,2.06,2.35v7.54l1.44,3.65A7.48,7.48,0,0,1,45.81,33a27.6,27.6,0,0,1-.72,4.12l-1.2,5.67c-.34,1.58-.67,2.35-2.07,2.35H17.92c-1.39,0-2.64-.82-2.07-2.35L17,39.64a9.86,9.86,0,0,0,.76-2.55A31.82,31.82,0,0,0,17.05,33.16Zm.77-14v6.05h24V19.14Zm24,24.1,2.12-10.08c-8.26,1.34-13.78,3-24.68,6.24l-1.44,3.84ZM20,37.29a156.75,156.75,0,0,1,23.28-5.91l-1.58-4.27H18Zm-.33-15.13a1.2,1.2,0,1,1,2.4,0,1.2,1.2,0,1,1-2.4,0Zm17.85,0a1.2,1.2,0,1,1,2.4,0,1.2,1.2,0,1,1-2.4,0Z'/></g></svg>
                    ")
                OnSelect: |-
                    =Notify("EM DESENVOLVIMENTO", NotificationType.Information)
                    //Navigate(FOPs_PecaPadrao; ScreenTransition.Fade);;
                    //Set(FOPTypeNavigation; false);;
                Width: =Parent.Width
                ZIndex: =2

    FRP_PUVersaoDeastualizada As groupContainer.verticalAutoLayoutContainer:
        DropShadow: =DropShadow.None
        Fill: =RGBA(0, 0, 0, 0.34)
        Height: =App.Height
        LayoutAlignItems: =LayoutAlignItems.Center
        LayoutDirection: =LayoutDirection.Vertical
        LayoutJustifyContent: =LayoutJustifyContent.Center
        LayoutMode: =LayoutMode.Auto
        Visible: |-
            =VersaoAtual
            //true
        Width: =App.Width
        ZIndex: =12

        FRP_PVD_InfoCont As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.ExtraBold
            Fill: =RGBA(217, 217, 214, 1)
            FillPortions: =0
            Height: =Parent.Height*0.6
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGap: =10
            LayoutJustifyContent: =LayoutJustifyContent.Center
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =20
            PaddingRight: =20
            Width: =Parent.Width*0.3
            ZIndex: =1

            Image3_6 As image:
                Height: =140
                Image: ='Design sem nome (15)'
                LayoutMinHeight: =0
                Width: =180
                ZIndex: =1

            HtmlText1_6 As htmlViewer:
                FillPortions: =1
                Font: =Font.Arial
                HtmlText: |
                    ="<div style='text-align: center;'>
                    Existe uma nova versão disponível, por favor recarregue a página ou feche o aplicativo e abra novamente.<br>
                    <br>
                    Clique no botão <b>Atualizar</b> no <font color='red'><b>canto superior esquerdo</b></font>, abaixo segue um exemplo da mensagem e botão que você deve clicar.
                    </div>"
                LayoutMinHeight: =0
                LayoutMinWidth: =0
                Size: =14
                ZIndex: =3

            Image4_6 As image:
                Height: =50
                Image: ='Design sem nome (17)'
                LayoutMinWidth: =0
                ZIndex: =4

    FRP_View_lista_pontos As groupContainer.verticalAutoLayoutContainer:
        DropShadow: =DropShadow.None
        Fill: =RGBA(0, 0, 0, 0.34)
        Height: =App.Height
        LayoutAlignItems: =LayoutAlignItems.Center
        LayoutDirection: =LayoutDirection.Vertical
        LayoutJustifyContent: =LayoutJustifyContent.Center
        LayoutMode: =LayoutMode.Auto
        Visible: =view_Lista
        Width: =App.Width
        ZIndex: =13

        FRP_View_lista_detail As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.ExtraBold
            Fill: =RGBA(217, 217, 214, 1)
            FillPortions: =0
            Height: =Parent.Height*0.6
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGap: =10
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =20
            PaddingRight: =20
            PaddingTop: =30
            Width: =Parent.Width*0.3
            ZIndex: =1

            FRP_View_Lista_Infos As groupContainer.horizontalAutoLayoutContainer:
                DropShadow: =DropShadow.None
                FillPortions: =0.1
                LayoutMinHeight: =5
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                ZIndex: =1

                View_lista_TXT_Label As label:
                    FillPortions: =5
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Bold
                    Height: =38
                    Size: =18
                    Text: ="LISTA DE PONTOS"
                    Width: =316
                    X: =10
                    Y: =48
                    ZIndex: =1

                Ocultar_lista As icon.Add:
                    AutoDisableOnSelect: =false
                    BorderColor: =RGBA(0, 0, 0, 1)
                    Color: =RGBA(0, 0, 0, 1)
                    DisabledBorderColor: =RGBA(141, 198, 63, 1)
                    DisplayMode: =
                    FocusedBorderThickness: =0
                    Height: =30
                    Icon: =Icon.Hide
                    OnSelect: =Set(view_Lista,false)
                    Visible: =!Exibir_lista.Visible
                    Width: =30
                    Y: =40
                    ZIndex: =2

            "Gallery3 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                DelayItemLoading: =true
                Height: =Parent.Height-FRP_View_Lista_Infos.Height
                Items: =lista_email
                Layout: =Layout.Vertical
                LayoutMinHeight: =287
                LayoutMinWidth: =320
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =Subtitle3_1.Height*3
                ZIndex: =2

                Subtitle3 As label:
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =Self.Size * 1.8
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: |-
                        ="Código FOP: " & ThisItem.Codigo_FOP
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.Width
                    Y: =Subtitle3_1.Y + Subtitle3_1.Height
                    ZIndex: =2

                Separator3 As rectangle:
                    Height: =8
                    OnSelect: =Select(Parent)
                    Width: =Parent.TemplateWidth
                    Y: =Parent.TemplateHeight - Self.Height
                    ZIndex: =3

                Subtitle3_1 As label:
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =Self.Size * 1.8
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: |-
                        ="PSR: " & ThisItem.PSR
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.Width
                    ZIndex: =4

    FRP_View_Error_Detail As groupContainer.verticalAutoLayoutContainer:
        DropShadow: =DropShadow.None
        Fill: =RGBA(0, 0, 0, 0.34)
        Height: =App.Height-DPS_CabecalhoCont_2.Height
        LayoutAlignItems: =LayoutAlignItems.Center
        LayoutDirection: =LayoutDirection.Vertical
        LayoutJustifyContent: =LayoutJustifyContent.Center
        LayoutMode: =LayoutMode.Auto
        Visible: =view_error_detail
        Width: =App.Width/2
        Y: =DPS_CabecalhoCont_2.Height
        ZIndex: =14

        FRP_View_Error_detail As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.ExtraBold
            Fill: =RGBA(217, 217, 214, 1)
            FillPortions: =0
            Height: =Parent.Height*0.6
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGap: =10
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =20
            PaddingRight: =20
            PaddingTop: =30
            Width: =Parent.Width*0.6
            ZIndex: =1

            FRP_View_Lista_Infos_1 As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                DropShadow: =DropShadow.None
                FillPortions: =0.1
                LayoutMinHeight: =5
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                ZIndex: =1

                View_lista_TXT_Label_1 As label:
                    FillPortions: =5
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Bold
                    Height: =38
                    Size: =18
                    Text: ="DEFEITOS REPORTADOS"
                    Width: =316
                    X: =10
                    Y: =48
                    ZIndex: =1

                Ocultar_lista_1 As icon.Add:
                    AutoDisableOnSelect: =false
                    BorderColor: =RGBA(0, 0, 0, 1)
                    Color: =RGBA(0, 0, 0, 1)
                    DisabledBorderColor: =RGBA(141, 198, 63, 1)
                    DisplayMode: =
                    FocusedBorderThickness: =0
                    Height: =30
                    Icon: =Icon.Hide
                    OnSelect: =Set(view_error_detail,false)
                    Visible: =FRP_View_Error_Detail.Visible
                    Width: =30
                    Y: =40
                    ZIndex: =2

            "Gallery5 As gallery.'BrowseLayout_Vertical_OneTextVariant_ver5.0'":
                AlignInContainer: =AlignInContainer.SetByContainer
                DelayItemLoading: =true
                Items: =CodigosErroSeparados
                Layout: =Layout.Vertical
                LayoutMinHeight: =287
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =104
                Width: =Parent.Width
                ZIndex: =1

                Title10 As label:
                    FontWeight: =If(ThisItem.IsSelected, FontWeight.Semibold, FontWeight.Normal)
                    Height: =Self.Size * 1.8
                    OnSelect: =Select(Parent)
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =ThisItem.Value & " - " & LookUp(Codigos_de_erro, ID = ThisItem.Value, Descricao)
                    VerticalAlign: =VerticalAlign.Top
                    Width: =Parent.TemplateWidth - 86
                    X: =16
                    Y: =(Parent.TemplateHeight / 2) - (Self.Height / 2)
                    ZIndex: =1

                Separator9 As rectangle:
                    Height: =8
                    OnSelect: =Select(Parent)
                    Width: =Parent.TemplateWidth
                    Y: =Parent.TemplateHeight - Self.Height
                    ZIndex: =3

    FRP_View_calendar_filter As groupContainer.verticalAutoLayoutContainer:
        DropShadow: =DropShadow.None
        Fill: =RGBA(0, 0, 0, 0.34)
        Height: =App.Height
        LayoutAlignItems: =LayoutAlignItems.Center
        LayoutDirection: =LayoutDirection.Vertical
        LayoutJustifyContent: =LayoutJustifyContent.Center
        LayoutMode: =LayoutMode.Auto
        Visible: =view_calendar_filter
        Width: =App.Width
        ZIndex: =15

        FRP_calendar_filter As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.ExtraBold
            Fill: =RGBA(217, 217, 214, 1)
            FillPortions: =0
            Height: =Parent.Height*0.6
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGap: =10
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =20
            PaddingRight: =20
            PaddingTop: =30
            Width: =Parent.Width*0.3
            ZIndex: =2

            FRP_datapicker_filter As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                DropShadow: =DropShadow.None
                FillPortions: =0
                Height: =40
                LayoutMinHeight: =5
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                ZIndex: =1

                View_lista_TXT_Label_3 As label:
                    FillPortions: =1
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Bold
                    Height: =38
                    Size: =18
                    Text: ="FILTRO DE DATAS"
                    Width: =316
                    X: =10
                    Y: =48
                    ZIndex: =1

                Ocultar_filtro As icon.Add:
                    AutoDisableOnSelect: =false
                    BorderColor: =RGBA(0, 0, 0, 1)
                    Color: =RGBA(0, 0, 0, 1)
                    DisabledBorderColor: =RGBA(141, 198, 63, 1)
                    DisplayMode: =
                    FocusedBorderThickness: =0
                    Height: =30
                    Icon: =Icon.Check
                    OnSelect: =Set(view_calendar_filter,false)
                    Visible: =view_calendar_filter
                    Width: =30
                    Y: =40
                    ZIndex: =2

            Label2 As label:
                LayoutMinWidth: =60
                Text: |-
                    ="Ínício: "
                Width: =Parent.Width
                Y: =FRP_datapicker_filter.Height
                ZIndex: =2

            StartDate As datepicker:
                AlignInContainer: =AlignInContainer.Center
                BorderColor: =RGBA(50, 86, 160, 1)
                DefaultDate: =Date(2024,01,01)
                LayoutMinWidth: =150
                Width: =Parent.Width*0.6
                ZIndex: =3

            Label2_1 As label:
                LayoutMinWidth: =60
                Text: |-
                    ="Fim: "
                Width: =Parent.Width
                ZIndex: =4

            EndDate As datepicker:
                AlignInContainer: =AlignInContainer.Center
                BorderColor: =RGBA(50, 86, 160, 1)
                Width: =Parent.Width*0.6
                X: =170
                Y: =148
                ZIndex: =5

            Label2_3 As label:
                LayoutMinWidth: =60
                Text: |-
                    ="Nº da reatividade: "
                Width: =Parent.Width
                ZIndex: =6

            Input_num_reatividade As text:
                Align: =Align.Center
                AlignInContainer: =AlignInContainer.Center
                Default: =""
                HintText: ="Digite o Nº da reatividade"
                Width: =Parent.Width*0.6
                ZIndex: =7

